<ng-container *ngIf="innovation">

  <section class="section-light-pad rm-pad-bottom" id="exploration-component">
    <div class="column col-xs-12 col-11 col-mx-auto">

       <!--project under editing and submitted status -->
      <ng-container *ngIf="innovation.status === 'EDITING' || innovation.status === 'SUBMITTED'">
        <h2 class="title-primary">{{ 'PROJECT_MODULE.EXPLORATION.TITLE'  | translate }}</h2>
        <div class="section-light-pad rm-pad-bottom">
          <app-message-template-1 [widthMax]="'337px'">{{ getMessage() | translate }}</app-message-template-1>
        </div>
      </ng-container>
       <!-- /project under editing and submitted status -->

      <!-- project under evaluating and done status -->
      <ng-container *ngIf="innovation.status === 'EVALUATING' || innovation.status === 'DONE'">

        <!-- section title -->
        <div class="section-title flex-between">
          <h2 class="title-primary">{{ 'PROJECT_MODULE.EXPLORATION.TITLE'  | translate }}</h2>
          <a class="btn btn-primary gtm-exploration-contact-operator" href="{{ contactUrl }}"><span>{{'PROJECT_MODULE.EXPLORATION.CONTACT_BUTTON' | translate}}</span></a>
        </div>
        <!-- /section title -->

        <!-- section comment -->
        <div class="section-comment">

          <!-- status wrapper -->
          <div class="status-wrapper">

            <h4>{{ 'PROJECT_MODULE.EXPLORATION.STATUS_TEXT.TITLE' | translate }}</h4>

            <div class="status-content">
              <p><i class="fas fa-check"></i>{{ 'PROJECT_MODULE.EXPLORATION.STATUS_TEXT.CREATED' | translate }}</p>
              <p>{{ innovation.created | date:dateFormat }}</p>
            </div>

            <ng-container *ngFor="let action of innovation.statusLogs">
              <div class="status-content">
                <p>
                  <i class="fas" [ngClass]="(action.action === 'REJECT') ? 'fa-times' : 'fa-check'"></i>{{ ('PROJECT_MODULE.EXPLORATION.STATUS_TEXT.' + action.action) | translate }}
                </p>
                <p>{{ action.date | date:dateFormat }}</p>
              </div>
            </ng-container>

          </div>

          <!-- Comment -->
          <ng-container *ngIf="innovation.comments || innovation.operator?.name">
            <div class="comment-wrapper">

              <ng-container *ngIf="innovation.comments">
                <h3 class="title-secondary">{{ 'PROJECT_MODULE.EXPLORATION.COMMENTS' | translate }}</h3>
                <div class="text" [innerHtml]="innovation.comments"></div>
              </ng-container>

              <ng-container *ngIf="innovation.operator?.name">
                <div class="operator-wrapper text">
                  <span class="text-medium">{{ 'PROJECT_MODULE.EXPLORATION.ACCOUNT_MANAGER' | translate }}</span>
                  <span>{{ innovation.operator?.name }}</span>
                </div>
              </ng-container>

            </div>
          </ng-container>

        </div>
        <!-- /section comment -->

        <!-- section analytics -->
        <ng-container *ngIf="false">
          <div class="section-analytics">
            <h3 class="title-secondary">{{'PROJECT_MODULE.EXPLORATION.ANALYTICS.TITLE' | translate}}</h3>
            <div class="analytic-content">

              <!-- reached -->
              <div class="analytic-body">
                <p>{{ 'PROJECT_MODULE.EXPLORATION.ANALYTICS.PROFESSIONALS_REACHED' | translate }}</p>
                <h5 class="text-center">{{ campaignStats?.nbProsSent || 0 }}</h5>
              </div>

              <div class="analytic-body pd-top">
                <svg width="80px" height="38px" viewBox="0 0 80 38">
                  <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                    <g transform="translate(-701.000000, -810.000000)">
                      <g transform="translate(701.000000, 810.000000)">
                        <polygon fill="#2ECC71" points="0 0 64.1497147 0 80 19.8465833 64.1497147 38 0 38 14.6486762 19"></polygon>
                        <text class="svg-text">
                          <tspan x="27.4760742" y="24">{{ percentage(campaignStats?.nbProsSent, campaignStats?.nbProsOpened) || 0 }}%</tspan>
                        </text>
                      </g>
                    </g>
                  </g>
                </svg>
              </div>

              <!-- emails -->
              <div class="analytic-body">
                <p>{{ 'PROJECT_MODULE.EXPLORATION.ANALYTICS.EMAILS_OPENED' | translate }}</p>
                <h5 class="text-center">{{ campaignStats?.nbProsOpened || 0 }}</h5>
              </div>

              <div class="analytic-body pd-top">
                <svg width="80px" height="38px" viewBox="0 0 80 38">
                  <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                    <g transform="translate(-701.000000, -810.000000)">
                      <g transform="translate(701.000000, 810.000000)">
                        <polygon fill="#EA5858" points="0 0 64.1497147 0 80 19.8465833 64.1497147 38 0 38 14.6486762 19"></polygon>
                        <text class="svg-text">
                          <tspan x="27.4760742" y="24">{{ percentage(campaignStats?.nbProsOpened, campaignStats?.nbProsClicked) || 0 }}%</tspan>
                        </text>
                      </g>
                    </g>
                  </g>
                </svg>
              </div>

              <!-- clicks -->
              <div class="analytic-body">
                <p>{{ 'PROJECT_MODULE.EXPLORATION.ANALYTICS.CLICKS' | translate }}</p>
                <h5 class="text-center">{{ campaignStats?.nbProsClicked || 0 }}</h5>
              </div>

              <div class="analytic-body pd-top">
                <svg width="80px" height="38px" viewBox="0 0 80 38">
                  <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                    <g transform="translate(-701.000000, -810.000000)">
                      <g transform="translate(701.000000, 810.000000)">
                        <polygon fill="#F79323" points="0 0 64.1497147 0 80 19.8465833 64.1497147 38 0 38 14.6486762 19"></polygon>
                        <text class="svg-text">
                          <tspan x="27.4760742" y="24">{{ percentage(campaignStats?.nbProsClicked, campaignStats?.nbValidatedResp) || 0 }}%</tspan>
                        </text>
                      </g>
                    </g>
                  </g>
                </svg>
              </div>

              <!-- answers -->
              <div class="analytic-body">
                <p>{{ 'PROJECT_MODULE.EXPLORATION.ANALYTICS.ANSWERS' | translate }}</p>
                <h5 class="text-center">{{ campaignStats?.nbValidatedResp || 0 }}</h5>
              </div>

            </div>
          </div>
        </ng-container>
        <!-- /section analytics -->

        <!-- section click rate -->
        <div class="section-rate">
          <h3 class="title-secondary">{{ 'PROJECT_MODULE.EXPLORATION.CLICK_MAP_TITLE' | translate }}</h3>
          <app-shared-worldmap
            [countries]="countries"
            [countriesColor]="'#2ECC71'"
            [isEditable]="false"
            [width]="'auto'">
          </app-shared-worldmap>
        </div>
        <!-- /section click rate -->

        <!-- section company -->
        <ng-container *ngIf="companies.length > 0">
          <div class="section-company section-light-pad rm-pad-bottom">
            <h3 class="title-secondary">{{ 'PROJECT_MODULE.EXPLORATION.COMPANIES_LIST_TITLE' | translate }}</h3>
            <ul class="company-content text">
              <li *ngFor="let company of companies; let i = index">
                {{ i + 1 + '.'}} {{ company.name | FormatText }}
              </li>
            </ul>
          </div>
        </ng-container>
        <!-- /section company -->

        <!-- section table -->
        <ng-container *ngIf="tableInfos?._total > 0">
          <div class="section-light-pad rm-pad-bottom">
            <h3 class="title-secondary">{{ 'PROJECT_MODULE.EXPLORATION.INSIGHTS_TITLE' | translate }}</h3>
            <app-shared-table [data]="tableInfos" [(config)]="config" (editRow)="onClickShow($event)"></app-shared-table>
          </div>
        </ng-container>
        <!-- section table -->

      </ng-container>
      <!-- /project under evaluating and done status-->

    </div>
  </section>


  <!-- sidebar to view user answer -->
  <app-sidebar [(template)]="sidebarValue">
    <app-user-answer
      [adminMode]="false"
      [sidebarState]="sidebarValue.animate_state"
      [(userAnswer)]="modalAnswer"
      [questions]="questions"
      [projectId]="innovation._id">
    </app-user-answer>
  </app-sidebar>
  <!-- /sidebar to view user answer -->


</ng-container>
