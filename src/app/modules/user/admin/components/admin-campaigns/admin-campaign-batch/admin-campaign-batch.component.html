<div id="admin-campaign-batch-component">

  <!-- section stats -->
  <div class="campaign-stats-wrapper">

    <!-- stat col 1 -->
    <div class="stat1">
      <div class="container">
        <h5 class="heading">{{ 'CAMPAIGNS.STATS.HEADING.RECEPTION' | translate }}</h5>
        <div class="content">
          <h4 class="title">{{ 'CAMPAIGNS.STATS.TITLE.GOOD_EMAILS' | translate }}</h4>
          <h3 class="value">{{ getCampaignStat('good_emails') }}</h3>
        </div>
        <div class="content">
          <h4 class="title">{{ 'CAMPAIGNS.STATS.TITLE.RECEIVED' | translate }}</h4>
          <h3 class="value">{{ getCampaignStat('received') }}</h3>
        </div>
        <div class="content">
          <h4 class="title">{{ 'CAMPAIGNS.STATS.TITLE.BOUNCES' | translate }}</h4>
          <h3 class="value">{{ getCampaignStat('bounces') }}</h3>
        </div>
      </div>
    </div>

    <!-- stat col 2 -->
    <div class="stat2">
      <div class="container">
        <h5 class="heading">{{ 'CAMPAIGNS.STATS.HEADING.INTERACTION' | translate }}</h5>
        <div class="content">
          <h4 class="title">{{ 'CAMPAIGNS.STATS.TITLE.OPENED' | translate }}</h4>
          <h3 class="value">{{ getCampaignStat('opened') }}%</h3>
        </div>
        <div class="content">
          <h4 class="title">{{ 'CAMPAIGNS.STATS.TITLE.CLICKED' | translate }}</h4>
          <h3 class="value">{{ getCampaignStat('clicked') }}%</h3>
        </div>
      </div>
    </div>

    <!-- stat col 3 -->
    <div class="stat3">
      <div class="container">
        <h5 class="heading">{{ 'CAMPAIGNS.STATS.HEADING.DISPLAY' | translate }}</h5>
        <div class="content">
          <h4 class="title">{{ 'CAMPAIGNS.STATS.TITLE.EMAIL' | translate }}</h4>
          <h3 class="value">{{ getCampaignStat('email') }}</h3>
        </div>
        <div class="content">
          <h4 class="title">{{ 'CAMPAIGNS.STATS.TITLE.QUESTIONNAIRE' | translate }}</h4>
          <h3 class="value">{{ getCampaignStat('questionnaire') }}</h3>
        </div>
      </div>
    </div>

  </div>

  <div class="column col-xs-12 col-11 col-mx-auto">

    <!--<button (click)="createPro()" class="btn btn-primary">CreerDesPros Alea + Autobatch si actif</button>-->

    <!-- section no batches -->
    <div *ngIf="noResult" class="section-light-container remove-bottom">

      <!-- note -->
      <div *ngIf="!autoBatchStatus" class="section-light-container remove-top section-error text-notify">
        <div class="circle circle-sm" [ngClass]=" innovationStatus ? 'complete' : 'incomplete' "><i class="fas fa-check"></i></div>{{ 'CAMPAIGNS.BATCH_PAGE.INNOVATION' | translate }}
        <div class="circle circle-sm left" [ngClass]=" quiz ? 'complete' : 'incomplete' "><i class="fas fa-check"></i></div>{{ 'CAMPAIGNS.BATCH_PAGE.QUIZ' | translate }}
        <div class="circle circle-sm left" [ngClass]=" templatesStatus ? 'complete' : 'incomplete' "><i class="fas fa-check"></i></div>{{ 'CAMPAIGNS.BATCH_PAGE.WORKFLOW' | translate }}
      </div>

      <!-- bot -->
      <app-message-space [widthMax]="'354px'">
        {{ 'CAMPAIGNS.BATCH_PAGE.BOT' | translate  }}

        <div *ngIf="batchAlreadyActivated === 'false'" class="form-group bot-group">
          <label class="form-switch" for="auto-batch">
            <input type="checkbox" id="auto-batch" [disabled]="!autoBatchStatus" (change)="onFirstAutoBatch($event)" [ngModel]="campaign?.autoBatch">
            <i class="form-icon"></i>
          </label>
        </div>

        <div *ngIf="batchAlreadyActivated === 'false'"
             [ngStyle]="{ 'visibility': autoBatchStatus ? 'visible' : 'hidden' }"
             class="icons icons-meta cog"
             (click)="activateSidebar('newBatch')">
          <i class="fas fa-cog"></i>
        </div>

        <div *ngIf="batchAlreadyActivated === 'true'" class="loading loading-lg"></div>
      </app-message-space>

    </div>

    <!-- section batches -->
    <div *ngIf="!noResult" class="section-light-container">

      <!-- section status -->
      <div class="section-status">

        <div class="form-group">
          <label class="form-switch" for="result-auto-batch">
            <input type="checkbox" id="result-auto-batch" (change)="onSwitchAutoBatch($event)" [ngModel]="campaign?.autoBatch">
            <i class="form-icon"></i>{{ 'CAMPAIGNS.BATCH_PAGE.AUTO_BATCH_LABEL' | translate }}
          </label>
        </div>

        <div class="form-group">
          <label class="form-switch" for="result-nuggets">
            <input type="checkbox" id="result-nuggets" (change)="OnSwitchNuggets($event)"  [ngModel]="campaign?.nuggets">
            <i class="form-icon"></i>{{ 'CAMPAIGNS.BATCH_PAGE.NUGGETS' | translate }}
          </label>
        </div>

      </div>

      <!-- batches -->
      <div *ngFor="let batch of stats.batches; let batchIndex = index" class="card">

        <div class="card-header">

          <div class="card-title">
            {{ 'CAMPAIGNS.BATCH_PAGE.TITLE' | translate }} {{ batch.size }} pros
            <div class="text-success" *ngIf="batch.nuggets"><i class="fas fa-crow"></i></div>
            <div  class="icons icons-delete" (click)="onClickDelete(batch)"><i class="fas fa-trash-alt"></i></div>
            <!--*ngIf="getDeleteStatus(batch)"-->
          </div>

          <label class="form-switch float-right" for="freeze">
            <input type="checkbox" id="freeze" (change)="OnSwitchFreeze(batch, $event)" [ngModel]="batch.active">
            <i class="form-icon"></i>{{ 'COMMON.LABEL.STARTED' | translate }}
          </label>

        </div>

        <div class="card-body">
          <app-shared-table
            [data]="tableBatch(batchIndex)"
            [config]="config"
            (editRow)="OnClickEdit($event, batch)">
          </app-shared-table>
        </div>

      </div>

    </div>

  </div>

</div>


<!-- modal to delete batch -->
<app-modal [(showModal)]="modalDelete" [modalTitle]="'COMMON.MODAL.TITLE_DELETE'">
  {{ 'CAMPAIGNS.BATCH_PAGE.MODAL_DELETE_CONTENT' | translate }}

  <div class="modal-footer">
    <button class="btn btn-sm btn-cancel">{{ 'COMMON.CANCEL' | translate }}</button>
    <button class="btn btn-sm btn-primary" (click)="onConfirmDelete()">{{ 'COMMON.SUBMIT' | translate }}</button>
  </div>

</app-modal>
<!-- /modal to delete batch -->


<!-- sidebars to perform batch operations -->
<app-sidebar [(template)]="sidebarValue">
  <app-batch-form
    [sidebarState]="sidebarValue.animate_state"
    [type]="sidebarValue.type"
    (batchOutput)="onOutput($event)"
    [currentRow]="currentRow"
    [content]="content">
  </app-batch-form>
</app-sidebar>
<!-- /sidebars to perform batch operations  -->



<!-- commented 20feb

<div class="emailsStats">
    <div>
      <span class="number">{{ mailsToSend }}
        <span class="badge" data-badge="0"><i class="far fa-envelope"></i></span>
      </span>
      professionnels non contactés
    </div>
    <div>
      <span class="number">{{ firstMail }}
        <span class="badge" data-badge="1"><i class="far fa-envelope"></i></span>
      </span>
      premiers mails envoyés
    </div>
    <div>
      <span class="number">{{ secondMail }}
        <span class="badge" data-badge="2"><i class="far fa-envelope"></i></span>
      </span>
      mails de relance envoyés
    </div>
    <div>
      <span class="number">{{ lastMail }}
        <span class="badge" data-badge="3"><i class="far fa-envelope"></i></span>
      </span>
      derniers mails envoyés
    </div>
  </div>

<span *ngIf="!batch.nuggets && batch.status === 0">
  <a class="c-hand" role="button" (click)="nuggetsBatch = batch">
    <i class="fas fa-plus-circle"></i>
  </a>
</span>
-->
<!--
&lt;!&ndash; MODAL : ajout de nuggets &ndash;&gt;
<div class="modal" [ngClass]="{'active': nuggetsBatch}">
  <div class="modal-overlay" (click)="(nuggetsBatch = null) && $event.preventDefault()"></div>
  <div class="modal-container">
    <div class="modal-header">
      <button class="btn btn-clear float-right" (click)="(nuggetsBatch = null) && $event.preventDefault()"></button>
      <div class="modal-title h5">Ajout de pros 'nuggets'</div>
    </div>
    <div class="modal-body">
      <p *ngIf="nuggetsBatch">Êtes-vous sûr de vouloir ajouter {{this.Math.round(nuggetsBatch.size / 10)}} pros à 80% dans ce batch ?</p>
    </div>
    <div class="modal-footer">
      <button class="btn btn-primary" (click)="addNuggetsToBatch(nuggetsBatch._id)">Ajouter</button>
      <button class="btn btn-link" (click)="(nuggetsBatch = null) && $event.preventDefault()">
        {{ 'COMMON.CANCEL' | translate }}
      </button>
    </div>
  </div>
</div>
-->
