<ng-container *ngIf="campaign">
  <section id="admin-campaign-batch-component">

    <!-- section stats -->
    <ul class="stat">

      <!-- stat col 1 -->
      <li class="stat-container fluid">
        <a (click)="updateStats()"><i class="fa fa-sync"></i></a>
        <h5 class="stat-heading">Emails</h5>
        <div class="stat-body">
          <h5 class="stat-sub-heading">To send</h5>
          <span class="stat-value">{{ getCampaignStat('good_emails') }}</span>
        </div>
        <div class="stat-body">
          <h5 class="stat-sub-heading">Received</h5>
          <span class="stat-value">{{ getCampaignStat('received') }}</span>
        </div>
        <div class="stat-body">
          <h5 class="stat-sub-heading">Bounces</h5>
          <span class="stat-value">{{ getCampaignStat('bounces') }}</span>
        </div>
      </li>

      <!-- stat col 2 -->
      <li class="stat-container fluid">
        <h5 class="stat-heading">Interaction</h5>
        <div class="stat-body">
          <h5 class="stat-sub-heading">Opened</h5>
          <span class="stat-value">{{ getCampaignStat('opened') }}%</span>
        </div>
        <div class="stat-body">
          <h5 class="stat-sub-heading">Clicked</h5>
          <span class="stat-value">{{ getCampaignStat('clicked') }}%</span>
        </div>
      </li>

      <!-- stat col 3 -->
      <li class="stat-container fluid">
        <h5 class="stat-heading">Display</h5>
        <div class="stat-body">
          <h5 class="stat-sub-heading">Email</h5>
          <span class="stat-value">{{ getCampaignStat('email') }}</span>
        </div>
        <div class="stat-body">
          <h5 class="stat-sub-heading">Questionnaire</h5>
          <span class="stat-value">{{ getCampaignStat('questionnaire') }}</span>
        </div>
      </li>

    </ul>
    <!-- /section stats -->

    <div class="column col-xs-12 col-11 col-mx-auto">

      <!--<button (click)="createPro()" class="btn btn-primary">CreerDesPros Alea + Autobatch si actif</button>-->

      <!-- section no batches -->
      <ng-container *ngIf="!tableBatch.length">
        <div class="section-light-pad">

          <!-- note -->
          <ng-container *ngIf="!autoBatchStatus">
            <div class="section-error section-pad rm-pad-top">

              <div class="shape is-circle is-sm" [ngClass]=" innovationStatus ? 'complete' : 'incomplete' ">
                <i class="fas fa-check"></i>
              </div>
              <span class="text text-notify text-medium">{{ 'CAMPAIGNS.BATCH_PAGE.INNOVATION' | translate }}</span>

              <div class="shape is-circle is-sm left" [ngClass]=" quiz ? 'complete' : 'incomplete' ">
                <i class="fas fa-check"></i>
              </div>
              <span class="text text-notify text-medium">{{ 'CAMPAIGNS.BATCH_PAGE.QUIZ' | translate }}</span>

              <div class="shape is-circle is-sm left" [ngClass]=" templatesStatus ? 'complete' : 'incomplete' ">
                <i class="fas fa-check"></i>
              </div>
              <span class="text text-notify text-medium">{{ 'CAMPAIGNS.BATCH_PAGE.WORKFLOW' | translate }}</span>

            </div>
          </ng-container>

          <!-- bot -->
          <app-message-template-1 [widthMax]="'473px'">

            <div class="toggle nuggets">
              {{ 'CAMPAIGNS.BATCH_PAGE.NUGGETS' | translate }}
              <div class="form-group">
                <label class="form-switch" for="result-nuggets">
                  <input type="checkbox" id="result-nuggets" (change)="setNuggets()"  [ngModel]="campaign.nuggets">
                  <i class="form-icon"></i>
                </label>
              </div>
            </div>

            <div class="toggle">
              {{ 'CAMPAIGNS.BATCH_PAGE.BOT' | translate  }}
              <div class="form-group">
                <label class="form-switch" for="auto-batch">
                  <input
                    type="checkbox"
                    id="auto-batch"
                    [disabled]="!autoBatchStatus"
                    [value]="campaign.autoBatch"
                    (change)="onSwitchAutoBatch($event)"
                    [ngModel]="campaign.autoBatch">
                  <i class="form-icon"></i>
                </label>
              </div>
            </div>

            <ng-container>
              <div [ngStyle]="{ 'visibility': autoBatchStatus ? 'visible' : 'hidden' }"
                   class="icons is-white absolute tooltip"
                   data-tooltip="Batch Manually"
                   (click)="activateSidebar('newBatch')">
                <i class="fas fa-cog"></i>
              </div>
            </ng-container>

          </app-message-template-1>

        </div>
      </ng-container>
      <!-- /section no batches -->

      <!-- section batches -->
      <ng-container *ngIf="tableBatch.length">
        <div class="section-light-pad rm-pad-bottom">

          <!-- section status -->
          <div class="section-status">

            <div class="form-group">
              <label class="form-switch text-medium" for="result-auto-batch">
                <input type="checkbox" id="result-auto-batch" (change)="onSwitchAutoBatch($event)" [ngModel]="campaign.autoBatch">
                <i class="form-icon"></i>{{ 'CAMPAIGNS.BATCH_PAGE.AUTO_BATCH_LABEL' | translate }}
              </label>
            </div>
            <a (click)="activateSidebar('newBatch')">
              <i class="fas fa-plus"></i>New Batch
            </a>

          </div>

          <!-- batches -->
          <div *ngFor="let batch of stats.batches; let batchIndex = index" class="card">

            <div class="card-header">

              <div class="card-title">
                <span>{{ 'CAMPAIGNS.BATCH_PAGE.TITLE' | translate }} {{ batch.size }} pros</span>
                <span *ngIf="batch.error" class="text-error">{{ 'CAMPAIGNS.BATCH_PAGE.ERROR' | translate }}</span>
                <div *ngIf="getDeleteStatus(batch)" class="icons is-delete tooltip" data-tooltip="Delete Batch" (click)="onClickDelete(batch)"><i class="fas fa-trash-alt"></i></div>
              </div>

              <label class="form-switch float-right text-medium" [for]="batch._id">
                <input type="checkbox" [id]="batch._id" (change)="OnSwitchFreeze(batch , $event)" [ngModel]="batch.active">
                <i class="form-icon"></i>{{ 'COMMON.LABEL.STARTED' | translate }}
              </label>

            </div>

            <div class="card-body">
              <app-shared-table
                [data]="tableBatch(batchIndex)"
                [config]="config"
                (editRow)="OnClickEdit($event, batch)">
              </app-shared-table>
            </div>

          </div>

        </div>
      </ng-container>
      <!-- /section batches -->

    </div>

  </section>
</ng-container>



<!-- modal to delete batch -->
<app-modal [(showModal)]="modalDelete" [title]="'COMMON.MODAL.TITLE_DELETE'">

  <section class="modal-body">
    {{ 'CAMPAIGNS.BATCH_PAGE.MODAL_DELETE_CONTENT' | translate }}
  </section>

  <footer class="modal-footer">
    <button class="button modal-cancel">{{ 'COMMON.BUTTON.CANCEL' | translate }}</button>
    <button (click)="onConfirmDelete()" class="button is-primary">{{ 'COMMON.BUTTON.CONFIRM' | translate }}</button>
  </footer>

</app-modal>
<!-- /modal to delete batch -->


<!-- sidebars to perform batch operations -->
<app-sidebar [(template)]="sidebarValue">
  <app-batch-form
    [sidebarState]="sidebarValue.animate_state"
    [type]="sidebarValue.type"
    (batchOutput)="onOutput($event)"
    [currentRow]="currentRow"
    [campaignWorkflows]="campaignWorkflows"
    [workflow]="currentBatch?.workflow || campaign.settings.defaultWorkflow"
    [content]="content">
  </app-batch-form>
</app-sidebar>
<!-- /sidebars to perform batch operations  -->















<!-- commented 20feb

<div class="emailsStats">
    <div>
      <span class="number">{{ mailsToSend }}
        <span class="badge" data-badge="0"><i class="far fa-envelope"></i></span>
      </span>
      professionnels non contactés
    </div>
    <div>
      <span class="number">{{ firstMail }}
        <span class="badge" data-badge="1"><i class="far fa-envelope"></i></span>
      </span>
      premiers mails envoyés
    </div>
    <div>
      <span class="number">{{ secondMail }}
        <span class="badge" data-badge="2"><i class="far fa-envelope"></i></span>
      </span>
      mails de relance envoyés
    </div>
    <div>
      <span class="number">{{ lastMail }}
        <span class="badge" data-badge="3"><i class="far fa-envelope"></i></span>
      </span>
      derniers mails envoyés
    </div>
  </div>

<span *ngIf="!batch.nuggets && batch.status === 0">
  <a class="c-hand" role="button" (click)="nuggetsBatch = batch">
    <i class="fas fa-plus-circle"></i>
  </a>
</span>
<div class="text-success" *ngIf="batch.nuggets"><i class="fas fa-crow"></i></div>

-->
<!--
&lt;!&ndash; MODAL : ajout de nuggets &ndash;&gt;
<div class="modal" [ngClass]="{'active': nuggetsBatch}">
  <div class="modal-overlay" (click)="(nuggetsBatch = null) && $event.preventDefault()"></div>
  <div class="modal-container">
    <div class="modal-header">
      <button class="btn btn-clear float-right" (click)="(nuggetsBatch = null) && $event.preventDefault()"></button>
      <div class="modal-title h5">Ajout de pros 'nuggets'</div>
    </div>
    <div class="modal-body">
      <p *ngIf="nuggetsBatch">Êtes-vous sûr de vouloir ajouter {{this.Math.round(nuggetsBatch.size / 10)}} pros à 80% dans ce batch ?</p>
    </div>
    <div class="modal-footer">
      <button class="btn btn-primary" (click)="addNuggetsToBatch(nuggetsBatch._id)">Ajouter</button>
      <button class="btn btn-link" (click)="(nuggetsBatch = null) && $event.preventDefault()">
        {{ 'COMMON.CANCEL' | translate }}
      </button>
    </div>
  </div>
</div>
-->
