<div [hidden]="isLoading" id="admin-project">

  <!-- error message while fetching -->
  <section *ngIf="fetchingError" class="container fluid grid-2xl">
    <div class="column col-sm-12 col-11 col-mx-auto">
      <app-utility-message-error></app-utility-message-error>
    </div>
  </section>
  <!-- /error message while fetching -->

  <!-- no fetching error -->
  <div [hidden]="fetchingError">

    <!-- banner project message  -->
    <app-utility-banner [(showBanner)]="showBanner" [position]="'relative'">
      This project has been updated by {{ showBanner }} at {{ updateTime | date: 'H:mm' }}
    </app-utility-banner>
    <!-- banner project message  -->

    <!-- section header -->
    <section class="bg-draft">
      <div class="container fluid grid-2xl">
        <div class="column col-sm-12 col-11 p-top-25 col-mx-auto">

          <!-- heading / actions button -->
          <div class="flex-between flex-wrap m-bottom-10">

            <!-- heading / view like client / objective -->
            <div class="m-right-15 m-bottom-15">

              <div class="d-flex align-center flex-wrap m-bottom-1">
                <h1 class="title is-4 text-white m-bottom-2">{{ title }}</h1>
                <a
                  [routerLink]="['/user/projects/', project._id]"
                  class="button is-link text-white is-xs"
                  target="_blank">
                  View like client
                </a>
              </div>

              <!-- mission objective -->
              <div
                *ngIf="mission.objective && mission.objective.principal
              && mission.objective.principal['en'] && mission.objective.principal['en'] !== 'Other'"
                [ngStyle]="{ 'min-height': '25px' }"
                class="m-bottom-1">
                <div class="objective-wrapper">
                  <i [ngClass]="iconClass"></i>
                  {{ mission.objective.principal[currentLang] }}
                </div>
              </div>
              <!-- /mission objective -->

            </div>
            <!-- /heading / view like client / objective -->

          <!-- actions button -->
          <div *ngIf="canImport" class="dropdown is-right m-bottom-15">

              <a class="button is-white is-sm is-outlined dropdown-toggle" tabindex="0">
                Actions <i class="icon icon-caret icon-right"></i>
              </a>

              <ul class="menu is-md">
                <li
                  *ngIf="isTech || isOperSupervisor"
                  (click)="openModal($event, 'PROJECT')"
                  class="menu-item">
                  Export project
                </li>
                <li (click)="onClickImportFollowUp($event)" class="menu-item">
                  Import follow up emails
                </li>
              </ul>

            </div>
            <!-- /actions button -->

          </div>
          <!-- /heading / actions button -->

          <!-- tabs -->
          <ul class="tab is-fullwidth">
            <ng-container *ngFor="let tab of tabs">
              <li *ngIf="canAccess(['tabs', tab.key])" class="tab-item">
                <a
                  (click)="onClickTab($event, tab.name, tab.route, tab.key)"
                  [routerLink]="['/user/admin/projects/project', project._id, tab.route]"
                  routerLinkActive="active">
                  <i [ngClass]="tab.icon"></i> {{ tab.name }}
                </a>
              </li>
            </ng-container>
          </ul>
          <!-- /tabs -->

        </div>
      </div>
    </section>
    <!-- /section header -->

    <!-- different pages -->
    <div>
      <router-outlet></router-outlet>
    </div>
    <!-- /different pages -->

  </div>
  <!-- /no fetching error -->

</div>


<!-- modals for different actions -->
<app-utility-modal *ngIf="canImport" [(showModal)]="showModal" [enableCloseButton]="true">
  <section class="modal-body">

    <!-- project modal -->
    <div *ngIf="isProjectModal">

      <div class="text-center m-bottom-25">
        <h3 [innerText]="'PROJECT.MODAL.SELECT_FIELD'" class="text-background text-normal" translate></h3>
      </div>

      <div class="form-group">

        <label class="form-checkbox">
          <input type="checkbox" checked disabled>
          <i class="form-icon"></i> {{ 'PROJECT.MODAL.BASE' | translate }}
        </label>

        <label
          *ngFor="let status of status"
          class="form-checkbox">
          <input
            (change)="projectExportConfig['answers'][status] = !projectExportConfig['answers'][status]"
            [checked]="projectExportConfig['answers'][status]"
            type="checkbox">
          <i class="form-icon"></i> {{ 'CAMPAIGNS.' + status | translate }}
        </label>

        <label class="form-checkbox">
          <input
            (change)="projectExportConfig.campaigns = !projectExportConfig['campaigns']"
            [checked]="projectExportConfig['campaigns']"
            type="checkbox">
          <i class="form-icon"></i> {{ 'PROJECT.CAMPAIGNS' | translate }}
        </label>

        <label class="form-checkbox">
          <input
            (change)="projectExportConfig.anonymous = !projectExportConfig['anonymous']"
            [checked]="projectExportConfig['anonymous']"
            type="checkbox">
          <i class="form-icon"></i> {{ 'PROJECT.MODAL.ANON' | translate }}
        </label>

      </div>

    </div>
    <!-- /project modal -->

    <!-- export button -->
    <div class="m-top-40 m-bottom-15 text-center">
      <button (click)="onClickExport($event)" class="button is-primary is-lg" type="button">
        <ng-container *ngIf="isProjectModal">{{ 'COMMON.BUTTON.EXPORT_PROJECT' | translate }}</ng-container>
      </button>
    </div>
    <!-- /export button -->

  </section>
</app-utility-modal>
<!-- /modals for different actions -->

