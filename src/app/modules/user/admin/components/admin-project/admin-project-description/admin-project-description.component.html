<div class="container fluid grid-2xl" id="admin-project-description">
  <div class="column col-sm-12 col-11 col-mx-auto p-top-30 p-bottom-30">

    <!-- notify team -->
    <ng-container *ngIf="innovation.status === 'EDITING'">
      <div class="text-center m-bottom-30">
        <button
          (click)="openModal($event, 'NOTIFY_TEAM')"
          [disabled]="isSendingNotification"
          class="button  is-outlined"
          id="btn-notify-team">
          Notify project team
        </button>
      </div>
    </ng-container>
    <!-- /notify team -->

    <!-- sections dynamic -->
    <section
      *ngFor="let section of activeInnovCard.sections; let i=index;"
      [ngStyle]="{ 'animation-duration': ((i + 1) * 110) + 'ms' }"
      class="animate-slide slide-down section-wrapper has-border">
      <div class="section-body flex-d-column"
           [ngClass]="{'flex-d-column': !showComment[i.toString(10)] && !showSuggestion[i.toString(10)]}">

        <!-- content -->
        <div class="section-content">
          <div class="form-group">

            <!-- label / actions -->
            <div [ngStyle]="{'margin-bottom': isEditable ? '10px' : '11px'}" class="d-flex align-center flex-wrap-wrap">

              <div class="d-flex align-center flex-wrap-wrap title-wrapper m-no-bottom" style="min-width: 100%">

                <label
                  [id]="section.type.toUpperCase()+'-'+i + 1+'href'"
                  [for]="section.type+i"
                  [ngClass]="innovation.innovationCards.length > 1 && isEditable ? 'm-right-10' : 'm-right-30'"
                  class="form-label">
                  <span class="shape is-rounded bg-draft text-white">{{ i + 1 }}</span>
                  <ng-container *ngIf="!isEditable">{{ section.title }}</ng-container>
                  <ng-container *ngIf="isEditable">
                    <input
                      (change)="updateInnovation()"
                      [(ngModel)]="section.title"
                      [id]="section.type.toLowerCase()+'-'+i + 1"
                      autocomplete="off"
                      class="form-input is-sm is-shadowed w-300"
                      type="text">
                  </ng-container>
                </label>

                <!-- edit-preview button -->
                <button
                  *ngIf=" isEditable"
                  [attr.data-tooltip]="!(getPadPreviewMode(i.toString()))? 'Preview':'Edit'"
                  (click)="padPreviewModeOnChange(i.toString())"
                  class="button tooltip is-circled is-action is-outlined text-no-underline is-info
                  m-right-15 is-xs text-sm op-text text-meta"
                  type="button">
                  <i class="fas fa-pencil-alt"
                     *ngIf="getPadPreviewMode(i.toString())"></i>
                  <i class="fas fa-eye" *ngIf="!getPadPreviewMode(i.toString())"></i>
                </button>
                <!-- /edit-preview button -->

                <div class="d-flex align-center justify-center m-left-auto">
                  <a class="button is-link is-xs p-1 m-no" style="min-width: unset"
                     (click)="onShowComment($event,  i.toString(10))"
                     [ngClass]="{'is-draft': !showComment[i.toString(10)],
                        'is-warning': showComment[i.toString(10)]}">Comment</a>

                  <a class="button is-link is-xs m-left-15 p-1 m-no" style="min-width: unset"
                     (click)="onShowSuggestion($event,  i.toString(10))"
                     [ngClass]="{'is-draft': !showSuggestion[i.toString(10)],
                        'is-warning': showSuggestion[i.toString(10)]}">Suggestion</a>
                  <!-- visibility -->
                  <div
                    *ngIf="isEditable"
                    (click)="toggleVisibility($event, i)"
                    [ngClass]="{'m-right-15': section.type === 'OTHER'}"
                    class="icon-container is-overlay">
                <span class="tooltip" [attr.data-tooltip]="section.visibility ? 'Hide section' : 'Unhide section'">
                  <i [ngClass]="section.visibility ? 'fas fa-eye' : 'fas fa-eye-slash'" class="text-alert"></i>
                </span>
                  </div>
                  <!-- /visibility -->

                  <!-- delete -->
                  <div
                    *ngIf="isEditable && section.type === 'OTHER'"
                    (click)="openModal($event, 'DELETE_SECTION', i)"
                    class="icon-container is-overlay">
                <span class="tooltip" data-tooltip="Delete section">
                  <i class="text-alert icon icon-delete"></i>
                </span>
                  </div>
                  <!-- /delete -->

                  <!--                  <div class="label is-primary is-sm tooltip"-->
                  <!--                       data-tooltip="comment & suggestion"-->
                  <!--                       style="cursor: pointer"-->
                  <!--                       (click)="onToggleCommentSuggestion($event, i.toString(10))">UMI-->
                  <!--                  </div>-->
                </div>

              </div>

            </div>
            <!-- /label / actions -->


            <div *ngIf="isEditable && !getPadPreviewMode(i.toString())">
              <app-shared-editors
                [isEditable]="isEditable"
                (textChange)="onContentChange($event, 'sections', i)"
                [text]="section.content"
                [innovationId]="innovation._id"
                [elementId]="section.etherpadElementId || section.type.toLowerCase()+'-'+i + 1 + '-' + currentLang"
                [type]="'pitch'">
              </app-shared-editors>
            </div>

            <div *ngIf="getPadPreviewMode(i.toString())"
                 class="width-100 mce-tinymce pad-preview-mode text-15"
                 [innerHTML]="activeInnovCard.sections[i].content | cleanHtml">
            </div>

            <p *ngIf="!isEditable" [innerHTML]="section.content" class="text-15"></p>

          </div>
        </div>
        <!-- /content -->

        <!-- suggestion / comments -->
        <div class="section-suggestion">

          <!-- comment -->
          <div class="m-bottom-25"
               *ngIf="showComment[i.toString(10)]"
               [id]="section.type.toUpperCase()+'-'+i + 1+'href-comment'">
            <div class="d-flex align-center">
              <div
                (click)="onToggleComment($event, i.toString(10))"
                class="icon-container is-sm is-overlay m-right-1">
                <i
                  [ngClass]="toggleComment[i.toString(10)] ? 'icon icon-arrow-up' : 'icon icon-arrow-down'"
                  class="c-hand text-primary text-15">
                </i>
              </div>
              <span (click)="onToggleComment($event, i.toString(10))" class="spec-text-op">Comment</span>
            </div>
            <div class="m-top-20">
              <div
                [hidden]="!isEditableComment"
                [ngClass]="{'is-hidden': !toggleComment[i.toString(10)]}"
                class="box-shadow">
                <app-shared-editor-tinymce
                  (onTextChange)="onCommentChange($event, 'sections', 'comment', i,
                  section.type, section.etherpadElementId)"
                  [data]="zoneData('sections', 'comment', section.type, section.etherpadElementId)"
                  [id]="section.type.toLowerCase()+'-'+i + 1+'-comment'">
                </app-shared-editor-tinymce>
              </div>
              <div
                *ngIf="!isEditableComment"
                [ngClass]="{'is-hidden': !toggleComment[i.toString(10)]}"
                class="message">
                <p
                  [innerHTML]="zoneData('sections', 'comment', section.type, section.etherpadElementId)"
                  class="message-body">
                </p>
              </div>
            </div>
          </div>
          <!-- /comment -->

          <!-- suggestion -->
          <div *ngIf="showSuggestion[i.toString(10)]">
            <div class="d-flex align-center">
              <div
                (click)="onToggleSuggestion($event, i.toString(10))"
                class="icon-container is-sm is-overlay m-right-1">
                <i
                  [ngClass]="toggleSuggestion[i.toString(10)] ? 'icon icon-arrow-up' : 'icon icon-arrow-down'"
                  class="c-hand text-primary text-15">
                </i>
              </div>
              <span (click)="onToggleSuggestion($event, i.toString(10))" class="spec-text-op">Suggestion</span>
            </div>
            <div class="m-top-20">
              <div
                *ngIf="isEditableComment"
                [ngClass]="{'is-hidden': !toggleSuggestion[i.toString(10)]}">
                <app-shared-editors
                  [isEditable]="isEditableComment"
                  (textChange)="onCommentChange($event, 'sections', 'suggestion', i,
                  section.type, section.etherpadElementId)"
                  [text]="zoneData('sections', 'suggestion', section.type, section.etherpadElementId)"
                  [innovationId]="innovation._id"
                  [elementId]="section.etherpadElementId || section.type.toLowerCase()+'-'+i + 1 + '-' + currentLang"
                  [type]="'suggestion'">
                </app-shared-editors>
              </div>
              <div
                *ngIf="!isEditableComment"
                [ngClass]="{'is-hidden': !toggleSuggestion[i.toString(10)]}"
                class="message">
                <p
                  [innerHTML]="zoneData('sections', 'suggestion', section.type, section.etherpadElementId)"
                  class="message-body">
                </p>
              </div>
            </div>
          </div>
          <!-- /suggestion -->

        </div>
        <!-- /suggestion / comments -->

      </div>
    </section>
    <!-- /sections dynamic -->

    <!-- add new section -->
    <section *ngIf="isEditable" class="section-wrapper text-center has-border p-bottom-50">
      <button
        (click)="openModal($event, 'NEW_SECTION')"
        class="button is-primary is-lg"
        type="button">
        Add new section
      </button>
    </section>
    <!-- /add new section -->

    <!-- section title -->
    <section
      style="animation-duration: 100ms"
      class="animate-slide slide-down section-wrapper p-top-20">
      <div class="section-body"
           [ngClass]="{'flex-d-column': !showComment['title'] && !showSuggestion['title']}">

        <!-- content -->
        <div class="section-content">
          <div class="form-group">

            <div class="d-flex align-center flex-wrap-wrap title-wrapper" style="min-width: 100%">

              <label
                id="project-title-href"
                [ngClass]="{'m-right-10': innovation.innovationCards.length > 1 && isEditable}"
                class="form-label"
                for="project-title">
                <span class="shape is-rounded bg-draft text-white">{{activeInnovCard.sections.length + 1}}</span>Title
              </label>

              <!-- edit-preview button -->
              <button
                *ngIf=" isEditable"
                [attr.data-tooltip]="!(getPadPreviewMode('title'))? 'Preview':'Edit'"
                (click)="padPreviewModeOnChange('title')"
                class="button tooltip is-circled is-action is-outlined text-no-underline is-info is-xs text-sm op-text text-meta m-left-20"
                type="button">
                <i class="fas fa-pencil-alt"
                   *ngIf="getPadPreviewMode('title')"></i>
                <i class="fas fa-eye" *ngIf="!getPadPreviewMode('title')"></i>
              </button>

              <div class="d-flex justify-start align-center m-left-auto">
                <a class="button is-link is-xs p-1 m-no" style="min-width: unset"
                        (click)="onShowComment($event,  'title')"
                        [ngClass]="{'is-draft': !showComment['title'],
                        'is-primary': showComment['title']}">Comment</a>

                <a class="button is-link is-xs m-left-15 p-1 m-no" style="min-width: unset"
                        (click)="onShowSuggestion($event,  'title')"
                        [ngClass]="{'is-draft': !showSuggestion['title'],
                        'is-primary': showSuggestion['title']}">Suggestion</a>
              </div>

              <!-- /edit-preview button -->

              <!--              <div class="label is-primary is-sm tooltip m-left-auto"-->
              <!--                   data-tooltip="comment & suggestion"-->
              <!--                   style="cursor: pointer"-->
              <!--                   (click)="onToggleCommentSuggestion($event, 'title')">UMI-->
              <!--              </div>-->

            </div>

            <app-shared-editors
              id="project-title"
              *ngIf="isEditable && !getPadPreviewMode('title')"
              (textChange)="onContentChange($event, 'title')"
              [text]="activeInnovCard.title"
              [innovationId]="innovation._id"
              [elementId]="'title-' + currentLang"
              [type]="'pitch'"
              [isEditable]="isEditable">
            </app-shared-editors>

            <div *ngIf="getPadPreviewMode('title')"
                 class="width-100 mce-tinymce pad-preview-mode text-15" [innerHTML]="activeInnovCard.title | cleanHtml">
            </div>

            <p *ngIf="!isEditable" [innerHTML]="activeInnovCard.title" class="text-15"></p>

          </div>
        </div>
        <!-- /content -->

        <!-- suggestion / comments -->
        <div class="section-suggestion">

          <!-- comment -->
          <div class="m-bottom-25"
               *ngIf="showComment['title']"
               [id]="'project-title-href-comment'">
            <div class="d-flex align-center">
              <div (click)="onToggleComment($event, 'title')" class="icon-container is-sm is-overlay m-right-1">
                <i
                  [ngClass]="toggleComment.title ? 'icon icon-arrow-up' : 'icon icon-arrow-down'"
                  class="c-hand text-primary text-15">
                </i>
              </div>
              <span (click)="onToggleComment($event, 'title')" class="spec-text-op">Comment</span>
            </div>
            <div class="m-top-20">
              <div [hidden]="!isEditableComment" [ngClass]="{'is-hidden': !toggleComment.title}" class="box-shadow">
                <app-shared-editor-tinymce
                  (onTextChange)="onCommentChange($event, 'title', 'comment')"
                  [data]="zoneData('title', 'comment')"
                  id="title-comment">
                </app-shared-editor-tinymce>
              </div>
              <div *ngIf="!isEditableComment" [ngClass]="{'is-hidden': !toggleComment.title}" class="message">
                <p [innerHTML]="zoneData('title', 'comment')" class="message-body"></p>
              </div>
            </div>
          </div>
          <!-- /comment -->

          <!-- suggestion -->
          <div
            *ngIf="showSuggestion['title']"
            [id]="'project-title-href-suggestion'">
            <div class="d-flex align-center">
              <div
                (click)="onToggleSuggestion($event, 'title')"
                class="icon-container is-sm is-overlay m-right-1">
                <i
                  [ngClass]="toggleSuggestion.title ? 'icon icon-arrow-up' : 'icon icon-arrow-down'"
                  class="c-hand text-primary text-15">
                </i>
              </div>
              <span (click)="onToggleSuggestion($event, 'title')" class="spec-text-op">Suggestion</span>
            </div>
            <div class="m-top-20">
              <div *ngIf="isEditableComment" [ngClass]="{'is-hidden': !toggleSuggestion.title}">
                <app-shared-editors
                  [isEditable]="isEditableComment"
                  (textChange)="onCommentChange($event, 'title', 'suggestion')"
                  [text]="zoneData('title', 'suggestion')"
                  [innovationId]="innovation._id"
                  [elementId]="'title-' + currentLang"
                  [type]="'suggestion'">
                </app-shared-editors>
              </div>
              <div *ngIf="!isEditableComment" [ngClass]="{'is-hidden': !toggleSuggestion.title}" class="message">
                <p [innerHTML]="zoneData('title', 'suggestion')" class="message-body"></p>
              </div>
            </div>
          </div>
          <!-- /suggestion -->

        </div>
        <!-- /suggestion / comments -->

      </div>
    </section>
    <!-- /section title -->

    <!-- section summary -->
    <section style="animation-duration: 220ms" class="animate-slide slide-down has-border section-wrapper">
      <div class="section-body"
           [ngClass]="{'flex-d-column': !showComment['summary'] && !showSuggestion['summary']}">

        <!-- content -->
        <div class="section-content">
          <div class="form-group">

            <div class="d-flex align-center flex-wrap-wrap title-wrapper" style="min-width: 100%">

              <label
                id="project-summary-href"
                [ngClass]="{'m-right-10': innovation.innovationCards.length > 1 && isEditable}"
                class="form-label"
                for="project-summary">
                <span class="shape is-rounded bg-draft text-white">{{activeInnovCard.sections.length + 2}}</span>Summary
              </label>

              <!-- edit-preview button -->
              <button
                *ngIf="isEditable"
                [attr.data-tooltip]="!(getPadPreviewMode('summary'))? 'Preview':'Edit'"
                (click)="padPreviewModeOnChange('summary')"
                class="button tooltip is-circled is-action is-outlined text-no-underline is-info is-xs text-sm op-text text-meta m-left-15"
                type="button">
                <i class="fas fa-pencil-alt"
                   *ngIf="getPadPreviewMode('summary')"></i>
                <i class="fas fa-eye" *ngIf="!getPadPreviewMode('summary')"></i>
              </button>
              <!-- /edit-preview button -->

              <div class="d-flex justify-start align-center m-left-auto">
                <a class="button is-link is-xs p-1 m-no" style="min-width: unset"
                        (click)="onShowComment($event,  'summary')"
                        [ngClass]="{'is-draft': !showComment['summary'],
                        'is-primary': showComment['summary']}">Comment</a>

                <a class="button is-link is-xs m-left-15 p-1 m-no" style="min-width: unset"
                        (click)="onShowSuggestion($event,  'summary')"
                        [ngClass]="{'is-draft': !showSuggestion['summary'],
                        'is-primary': showSuggestion['summary']}">Suggestion</a>
              </div>

              <!--              <div class="label is-primary is-sm tooltip m-left-auto"-->
              <!--                   data-tooltip="comment & suggestion"-->
              <!--                   style="cursor: pointer"-->
              <!--                   (click)="onToggleCommentSuggestion($event, 'summary')">UMI-->
              <!--              </div>-->
            </div>

          </div>

          <div *ngIf="isEditable && !getPadPreviewMode('summary')" class="text-15">
            <app-shared-editors
              id="project-summary"
              (textChange)="onContentChange($event, 'summary')"
              [text]="activeInnovCard.summary"
              [innovationId]="innovation._id"
              [elementId]="'summary-' + currentLang"
              [isEditable]="isEditable"
              [type]="'pitch'">
            </app-shared-editors>
          </div>

          <div *ngIf="getPadPreviewMode('summary')"
               class="width-100 mce-tinymce pad-preview-mode text-15"
               [innerHTML]="activeInnovCard.summary | cleanHtml">
          </div>

          <p *ngIf="!isEditable" [innerHTML]="activeInnovCard.summary" class="text-15"></p>

        </div>
        <!-- /content -->

        <!-- suggestion / comments -->
        <div class="section-suggestion">

          <!-- comment -->
          <div class="m-bottom-25"
               *ngIf="showComment['summary']"
               [id]="'project-summary-href-comment'">
            <div class="d-flex align-center">
              <div
                (click)="onToggleComment($event, 'summary')"
                class="icon-container is-sm is-overlay m-right-1">
                <i
                  [ngClass]="toggleComment.summary ? 'icon icon-arrow-up' : 'icon icon-arrow-down'"
                  class="c-hand text-primary text-15">
                </i>
              </div>
              <span (click)="onToggleComment($event, 'summary')" class="spec-text-op">Comment</span>
            </div>
            <div class="m-top-20">
              <div [hidden]="!isEditableComment" [ngClass]="{'is-hidden': !toggleComment.summary}" class="box-shadow">
                <app-shared-editor-tinymce
                  (onTextChange)="onCommentChange($event, 'summary', 'comment')"
                  [data]="zoneData('summary', 'comment')"
                  id="summary-comment">
                </app-shared-editor-tinymce>
              </div>
              <div *ngIf="!isEditableComment" [ngClass]="{'is-hidden': !toggleComment.summary}" class="message">
                <p [innerHTML]="zoneData('summary', 'comment')" class="message-body"></p>
              </div>
            </div>
          </div>
          <!-- /comment -->

          <!-- suggestion -->
          <div [id]="'project-summary-href-suggestion'"
          *ngIf="showSuggestion['summary']">
            <div class="d-flex align-center">
              <div
                (click)="onToggleSuggestion($event, 'summary')"
                class="icon-container is-sm is-overlay m-right-1">
                <i
                  [ngClass]="toggleSuggestion.summary ? 'icon icon-arrow-up' : 'icon icon-arrow-down'"
                  class="c-hand text-primary text-15">
                </i>
              </div>
              <span (click)="onToggleSuggestion($event, 'summary')" class="spec-text-op">Suggestion</span>
            </div>
            <div class="m-top-20">
              <div *ngIf="isEditableComment" [ngClass]="{'is-hidden': !toggleSuggestion.summary}">
                <app-shared-editors
                  [isEditable]="isEditableComment"
                  (textChange)="onCommentChange($event, 'summary', 'suggestion')"
                  [text]="zoneData('summary', 'suggestion')"
                  [innovationId]="innovation._id"
                  [elementId]="'summary-' + currentLang"
                  [type]="'suggestion'">
                </app-shared-editors>
              </div>
              <div *ngIf="!isEditableComment" [ngClass]="{'is-hidden': !toggleSuggestion.summary}" class="message">
                <p [innerHTML]="zoneData('summary', 'suggestion')" class="message-body"></p>
              </div>
            </div>
          </div>
          <!-- /suggestion -->
        </div>

      </div>
      <!-- /suggestion / comments -->
    </section>
    <!-- /section summary -->

    <!-- section media -->
    <section
      id="project-media"
      [ngStyle]="{ 'animation-duration': ((activeInnovCard.sections.length) * 110) + 'ms' }"
      class="section-wrapper has-border p-no-bottom">

      <div class="section-body" style="flex-direction: row">

        <!-- image -->
        <div class="section-content">
          <div class="form-group">
            <div class="d-flex align-center flex-wrap-wrap title-wrapper">
              <label class="form-label" id="project-media-href">
                <span class="shape is-rounded bg-draft text-white">
                  {{ activeInnovCard.sections && activeInnovCard.sections.length + 3 || 4 }}
                </span>
                Add medias
              </label>
              <!-- edit-preview button -->
              <button
                *ngIf="isEditable"
                [attr.data-tooltip]="!(isBeingEdited)? 'Preview':'Edit'"
                (click)="editMedias()"
                class="button tooltip is-circled is-action is-outlined text-no-underline is-info is-xs text-sm op-text text-meta m-left-15 c-hand"
                type="button">
                <i class="fas fa-pencil-alt"
                   *ngIf="!isBeingEdited"></i>
                <i class="fas fa-eye" *ngIf="isBeingEdited"></i>
              </button>
              <!-- /edit-preview button -->
            </div>

            </div>


      <!-- set main media display -->
        <div *ngIf="isBeingEdited && activeInnovCard.principalMedia['type'] === 'PHOTO'" style="display: flex; flex-direction: row; margin-bottom: 1rem;">
          <div>
            <input type="radio" id="crop" name="radios" value="crop" (change)="adjustMedia(activeInnovCard.principalMedia)" checked>
            <label for="crop" class="m-left-2 m-right-40">Crop main media</label>
          </div>
          <div>
            <input type="radio" id="adjust" name="radios" value="adjust" (change)="adjustMedia(activeInnovCard.principalMedia)">
            <label for="adjust" class="m-left-2">Adjust main media</label>
          </div>
        </div>
      <!-- /set main media display -->

      <!-- upload overlay -->
      <div *ngIf="displayUploadOverlay">
        <div class="modal active">
          <div class="modal-overlay" (click)="toggleDisplayUploadOverlay()"></div>
          <div class="modal-container">
            <div class="modal-body">
        <!-- image -->
                    <div *ngIf="isEditable" class="bg-white box-shadow">
                      <app-shared-upload-zone-photo
                        [uri]="'/innovation/'+innovation._id+'/innovationCard/'+activeInnovCard._id+'/media/image'"
                        (cbFn)="uploadImage($event)">
                      </app-shared-upload-zone-photo>
                    </div>
        <!-- /image -->
        <!-- video -->
        <div style="padding-top: 45px" class="section-suggestion">
                    <div *ngIf="isEditable" class="bg-white box-shadow">
                      <app-shared-upload-zone-video
                        (cbFn)="uploadVideo($event)"
                        [isUploading]="isUploadingVideo">
                      </app-shared-upload-zone-video>
                    </div>
        </div>
        <!-- /video -->
            </div>
          </div>
          <button class="modal-close" (click)="toggleDisplayUploadOverlay()"></button>
        </div>
      </div>
      <!-- /upload overlay -->



      <!-- medias display -->

      <div *ngIf="!isBeingEdited && (activeInnovCard.principalMedia.cloudinary.width / activeInnovCard.principalMedia.cloudinary.height) > 4/3" (click)="toggleDisplayMediaSlider()" class="icon-container is-lg is-overlay" style="left: 483px; position: relative; background-color: #4F5D6B; top: 45px; z-index: 3;">
        <i class="icon icon-search" style="color: white;"></i>
      </div>
      <div *ngIf="!isBeingEdited && (activeInnovCard.principalMedia.cloudinary.width / activeInnovCard.principalMedia.cloudinary.height) < 4/3" (click)="toggleDisplayMediaSlider()" class="icon-container is-lg is-overlay" style="left: 445px; position: relative; background-color: #4F5D6B; top: 45px; z-index: 3;">
        <i class="icon icon-search" style="color: white;"></i>
      </div>
      <!-- portrait display -->
      <div
        *ngIf="activeInnovCard.media.length && (activeInnovCard.principalMedia.cloudinary.width / activeInnovCard.principalMedia.cloudinary.height) < 4/3" style="padding: 16px; width: auto; height: 408px; display: flex; flex-wrap: wrap; flex-direction: column; gap: 8px; background-color: white; align-content: flex-start; align-items: flex-start;">

        <!-- principal media -->
        <div *ngIf="activeInnovCard.principalMedia" class="text-center" style="width: 290px; height: 100%; object-fit: cover; position: relative;">

          <div *ngIf="isBeingEdited" class="icon-container is-overlay is-primary" (click)="toggleDisplayUploadOverlay()" style="position: absolute; top: 0; right: 0; float: right; top: 0; right: 0; background-color: white;">
            <span class="tooltip" data-tooltip="Edit media">
              <i class="icon icon-edit"></i>
            </span>
          </div>

          <!-- if type === 'PHOTO' -->
          <figure *ngIf="activeInnovCard.principalMedia['type'] === 'PHOTO'
          && mediaSrc(activeInnovCard.principalMedia, 'IMAGE')" style="width: 100%; height: 100%; object-fit: cover; background-color: #ececec; display: flex; place-content: center;">
            <img
              style="cursor: pointer; height: 100%; object-fit: cover;"
              [ngStyle]="{'width': isMediaAjusted}"
              (click)="mediaToShow(mediaSrc(activeInnovCard.principalMedia, 'IMAGE'))"
              [src]="mediaSrc(activeInnovCard.principalMedia, 'IMAGE').replace(',h_159', '').replace(',w_240', '')"
              alt=" "
              class="img-responsive">
          </figure>
          <!-- /if type === 'PHOTO' -->

          <!-- if type === 'VIDEO' -->
          <iframe
            *ngIf="activeInnovCard.principalMedia['type'] === 'VIDEO'
            && mediaSrc(activeInnovCard.principalMedia, 'VIDEO')"
            [src]="mediaSrc(activeInnovCard.principalMedia, 'VIDEO')" >
          </iframe>
          <!-- /if type === 'VIDEO' -->
        </div>
        <!-- /principal media -->

        <!-- secondary medias -->
        <!-- no filter -->
        <ng-container *ngIf="activeInnovCard.media.length > 0 && isBeingEdited">
          <ng-container *ngFor="let media of activeInnovCard.media; let i=index;">
            <div
              *ngIf="media._id !== (activeInnovCard.principalMedia && activeInnovCard.principalMedia._id)"
              class="text-center" style="width: 160px; height: 120px; object-fit: cover; position: relative;">

              <div *ngIf="isBeingEdited" style="position: absolute; top: 0; right: 0; float: right; z-index: 2">
                <div class="icon-container is-overlay" (click)="toggleDisplayUploadOverlay()" style="background-color: white; margin-right: 4px">
                <span class="tooltip" data-tooltip="Edit media" (click)="setEditedMediaIndex(i)">
                  <i class="icon icon-edit"></i>
                </span>
                </div>
                <div class="icon-container is-overlay" (click)="onDeleteMedia(media)" style="background-color: white;">
                <span class="tooltip" data-tooltip="Delete media">
                  <i class="icon icon-delete" style="color: #c93a2a"></i>
                </span>
                </div>
              </div>

              <!-- if type === 'PHOTO' -->
              <figure *ngIf="media['type'] && mediaSrc(media, 'IMAGE')" style="width: 160px; height: 120px; object-fit: cover; background-color: #ececec; display: flex; place-content: center;">
                <img
                  style="cursor: pointer; width: 100%; height: 100%; object-fit: cover;"
                  (click)="toggleDisplayMediaSlider('showSelected', i)"
                  [src]="mediaSrc(media, 'IMAGE')"
                  alt=" "
                  class="img-responsive" >
              </figure>
              <!-- /if type === 'PHOTO' -->

              <!-- if type === 'VIDEO' -->
              <iframe
                *ngIf="media['type'] === 'VIDEO' && mediaSrc(media, 'VIDEO')"
                [src]="mediaSrc(media, 'VIDEO')"  height="120px" width="160px"
              style="border: none">
              </iframe>
              <!-- /if type === 'VIDEO' -->

              <!-- set principal -->
              <div *ngIf="isNotMainMedia(media) && isBeingEdited && media['type'] !== 'VIDEO' " class="text-sm text-left set-main-overlay" style="width: 100%; height: 100%; position: absolute; top: 0; left: 0;">
                <span
                  (click)="onSetPrincipal(media)"
                  [ngClass]="isSavingMedia ? 'text-disabled' : 'c-hand text-hover-underline'"
                  class="text-primary"
                  style="height: 22px; padding-left: 4px; width: 100%; background-color: #ececec; position: absolute; bottom: 0; right: 0; opacity: 80%"
                  [id]="'btn-principal-media-'+i">
                  Set as main media
                </span>
              </div>
              <!-- /set principal -->

            </div>
          </ng-container>
        </ng-container>
        <!-- /no filter -->
        <!-- filter -->
        <ng-container *ngIf="activeInnovCard.media.length > 0 && !isBeingEdited">
          <ng-container *ngFor="let media of activeInnovCard.media | slice:0:4; let i=index;">
            <div
              *ngIf="media._id !== (activeInnovCard.principalMedia && activeInnovCard.principalMedia._id)"
              class="text-center" style="width: 160px; height: 120px; object-fit: cover; position: relative;">

              <div *ngIf="isBeingEdited" style="position: absolute; top: 0; right: 0; float: right; z-index: 2">
                <div class="icon-container is-overlay" (click)="toggleDisplayUploadOverlay()" style="background-color: white; margin-right: 4px">
                <span class="tooltip" data-tooltip="Edit media" (click)="setEditedMediaIndex(i)">
                  <i class="icon icon-edit"></i>
                </span>
                </div>
                <div class="icon-container is-overlay" (click)="onDeleteMedia(media)" style="background-color: white;">
                <span class="tooltip" data-tooltip="Delete media">
                  <i class="icon icon-delete" style="color: #c93a2a"></i>
                </span>
                </div>
              </div>

              <!-- if type === 'PHOTO' -->
              <figure *ngIf="media['type'] && mediaSrc(media, 'IMAGE')" style="width: 160px; height: 120px; object-fit: cover; background-color: #ececec; display: flex; place-content: center;">
                <img
                  style="cursor: pointer; width: 100%; height: 100%; object-fit: cover;"
                  (click)="toggleDisplayMediaSlider('showSelected', i)"
                  [src]="mediaSrc(media, 'IMAGE')"
                  alt=" "
                  class="img-responsive" >
              </figure>
              <!-- /if type === 'PHOTO' -->

              <!-- if type === 'VIDEO' -->
              <iframe
                *ngIf="media['type'] === 'VIDEO' && mediaSrc(media, 'VIDEO')"
                [src]="mediaSrc(media, 'VIDEO')"  height="120px" width="160px"
                style="border: none">
              </iframe>
              <!-- /if type === 'VIDEO' -->

              <!-- set principal -->
              <div *ngIf="isNotMainMedia(media) && isBeingEdited && media['type'] !== 'VIDEO' " class="text-sm text-left set-main-overlay" style="width: 100%; height: 100%; position: absolute; top: 0; left: 0;">
                <span
                  (click)="onSetPrincipal(media)"
                  [ngClass]="isSavingMedia ? 'text-disabled' : 'c-hand text-hover-underline'"
                  class="text-primary"
                  style="height: 22px; padding-left: 4px; width: 100%; background-color: #ececec; position: absolute; bottom: 0; right: 0; opacity: 80%"
                  [id]="'btn-principal-media-'+i">
                  Set as main media
                </span>
              </div>
              <!-- /set principal -->

            </div>
          </ng-container>
        </ng-container>
        <!-- /filter -->
        <!-- /secondary medias -->

        <!-- new media card -->
        <div *ngIf="isBeingEdited">
          <file-drop class="drop-container media-card text-center" (click)="toggleDisplayUploadOverlay()">
            <div class="icon-container is-overlay">
                  <span class="tooltip" data-tooltip="Add new media" (click)="setEditedMediaIndex(undefined)">
                    <i class="icon icon-plus"></i>
                  </span>
            </div>
          </file-drop>
        </div>
        <!-- /new media card -->

      </div>
      <!-- /portrait display -->

      <!-- landscape display -->
      <div
        *ngIf="activeInnovCard.media.length && (activeInnovCard.principalMedia.cloudinary.width / activeInnovCard.principalMedia.cloudinary.height) > 4/3" style="padding: 16px; width: 528px; height: auto; display: flex; flex-wrap: wrap; gap: 8px; background-color: white; place-items: center; box-sizing: border-box">

        <!-- principal media -->
        <div *ngIf="activeInnovCard.principalMedia" class="text-center" style="width: 100%; height: 290px; object-fit: cover; position: relative;">

          <div *ngIf="isBeingEdited" class="icon-container is-overlay is-primary" (click)="toggleDisplayUploadOverlay()" style="position: absolute; top: 0; right: 0; float: right; top: 0; right: 0; background-color: white;">
            <span class="tooltip" data-tooltip="Edit media">
              <i class="icon icon-edit"></i>
            </span>
          </div>

          <!-- if type === 'PHOTO' -->
          <figure *ngIf="activeInnovCard.principalMedia['type'] === 'PHOTO'
          && mediaSrc(activeInnovCard.principalMedia, 'IMAGE')" style="width: 100%; height: 100%; object-fit: cover; background-color: #ccc; display: flex; place-content: center;">
            <img
              style="cursor: pointer; height: 100%; object-fit: cover;"
              [ngStyle]="{'width': isMediaAjusted}"
              (click)="mediaToShow(mediaSrc(activeInnovCard.principalMedia, 'IMAGE'))"
              [src]="mediaSrc(activeInnovCard.principalMedia, 'IMAGE').replace(',h_159', '').replace(',w_240', '')"
              alt=" "
              class="img-responsive">
          </figure>
          <!-- /if type === 'PHOTO' -->

          <!-- if type === 'VIDEO' -->
          <iframe
            *ngIf="activeInnovCard.principalMedia['type'] === 'VIDEO'
            && mediaSrc(activeInnovCard.principalMedia, 'VIDEO')"
            [src]="mediaSrc(activeInnovCard.principalMedia, 'VIDEO')" >
          </iframe>
          <!-- /if type === 'VIDEO' -->
        </div>
        <!-- /principal media -->

        <!-- secondary medias -->
        <!-- filter -->
        <ng-container *ngIf="activeInnovCard.media.length > 0 && !isBeingEdited">
          <ng-container *ngFor="let media of activeInnovCard.media | slice:0:4; let i=index;">
            <div
              *ngIf="media._id !== (activeInnovCard.principalMedia && activeInnovCard.principalMedia._id)"
              class="text-center" style="width: 160px; height: 120px; object-fit: cover; position: relative;">

            <div *ngIf="isBeingEdited" style="position: absolute; top: 0; right: 0; float: right; z-index: 2">
              <div class="icon-container is-overlay" (click)="toggleDisplayUploadOverlay()" style="background-color: white; margin-right: 4px">
                <span class="tooltip" data-tooltip="Edit media" (click)="setEditedMediaIndex(i)">
                  <i class="icon icon-edit"></i>
                </span>
              </div>
              <div class="icon-container is-overlay" (click)="onDeleteMedia(media)" style="background-color: white;">
                <span class="tooltip" data-tooltip="Delete media">
                  <i class="icon icon-delete" style="color: #c93a2a"></i>
                </span>
              </div>
            </div>

              <!-- if type === 'PHOTO' -->
              <figure *ngIf="media['type'] === 'PHOTO' && mediaSrc(media, 'IMAGE')"  style="width: 160px; height: 120px; object-fit: cover; background-color: #ccc; display: flex; place-content: center;">
                <img
                  style="cursor: pointer; width: 100%; height: 100%; object-fit: cover;"
                  (click)="toggleDisplayMediaSlider('showSelected', i)"
                  [src]="mediaSrc(media, 'IMAGE')"
                  alt=" "
                  class="img-responsive" >
              </figure>
              <!-- /if type === 'PHOTO' -->

              <!-- if type === 'VIDEO' -->
              <iframe
                *ngIf="media['type'] === 'VIDEO' && mediaSrc(media, 'VIDEO')"
                [src]="mediaSrc(media, 'VIDEO')"  height="120px" width="160px"
              style="border: none">
              </iframe>
              <!-- /if type === 'VIDEO' -->

              <!-- set principal -->
              <div *ngIf="isNotMainMedia(media) && isBeingEdited && media['type'] !== 'VIDEO' " class="text-sm text-left set-main-overlay" style="width: 100%; height: 100%; position: absolute; top: 0; left: 0;">
                <span
                  (click)="onSetPrincipal(media)"
                  [ngClass]="isSavingMedia ? 'text-disabled' : 'c-hand text-hover-underline'"
                  class="text-primary"
                  style="height: 22px; padding-left: 4px; width: 100%; background-color: #ececec; position: absolute; bottom: 0; right: 0; opacity: 80%"
                  [id]="'btn-principal-media-'+i">
                  Set as main media
                </span>
              </div>
              <!-- /set principal -->

            </div>
          </ng-container>
        </ng-container>
        <!-- /filter -->
        <!-- no filter -->
        <ng-container *ngIf="activeInnovCard.media.length > 0 && isBeingEdited">
          <ng-container *ngFor="let media of activeInnovCard.media; let i=index;">
            <div
              *ngIf="media._id !== (activeInnovCard.principalMedia && activeInnovCard.principalMedia._id)"
              class="text-center" style="width: 160px; height: 120px; object-fit: cover; position: relative;">

              <div *ngIf="isBeingEdited" style="position: absolute; top: 0; right: 0; float: right; z-index: 2">
                <div class="icon-container is-overlay" (click)="toggleDisplayUploadOverlay()" style="background-color: white; margin-right: 4px">
                <span class="tooltip" data-tooltip="Edit media" (click)="setEditedMediaIndex(i)">
                  <i class="icon icon-edit"></i>
                </span>
                </div>
                <div class="icon-container is-overlay" (click)="onDeleteMedia(media)" style="background-color: white;">
                <span class="tooltip" data-tooltip="Delete media">
                  <i class="icon icon-delete" style="color: #c93a2a"></i>
                </span>
                </div>
              </div>

              <!-- if type === 'PHOTO' -->
              <figure *ngIf="media['type'] === 'PHOTO' && mediaSrc(media, 'IMAGE')"  style="width: 160px; height: 120px; object-fit: cover; background-color: #ccc; display: flex; place-content: center;">
                <img
                  style="cursor: pointer; width: 100%; height: 100%; object-fit: cover;"
                  (click)="toggleDisplayMediaSlider('showSelected', i)"
                  [src]="mediaSrc(media, 'IMAGE')"
                  alt=" "
                  class="img-responsive" >
              </figure>
              <!-- /if type === 'PHOTO' -->

              <!-- if type === 'VIDEO' -->
              <iframe
                *ngIf="media['type'] === 'VIDEO' && mediaSrc(media, 'VIDEO')"
                [src]="mediaSrc(media, 'VIDEO')"  height="120px" width="160px"
                style="border: none">
              </iframe>
              <!-- /if type === 'VIDEO' -->

              <!-- set principal -->
              <div *ngIf="isNotMainMedia(media) && isBeingEdited && media['type'] !== 'VIDEO' " class="text-sm text-left set-main-overlay" style="width: 100%; height: 100%; position: absolute; top: 0; left: 0;">
                <span
                  (click)="onSetPrincipal(media)"
                  [ngClass]="isSavingMedia ? 'text-disabled' : 'c-hand text-hover-underline'"
                  class="text-primary"
                  style="height: 22px; padding-left: 4px; width: 100%; background-color: #ececec; position: absolute; bottom: 0; right: 0; opacity: 80%"
                  [id]="'btn-principal-media-'+i">
                  Set as main media
                </span>
              </div>
              <!-- /set principal -->

            </div>
          </ng-container>
        </ng-container>
        <!-- /no filter -->
        <!-- /secondary medias -->

        <!-- new media card -->
        <div *ngIf="isBeingEdited">
          <file-drop class="drop-container media-card text-center" (click)="toggleDisplayUploadOverlay()">
            <div class="icon-container is-overlay" (click)="setEditedMediaIndex(undefined)">
                  <span class="tooltip" data-tooltip="Add new media">
                    <i class="icon icon-plus"></i>
                  </span>
            </div>
          </file-drop>
        </div>
        <!-- /new media card -->
      <!-- /landscape display -->

      </div>

      <!-- see more btn -->
      <ngContainer *ngIf="!isBeingEdited && activeInnovCard.media.length > 4 && (activeInnovCard.principalMedia.cloudinary.width / activeInnovCard.principalMedia.cloudinary.height) > 4/3" >
        <div style="margin: -12px 0 0 387px">
          <button (click)="toggleDisplayMediaSlider()" class="button is-primary is-xs">See more</button>
        </div>
      </ngContainer>
      <ngContainer *ngIf="!isBeingEdited && activeInnovCard.media.length > 4 && (activeInnovCard.principalMedia.cloudinary.width / activeInnovCard.principalMedia.cloudinary.height) < 4/3" >
        <div style="margin: -12px 0 0 349px">
          <button (click)="toggleDisplayMediaSlider()" class="button is-primary is-xs">See more</button>
        </div>
      </ngContainer>
      <!-- /see more btn -->
      <!-- /medias display -->

          <!-- slider -->
          <div *ngIf="displayMediaSlider" style="background: rgba(58,66,77,0.96); width: 100vw; height: 100vh; position: fixed; top: 0; left: 0; right: 0; bottom: 0; display: flex; place-items: center; z-index: 6">
            <div class="icon-container is-lg is-overlay controllers" (click)="slideMedia('showPrevious')" style="z-index: 100;">
              <i class="icon icon-arrow-left" style="border: none"></i>
            </div>
            <div style="height: 90%; width: 80%; margin: auto; display: flex; place-content: center; flex-direction: column">
              <div style="justify-content: center;display: flex;height: 90%;width: 100%;">
                <iframe
                  *ngIf="activeInnovCard.media[slideToShow].type === 'VIDEO'"
                  [src]="mediaSrc(activeInnovCard.media[slideToShow], 'VIDEO')"
                  style="height: auto; width: 100%; object-fit: contain; border: none">
                </iframe>
                <img *ngIf="activeInnovCard.media[slideToShow].type === 'PHOTO' && (activeInnovCard.media[slideToShow].cloudinary.width / activeInnovCard.media[slideToShow].cloudinary.height) < 4/3" [src]=activeInnovCard.media[slideToShow].url style="height: 100%; width: auto; object-fit: contain">
                <img *ngIf="activeInnovCard.media[slideToShow].type === 'PHOTO' && (activeInnovCard.media[slideToShow].cloudinary.width / activeInnovCard.media[slideToShow].cloudinary.height) > 4/3" [src]=activeInnovCard.media[slideToShow].url style="height: auto; width: 100%;object-fit: contain">
              </div>
              <p style="margin-bottom: 0;text-align: center;color: white;padding-top: 32px;">{{slideToShow +1}}/{{activeInnovCard.media.length}}</p>
            </div>
            <div class="icon-container is-lg is-overlay controllers" (click)="slideMedia( 'showNext')" style="z-index: 10;">
              <i class="icon icon-arrow-right"></i>
            </div>
            <button class="modal-close slider-close-btn" (click)="toggleDisplayMediaSlider('closeSlider')"></button>
          </div>
          <!-- /slider -->

        </div>
      </div>
    </section>
    <!-- section media -->

  </div>
</div>

<!-- modal to add New section | Delete section -->
<umius-modal *ngIf="isEditable" [(showModal)]="showModal">

  <section class="modal-body">

    <h2 [ngSwitch]="{ 'color': '4C4C4C' }" class="title is-4 text-center text-bold m-bottom-30">
      <ng-container *ngIf="modalType === 'NEW_SECTION'">Add new section</ng-container>
      <ng-container *ngIf="modalType === 'NOTIFY_TEAM'">Notify project team</ng-container>
      <ng-container *ngIf="modalType === 'DELETE_SECTION'">Delete section</ng-container>
    </h2>

    <div [ngSwitch]="modalType">

      <!-- notify team -->
      <div *ngSwitchCase="'NOTIFY_TEAM'">
        You are about to send an email to the Market Test project team.
        <div class="p-left-15 p-top-10">
          <p class="m-bottom-1">
            Last mailing date: {{ notificationJobs.length ? (notificationJobs[0].updated | date:'dd/MM/y') : 'NA' }}
          </p>
          <p>Number of mailings: {{ notificationJobs.length }}</p>
        </div>
      </div>
      <!-- /notify team -->

      <!-- delete section -->
      <div *ngSwitchCase="'DELETE_SECTION'">
        Do you really want to delete this section? Please keep in mind that to delete
        the section successfully you have to save the project.
      </div>
      <!-- /delete section -->

      <!-- new section -->
      <div *ngSwitchCase="'NEW_SECTION'" class="mxw-450 m-left-auto m-right-auto">

        <!-- title -->
        <div class="form-group m-bottom-20">
          <label class="form-label" for="new-section-title">Title</label>
          <input
            [(ngModel)]="newSection.title"
            class="form-input is-sm is-shadowed"
            id="new-section-title"
            placeholder="Add the new section title here..."
            type="text">
        </div>
        <!-- /title -->

        <!-- type -->
        <div class="form-group m-bottom-20">
          <label class="form-label" for="new-section-type">Type</label>
          <select
            [(ngModel)]="newSection.type"
            id="new-section-type"
            class="form-select is-shadowed is-sm">
            <!--<option value="ISSUE">Issue</option>-->
            <!--<option value="SOLUTION">Solution</option>-->
            <option value="OTHER">Other</option>
          </select>
        </div>
        <!-- /type -->

        <p class="text-alert text-sm">
          Please keep in mind that to create a new section successfully you have to save the project.
        </p>

      </div>
      <!-- /new section -->

    </div>

  </section>

  <footer [ngSwitch]="modalType" class="modal-footer justify-center">

    <button
      (click)="closeModal()"
      [id]="'btn-cancel'"
      class="button modal-cancel"
      type="button">
      Cancel
    </button>

    <!-- notify team -->
    <button
      (click)="onNotifyTeam($event)"
      *ngSwitchCase="'NOTIFY_TEAM'"
      [disabled]="isSendingNotification"
      class="button "
      id="btn-modal-confirm-notify-team"
      type="button">
      Confirm
    </button>
    <!-- notify team -->

    <!-- new section -->
    <button
      *ngSwitchCase="'NEW_SECTION'"
      (click)="createNewSection($event)"
      [disabled]="!newSection.title"
      class="button "
      type="button">
      Confirm
    </button>
    <!-- new section -->

    <!-- delete section -->
    <button
      *ngSwitchCase="'DELETE_SECTION'"
      (click)="deleteSection($event)"
      class="button "
      type="button">
      Confirm
    </button>
    <!-- delete section -->

  </footer>

</umius-modal>
<!-- /modal to add New section | Delete section -->

<!-- modal to view image -->
<!--<umius-modal [(showModal)]="modalMedia" [medias]="[selectedMedia]" style="width: auto"></umius-modal>-->
<!-- /modal to view image-->
