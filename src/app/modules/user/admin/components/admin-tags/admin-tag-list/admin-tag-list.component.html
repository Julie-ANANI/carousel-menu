<div id="admin-tag-list" class="p-top-25 p-bottom-30">
  <div class="container fluid grid-2xl">
    <div class="column col-11 col-sm-12 col-mx-auto">

      <div>
        <app-admin-tag-new></app-admin-tag-new>
      </div>

      <h2 class="title is-6 text-notify">{{ total }} result</h2>

      <div class="table-responsive">
        <table class="table">
          <thead>
          <tr>
            <th>Select</th>
            <th><app-shared-sort [(sortConfig)]="sortConfig" [property]="'label'" label="Label"></app-shared-sort></th>
            <th><app-shared-sort [(sortConfig)]="sortConfig" [property]="'description'" label="Description"></app-shared-sort></th>
            <th><app-shared-sort [(sortConfig)]="sortConfig" [property]="'type'" label="Type"></app-shared-sort></th>
            <th><app-shared-sort [(sortConfig)]="sortConfig" [property]="'attachments'" label="Attachments"></app-shared-sort></th>
            <th><app-shared-sort [(sortConfig)]="sortConfig" [property]="'created'" label="Created"></app-shared-sort></th>
            <th>{{ 'CAMPAIGNS.ACTIONS' | translate }}</th>
          </tr>
          </thead>
          <tbody>
          <tr *ngFor="let datum of data; let i = index;" [ngClass]="{'active': datum['isSelected']}">
            <ng-container [ngSwitch]="editDatum[datum._id]">

              <ng-container *ngSwitchCase="true">
                <td><input type="checkbox" [(ngModel)]="datum['isSelected']"/></td>
                <td>
                  <input
                    #tagEntryLabelEn
                    (ngModelChange)="onUpdateEntry(tagEntryLabelEn.value, i, 'label', 'en')"
                    [ngModel]="datum.entry | langEntry:'label': 'en'"
                    alt="label"
                    placeholder="label in english"
                    size="20"
                    type="text"/>
                  <input
                    #tagEntryLabelFr
                    (ngModelChange)="onUpdateEntry(tagEntryLabelFr.value, i, 'label', 'fr')"
                    [ngModel]="datum.entry | langEntry:'label': 'fr'"
                    alt="label"
                    placeholder="label en français"
                    size="20"
                    type="text"/>
                </td>
                <td>
                  <input
                    #tagEntryDescEn
                    (ngModelChange)="onUpdateEntry(tagEntryDescEn.value, i, 'description', 'en')"
                    [ngModel]="datum.entry | langEntry:'description': 'en'"
                    alt="description"
                    placeholder="description in english"
                    size="40"
                    type="text"/>
                  <input
                    #tagEntryDescFr
                    (ngModelChange)="onUpdateEntry(tagEntryDescFr.value, i, 'description', 'fr')"
                    [ngModel]="datum.entry | langEntry:'description': 'fr'"
                    alt="description"
                    placeholder="description en français"
                    size="40"
                    type="text"/>
                </td>
                <td>
                  <select [(ngModel)]="datum.type">
                    <option value="UNKNOWN" [textContent]="'TAGS.TYPE.UNKNOWN'" translate></option>
                    <option value="SECTOR" [textContent]="'TAGS.TYPE.SECTOR'" translate></option>
                    <option value="VALUE_CHAIN" [textContent]="'TAGS.TYPE.VALUE_CHAIN'" translate></option>
                    <option value="SOLUTION_TYPE" [textContent]="'TAGS.TYPE.SOLUTION_TYPE'" translate></option>
                    <option value="QUALIFICATION" [textContent]="'TAGS.TYPE.QUALIFICATION'" translate></option>
                  </select>
                </td>
                <td>
                  <app-utility-auto-complete-input
                    id="attachments"
                    (update)="addAttachment($event, datum)"
                    [config]="buildAttachmentsListConfig(datum.attachments)">
                  </app-utility-auto-complete-input>
                </td>
                <td>{{ datum.created | date}}</td>
                <td>
                  <button class="btn btn-action" (click)="editDatum[datum._id] = false"><i class="fas fa-times"></i></button>
                  <button class="btn btn-action" (click)="updateEntry(datum, $event)"><i class="far fa-save"></i></button>
                </td>
              </ng-container>

              <ng-container *ngSwitchDefault>
                <ng-container>
                  <td><input type="checkbox" [(ngModel)]="datum['isSelected']"/></td>
                  <td>{{ (datum.entry | langEntry:'label': lang) || '--' }}</td>
                  <td>{{ (datum.entry | langEntry:'description': lang) || '--' }}</td>
                  <td>{{ ('TAGS.TYPE.'+datum.type | translate) || '--' }}</td>
                  <td>{{ datum.attachments?.length || 0 }}</td>
                  <td>{{ datum.created | date }}</td>
                </ng-container>
                <td>
                  <button class="btn btn-action" (click)="editDatum[datum._id] = true"><i class="fas fa-edit"></i></button>
                </td>
              </ng-container>

            </ng-container>
          </tr>
          </tbody>
          <tfoot>
          <tr>
            <td colspan="12">
              <app-pagination
                [configValue]="paginationConfig"
                (configChange)="configChange($event)"
                [total]="total"
                [propertyName]="'admin-tags'">
              </app-pagination>
            </td>
          </tr>
          </tfoot>
        </table>
      </div>

    </div>
  </div>
</div>

