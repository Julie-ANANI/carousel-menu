<div id="admin-batches-display">
  <div *ngIf="weekBatches.length > 0">

    <!-- navigate labels -->
    <div class="flex-between">

      <button
        (click)="onClickLast()"
        [ngStyle]="{ 'min-width': 'unset' }"
        class="button is-outlined is-info is-xs"
        id="btn-last"
        type="button">
        Last week
      </button>

      <div>
        <div class="label is-rounded is-success">First mail</div>
        <div class="label is-rounded is-draft">Second mail</div>
        <div class="label is-rounded is-info">Third mail</div>
      </div>

      <button
        (click)="onClickNext()"
        [ngStyle]="{ 'min-width': 'unset' }"
        class="button is-outlined is-info is-xs"
        id="btn-next"
        type="button">
        Next week
      </button>

    </div>
    <!-- /navigate labels -->

    <!-- batches -->
    <div class="batch-wrapper">

      <!-- is loading -->
      <div *ngIf="isLoading" class="loading is-primary m-auto"></div>
      <!-- /is loading -->

      <!-- loading finished -->
      <ng-container *ngIf="!isLoading">
        <div *ngFor="let days of weekBatches; let index1 = index;" class="batch">
          <div *ngFor="let batches of days; let index2 = index">
            <p *ngIf="index2 === 0">{{ getDateString(batches) }}</p>

            <!-- index2 !== 0 -->
            <ng-container *ngIf="index2 !== 0">

              <!-- index2 < 4 -->
              <div *ngIf="index2 < 4" class="batch-body">

                <ng-container *ngIf="getState(batches, index1) === 0">
                  <div (click)="showPreview($event, batches)" class="label is-rounded c-hand is-success">
                    <i *ngIf="batches.error" class="fa fa-exclamation-circle text-error m-right-2"></i>
                    {{ batches['innovation']['name']  | ellipsis:20 }}  {{ batches.size }}
                  </div>
                </ng-container>

                <ng-container *ngIf="getState(batches, index1) === 1">
                  <div (click)="showPreview($event, batches)" class="label is-rounded c-hand is-draft">
                    <i *ngIf="batches.error" class="fa fa-exclamation-circle text-error m-right-2"></i>
                    {{ batches['innovation']['name'] | ellipsis:20 }}  {{ batches.size }}
                  </div>
                </ng-container>

                <ng-container *ngIf="getState(batches, index1) === 2">
                  <div (click)="showPreview($event, batches)" class="label is-rounded c-hand  is-info">
                    <i *ngIf="batches.error" class="fa fa-exclamation-circle text-error m-right-2"></i>
                    {{ batches['innovation']['name'] | ellipsis:20 }}  {{ batches.size }}
                  </div>
                </ng-container>

              </div>
              <!-- index2 < 4 -->

              <!-- index2 === 4 -->
              <div *ngIf="index2 === 4" class="popover justify-center">
                <div class="text-link text-xs">see more...</div>
                <div class="popover-container w-200">
                  <div class="card p-10">
                    <div class="card-body p-no">
                      <ng-container *ngFor="let batchesOver of days; let index3 = index">
                        <div *ngIf="index3 > 0" class="batch-body">

                          <ng-container *ngIf="getState(batchesOver, index1) === 0">
                            <div (click)="showPreview($event, batchesOver)" class="label p-2 is-success is-rounded c-hand">
                              <i *ngIf="batchesOver.error" class="fa fa-exclamation-circle text-error m-right-2"></i>
                              {{ batchesOver['innovation']['name'] | ellipsis:15 }}  {{ batchesOver.size }}
                            </div>
                          </ng-container>

                          <ng-container *ngIf="getState(batchesOver, index1) === 1">
                            <div (click)="showPreview($event, batchesOver)" class="label p-2 is-draft is-rounded c-hand">
                              <i *ngIf="batchesOver.error" class="fa fa-exclamation-circle text-error m-right-2"></i>
                              {{ batchesOver['innovation']['name'] | ellipsis:15 }}  {{ batchesOver.size }}
                            </div>
                          </ng-container>

                          <ng-container *ngIf="getState(batchesOver, index1) === 2">
                            <div (click)="showPreview($event, batchesOver)" class="label p-2 is-info is-rounded c-hand">
                              <i *ngIf="batchesOver.error" class="fa fa-exclamation-circle text-error m-right-2"></i>
                              {{ batchesOver['innovation']['name'] | ellipsis:15 }}  {{ batchesOver.size }}
                            </div>
                          </ng-container>

                        </div>
                      </ng-container>
                    </div>
                  </div>
                </div>
              </div>
              <!-- /index2 === 4 -->

            </ng-container>
            <!-- /index2 !== 0 -->

          </div>
        </div>
      </ng-container>
      <!-- /loading finished -->

    </div>
    <!-- /batches -->

  </div>
</div>


<!-- innovation preview sidebar-->
<app-sidebar *ngIf="weekBatches.length" [(template)]="sidebarTemplate">
  <app-sidebar-innov-card-preview
    [batchInfo]="{ batchSelected: selectedBatch, date: dateNow }"
    [innovCard]="selectedInnovCard">
  </app-sidebar-innov-card-preview>
</app-sidebar>
<!-- /innovation preview sidebar-->
