<div [hidden]="!canAccess()" class="container fluid grid-2xl p-top-30" id="admin-enterprise-bulk-edit-management">
  <div class="column col-sm-12 col-11 col-mx-auto">

    <!-- select column to edit -->
    <section class="main-form-wrapper p-top-15">

      <!-- patterns input -->
      <div class="input-column">
        <span class="text is-sm">Patterns
        <i class="fas fa-info-circle is-primary" id="syntax-hover"
           (mouseenter)="showSyntaxInfo()"
           (mouseleave)="hideSyntaxInfo()"></i>
        </span>
        <span class="tooltip-info" *ngIf="isShowSyntax">
              <span>first_name, last_name</span>
              <span>first_initial, last_initial</span>
              <span> . or -</span>
            </span>
        <app-utility-input-list
          [identifier]="'expression'"
          (update)="patternsUpdate($event)"
          [config]="patternConfig"
          [isSmall]="true"
          [isEditable]="canAccess(['edit'])">
        </app-utility-input-list>
        <ng-container
          *ngTemplateOutlet="answerArea; context: {$implicit: getContext('patterns', patterns, false)}">
        </ng-container>
      </div>
      <!-- /pattern input -->

      <!-- Enterprise url input -->
      <div class="input-column">
        <span class="text is-sm">Enterprise url</span>
        <input class="form-input is-shadowed" [disabled]="!canAccess(['edit'])" [(ngModel)]="enterpriseUrlModel" (keyup.enter)="updateUrl()">
      </div>
      <!-- /Enterprise url input -->

      <!-- Industry input -->
      <div class="input-column" *ngIf="canAccess(['edit'])">
        <span class="text is-sm">Industry</span>
        <umius-auto-suggestion
          [config]="industrySelectConfig"
          [isSmallInput]="true"
          (valueAdded)="getValueSelected($event)"
          (valueSelected)="getValueSelected($event)">
        </umius-auto-suggestion>
        <ng-container
          *ngTemplateOutlet="answerArea; context: {$implicit: getContext('industry', industries, false)}">
        </ng-container>
      </div>
      <!-- /Industry input -->

      <!-- Brand input -->
      <div class="input-column">
        <span class="text is-sm">Brand</span>
        <app-utility-input-list
          style="height: 40px"
          [identifier]="'label'"
          (update)="brandUpdate($event)"
          [isSmall]="true"
          [config]="brandConfig"
          [isEditable]="canAccess(['edit'])">
        </app-utility-input-list>
        <ng-container
          *ngTemplateOutlet="answerArea; context: {$implicit: getContext('brand', brands, false)}">
        </ng-container>
      </div>
      <!-- /Brand input -->

      <!-- Enterprise Type input -->
      <div class="input-column" *ngIf="canAccess(['edit'])">
        <span class="text is-sm">Enterprise Type
          </span>
        <umius-auto-suggestion
          [isSmallInput]="true"
          [config]="enterpriseTypeSelectConfig"
          (valueAdded)="getValueSelected($event)"
          (valueSelected)="getValueSelected($event)">
        </umius-auto-suggestion>
        <ng-container
          *ngTemplateOutlet="answerArea; context: {$implicit: getContext('enterpriseType', enterpriseTypes, true)}">
        </ng-container>
      </div>
      <!-- /Enterprise Type input -->

      <!-- Geographical Zone input -->
      <div class="input-column">
        <span class="text is-sm">Geographical Zone</span>
        <app-utility-input-list
          style="height: 40px"
          [identifier]="'name'"
          (update)="geoZoneUpdate($event)"
          [config]="geoConfig"
          [isSmall]="true"
          [isEditable]="canAccess(['edit'])">
        </app-utility-input-list>
        <ng-container
          *ngTemplateOutlet="answerArea; context: {$implicit: getContext('geoZone', geoZones, false)}">
        </ng-container>
      </div>
      <!-- /Geographical Zone input -->

      <!-- Enterprise size input -->
      <div class="input-column" *ngIf="canAccess(['edit'])">
        <span class="text is-sm">Enterprise size
        <i class="fas fa-info-circle is-primary"
           (mouseenter)="showSizeInfo()"
           (mouseleave)="hideSizeInfo()"
           id="enterprise-type-hover">
        </i>
        </span>
        <span *ngIf="isSizeInfo" class="tooltip-info">
          <span>TPE : 0-19 employés</span>
          <span>PME : 20-249 employés</span>
          <span>ETI : 250-5000 employés</span>
          <span>GE : >5000 employés</span>
        </span>
        <umius-auto-suggestion
          [isSmallInput]="true"
          [config]="enterpriseSizeSelectConfig"
          (valueAdded)="getValueSelected($event)"
          (valueSelected)="getValueSelected($event)">
        </umius-auto-suggestion>
      </div>
      <!-- /Enterprise size input -->

      <!-- Value chain input -->
      <div class="input-column" *ngIf="canAccess(['edit'])">
        <span class="text is-sm">Value chain</span>
        <umius-auto-suggestion
          [config]="valueChainSelectConfig"
          [isSmallInput]="true"
          (valueAdded)="getValueSelected($event)"
          (valueSelected)="getValueSelected($event)">
        </umius-auto-suggestion>
        <ng-container
          *ngTemplateOutlet="answerArea; context: {$implicit: getContext('valueChain', valueChains, true)}">
        </ng-container>
      </div>
      <!-- /Value chain input -->

    </section>
    <!-- /select column to edit -->

    <!-- companies selected table -->
    <section class="p-bottom-15 p-top-20">
      <umius-table
        [(config)]="config"
        (performAction)="getPerformAction($event)"
        [data]="companiesTable">
      </umius-table>
    </section>
    <!-- /companies selected table -->

    <!-- button -->
    <section class="p-bottom-30 p-top-4" style="display: flex" *ngIf="companiesToEdit.length > 0">
      <button class="button is-primary is-lg is-outlined"
              (click)="return()">
        Back
      </button>

      <button class="button is-primary is-lg is-outlined"
              *ngIf="canAccess(['edit'])"
              (click)="cancel()">
        Discard
      </button>

      <button class="button is-primary is-lg"
              *ngIf="canAccess(['edit'])"
              style="margin-left: auto"
              (click)="updateChange()">
        Update
      </button>
    </section>
    <!-- /button -->
  </div>
</div>

<ng-template #answerArea let-context>
  <ul class="answers-wrapper">
    <li *ngFor="let answer of context.answerList; let i = index">

      <!-- text -->
      <div class="answer-wrapper text-sm text-dark m-right-2">
        <span
          *ngIf="!context.isString">{{answer.text || answer.name || answer.label || answer.expression }}</span>
        <span *ngIf="context.isString">{{answer}}</span>
      </div>
      <!-- /text -->
      <!-- icons -->
      <div class="icons-wrapper">
        <!-- delete icon -->
        <div
          (click)="deleteItem(context.type, answer)"
          class="icon-container m-no-right is-overlay">
            <span [attr.data-tooltip]="'COMMON.TOOLTIP.DELETE' | translate" class="tooltip">
              <i class="icon icon-delete text-alert"></i>
            </span>
        </div>
        <!-- /delete icon -->

      </div>
      <!-- /icons -->

    </li>
  </ul>
</ng-template>
