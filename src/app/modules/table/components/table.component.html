<div id="table-component">


  <!-- Fetching result -->
  <div *ngIf="total === 0" class="spinner-wrapper">
    <app-shared-loader></app-shared-loader>
  </div>


  <!-- Fetching done -->
  <div *ngIf="total > 0" class="table-wrapper">


    <!-- Info row -->
    <div class="info-wrapper">

      <!-- Number of result and title -->
      <h1 class="main-heading">{{ total }} {{ title | translate }}</h1>

      <!-- If we want to filter by columns (not local)
      <app-shared-multi-filter
        *ngIf="isFiltrable"
        [config]="config"
        (configChange)="changeConfig($event)"
        [props]="columns">
      </app-shared-multi-filter>-->

    </div>
    <!-- /Info row -->


    <!-- Table -->
    <table>

      <thead>
        <tr>


          <!-- If there are no selected rows we show columns name in the header -->
          <ng-container *ngIf="selectedRows === 0">

            <th *ngIf="isSelectable" class="th-checkbox">
              <label>
                <input type="checkbox" (change)="selectAll($event)"/>
                <div class="square-checkbox">
                  <i class="icon icon-check"></i>
                </div>
              </label>
            </th>

            <th
              *ngFor="let column of columns"
              [ngClass]="{ 'active': isSort(column) }"
              (click)="selectColumn(getAttrs(column)[0])">

              <!-- If columns are sortable -->
              <app-shared-sort
                [config]="config"
                *ngIf="isSortable(column)"
                [ngClass]="{ 'selectable': isSortable(column) }"
                (configChange)="changeConfig($event)"
                [prop]="getAttrs(column)[0]">
                {{ getName(column) | translate | FormatText }}
              </app-shared-sort>

              <!-- Not sortable -->
              <span *ngIf="!isSortable(column)">{{ getName(column) | translate | FormatText }}</span>

            </th>

          </ng-container>
          <!-- /If there are no selected rows we show columns name in the header -->


          <!-- If there are selected rows, the several actions to perform and the button delete (if isDeletable) -->
          <ng-container *ngIf="selectedRows > 0">

            <th *ngIf="isSelectable" class="th-checkbox">
              <label>
                <input type="checkbox" (change)="selectAll($event)" [checked]="true"/>
                <div *ngIf="selectedRows === total" class="square-checkbox active">
                  <i class="icon icon-check"></i>
                </div>
                <div *ngIf="selectedRows < total" class="square-checkbox">
                  <i class="icon icon-minus"></i>
                </div>
              </label>
            </th>

            <th class="all" [attr.colspan]="isSelectable ? columns.length : columns.length -1">
            <span class="selected-text">
              {{ selectedRows }} {{ 'COMMON.TABLE.SELECTED_ROWS' | translate }}
              <i class="icon icon-arrow-right"></i>
            </span>
              <div [ngStyle]="{ display: 'inline-flex' }" *ngIf="(selectedRows < total) || (total <= content.length)">
                <button
                  *ngFor="let action of actions"
                  class="btn btn-xs ghost-edit"
                  style="margin-left: 10px;"
                  (click)="onActionClick(a)">
                  {{ action | translate }}
                </button>
                <button
                  class="btn btn-xs ghost-delete"
                  style="margin-left: 10px;"
                  (click)="removeSelectedRows()"
                  *ngIf="isDeletable">
                  {{ 'COMMON.DELETE' | translate }}
                </button>
              </div>
            </th>

          </ng-container>
          <!-- /If there are selected rows, the several actions to perform and the button delete (if isDeletable) -->

        </tr>
      </thead>


      <tbody>
        <tr *ngFor="let key of getRowsKeys()" [ngClass]="{ 'active': isLocal ? isSelected(filteredContent[key]) : isSelected(content[key]) }">

          <td *ngIf="isSelectable" class="th-checkbox">
            <label>
              <input type="checkbox" (click)="selectRow(key)" [checked]="isLocal ? isSelected(filteredContent[key]) : isSelected(content[key])"/>
              <div class="square-checkbox active">
                <i class="icon icon-check"></i>
              </div>
            </label>
          </td>

          <!-- For each columns -->
          <td *ngFor="let column of columns; let i = index">

            <span (click)="selectRow(key)" [ngClass]="{ 'text-margin': i === 0 }">
              <ng-container [ngSwitch]="getType(column)">


                <!-- If column type is Date -->
                <ng-container *ngSwitchCase="'DATE'">
                  <span>{{ (getContentValue(key, getAttrs(column)[0])?.toString() | date:dateFormat) }}</span>
                </ng-container>


                <!-- If column type is Country -->
                <ng-container *ngSwitchCase="'COUNTRY'">
                  <app-country-flag [country]="(getContentValue(key, getAttrs(column)[0]) || '')"></app-country-flag>
                </ng-container>


                <!-- If column type is Array -->
                <ng-container *ngSwitchCase="'ARRAY'">
                  <span>{{ (getContentValue(key, getAttrs(column)[0]) || []).length.toString() }}</span>
                </ng-container>


                <!-- If column type is Picture -->
                <div *ngSwitchCase="'PICTURE'">
                  <img [src]="getContentValue(key, getAttrs(column)[0]) || ''" class="img-responsive" style="width: 100px">>
                </div>


                <!-- If column type is Progress -->
                <ng-container *ngSwitchCase="'PROGRESS'">
                  <app-progress-bar
                    class="progress"
                    [width]="(getContentValue(key, getAttrs(column)[0]) || 0) +'%'"
                    [height]="10 + 'px'"
                    [backgroundColor]="getColor(getContentValue(key, getAttrs(column)[0]) || 0)">
                </app-progress-bar>
                </ng-container>


                <!-- If column type is Check -->
                <ng-container *ngSwitchCase="'CHECK'">
                  <i *ngIf="getContentValue(key, getAttrs(column)[0]) == 0" class="icon icon-cross"></i>
                  <i *ngIf="getContentValue(key, getAttrs(column)[0]) == 1" class="icon icon-check"></i>
                </ng-container>


                <!-- If column type is Multi-Choices -->
                <ng-container *ngSwitchCase="'MULTI-CHOICES'">
                  <img
                    [src]="getUrl(getChoice(column, getContentValue(key, getAttrs(column)[0]) || ''))"
                    *ngIf="getUrl(getChoice(column, getContentValue(key, getAttrs(column)[0]) || '')) !== ''"
                    class="img-responsive"
                    style="width: 100px">
                  <span
                    *ngIf="getUrl(getChoice(column, getContentValue(key, getAttrs(column)[0]) || '')) === ''"
                    [class]="getChoiceClass(getChoice(column, (getContentValue(key, getAttrs(column)[0]) || '')))">
                    {{ (getChoiceAlias(getChoice(column, getContentValue(key, getAttrs(column)[0])|| " - "))) | translate }}
                  </span>
                </ng-container>


                <!-- If column type is Multi-Label -->
                <ng-container *ngSwitchCase="'MULTI-LABEL'">
                  <span
                    *ngFor="let attr of getAttrs(column)"
                    [class]="getMultiLabelClass(getMultiLabel(column, attr)) || ''"
                    [ngClass]="{ 'left-label': getAttrIndex(column, attr) === 0 && getAttrs(column).length !== 1,
                      'right-label' : getAttrIndex(column, attr) === getAttrs(column).length-1 && getAttrs(column).length !== 1,
                      'middle-label' : getAttrIndex(column, attr) !== 0 && getAttrIndex(column, attr) !== getAttrs(column).length-1}">
                    {{ (getContentValue(key, attr) || " - ").toString() }}
                  </span>
                </ng-container>


                <!-- If column type is Multiling -->
                <ng-container *ngSwitchCase="'MULTILING'">
                  <span>{{ (getContentValue(key, getAttrs(column)[0]) | multiling:lang) | FormatText }}</span>
                </ng-container>


                <!-- If column type is Text -->
                <ng-container *ngSwitchDefault>
                  <span *ngFor="let attr of getAttrs(column)">
                    {{ (getContentValue(key, attr)|| " - ").toString() | FormatText | ellipsis:40 }}
                  </span>
                </ng-container>


              </ng-container>
            </span>

            <button
              *ngIf="i === 0"
              class="btn btn-xs ghost-edit visibleOnHover"
              (click)="isLocal ? edit(filteredContent[key]) : edit(content[key])">
              {{ isEditable ? ('COMMON.EDIT' | translate) : ('COMMON.MORE' | translate) }}
            </button>

          </td>


        </tr>
      </tbody>


    </table>


  </div>


</div>

<!--



&lt;!&ndash; If there are no results &ndash;&gt;
<div class="bot-wrapper text-center" *ngIf="total === 0">
  <span class="bot-rect">{{'COMMON.TABLE.NO-RESULTS' | translate}}</span>
  <br>
  <img src="https://res.cloudinary.com/umi/image/upload/app/default-images/bot-triangle.svg" class="bot-trian">
  <div><img src="https://res.cloudinary.com/umi/image/upload/app/default-images/juan-bot.svg" width="" height="120"></div>
</div>

&lt;!&ndash; Else we begin to create the table &ndash;&gt;
<span *ngIf="total !== 0">

  <table class="table" wt-responsive-table>

    <tbody>

      <tr *ngFor="let key of getRowsKeys()"
          [ngClass]="{'active': isLocal ? isSelected(filteredContent[key]) : isSelected(content[key])}">

        <td *ngIf="isSelectable" (click)="selectRow(key)"><input type="checkbox" [checked]="isLocal ? isSelected(filteredContent[key]) : isSelected(content[key])"/>
          <div class="square-check primary"><i class="icon icon-check"></i></div></td>

        &lt;!&ndash; Foreach columns &ndash;&gt;
        <td *ngFor="let column of columns; let i = index">
          <span (click)="selectRow(key)">
            <ng-container [ngSwitch]="getType(column)">

              &lt;!&ndash; If column type is  TEXT &ndash;&gt;
              <span *ngSwitchDefault>
                <span *ngFor="let attr of getAttrs(column)">{{(getContentValue(key, attr)|| " - ").toString() | ellipsis:50}} </span>
              </span>

              &lt;!&ndash; If column type is COUNTRY &ndash;&gt;
              <app-country-flag *ngSwitchCase="'COUNTRY'" [country]="(getContentValue(key, getAttrs(column)[0]) || '')"></app-country-flag>

              &lt;!&ndash; If column type is PICTURE &ndash;&gt;
              <div class="picture" *ngSwitchCase="'PICTURE'">
                <img [src]="getContentValue(key, getAttrs(column)[0]) || ''" class="img-fit-cover">
              </div>

              &lt;!&ndash; If column type is PROGRESS &ndash;&gt;
              <app-progress-bar class="progress"
                                *ngSwitchCase="'PROGRESS'"
                                [width]="(getContentValue(key, getAttrs(column)[0]) || 0) +'%'"
                                [backgroundColor]="getColor(getContentValue(key, getAttrs(column)[0]) || 0)">
              </app-progress-bar>

              &lt;!&ndash; If column type is CHECK &ndash;&gt;
              <div *ngSwitchCase="'CHECK'">
                <i *ngIf="getContentValue(key, getAttrs(column)[0]) == 0" class="icon icon-cross"></i>
                <i *ngIf="getContentValue(key, getAttrs(column)[0]) == 1" class="icon icon-check"></i>
              </div>

              &lt;!&ndash; If column type is LABEL &ndash;&gt;
              <span *ngSwitchCase="'MULTI-CHOICES'">

              <img [src]="getUrl(getChoice(column, getContentValue(key, getAttrs(column)[0]) || ''))"
                   *ngIf="getUrl(getChoice(column, getContentValue(key, getAttrs(column)[0]) || '')) !== ''"
                   class="img-fit-cover">

              <span *ngIf="getUrl(getChoice(column, getContentValue(key, getAttrs(column)[0]) || '')) === ''"
                    [class]="getChoiceClass(getChoice(column, (getContentValue(key, getAttrs(column)[0]) || '')))">

                {{(getChoiceAlias(getChoice(column, getContentValue(key, getAttrs(column)[0])|| " - "))) | translate }}

              </span>

            </span>

              <span *ngSwitchCase="'DATE'">
                {{(getContentValue(key, getAttrs(column)[0])?.toString() | date:dateFormat)}}
              </span>

              <span *ngSwitchCase="'ARRAY'">
                {{(getContentValue(key, getAttrs(column)[0]) || []).length.toString()}}
              </span>

              &lt;!&ndash; If column type is MULTI-LABEL &ndash;&gt;
              <span *ngSwitchCase="'MULTI-LABEL'">
                <span *ngFor="let attr of getAttrs(column)"
                    [class]="getMultiLabelClass(getMultiLabel(column, attr)) || ''"
                    [ngClass]="{
                    'left-label': getAttrIndex(column, attr) === 0 && getAttrs(column).length !== 1,
                     'right-label' : getAttrIndex(column, attr) === getAttrs(column).length-1 && getAttrs(column).length !== 1,
                     'middle-label' : getAttrIndex(column, attr) !== 0 &&
                     getAttrIndex(column, attr) !== getAttrs(column).length-1
                     }">

                  {{(getContentValue(key, attr) || " - ").toString()}}

                  </span>
              </span>

              <span *ngSwitchCase="'MULTILING'">
                {{(getContentValue(key, getAttrs(column)[0]) | multiling:lang)}}
              </span>

            </ng-container>
          </span>

          &lt;!&ndash; If isEditable we show a button onHover the row &ndash;&gt;
          <button *ngIf="i === 0" class="btn btn-xs ghost-edit visibleOnHover table-edit-button"
                  (click)="isLocal ? edit(filteredContent[key]) : edit(content[key])">
            {{isEditable ? ('COMMON.EDIT' | translate) : ('COMMON.MORE' | translate) }}
          </button>

        </td>
      </tr>
    </tbody>
  </table>

  &lt;!&ndash; Behind the table we show the pagination &ndash;&gt;
  <app-pagination *ngIf="!isNotPaginable"
                  [configValue]="paginationConfig"
                  (configChange)="changePaginationConfig($event)"
                  [total]="total"
                  [propertyName]="selector">
  </app-pagination>
</span>



<thead>
        &lt;!&ndash; If there are no selected rows we show columns name in the header&ndash;&gt;
        <ng-container *ngIf="selectedRows==0">
          <tr>
            <th *ngIf="isSelectable" width="50"><input type="checkbox" (change)="selectAll($event)"/>
              <div class="square-check"><i class="icon icon-check"></i></div>
            </th>

            <th *ngFor="let column of columns" [class]="'column-' + i"
                [ngClass]="{'active': isSort(column), 'pointable': isSortable(column)}"
                (click)="selectColumn(getAttrs(column)[0])">

              <app-shared-sort [config]="config"
                       class="activeHeader"
                       *ngIf="isSortable(column)"
                       (configChange)="changeConfig($event)"
                       [prop]="getAttrs(column)[0]">
                {{getName(column) | translate }}
              </app-shared-sort>

              <span *ngIf="!isSortable(column)">{{getName(column) | translate }}</span>
            </th>
          </tr>
        </ng-container>

        &lt;!&ndash; Else we show the number of selected rows, the several actions to perform and the button delete (if isDeletable) &ndash;&gt;
        <ng-container *ngIf="selectedRows > 0">
          <tr>
            <th *ngIf="isSelectable"><input type="checkbox" (change)="selectAll($event)" [checked]="true"/>
              <div class="square-check" *ngIf="selectedRows < total">
                <i class="icon icon-minus"></i>
              </div>
              <div class="square-check primary" *ngIf="selectedRows === total">
                <i class="icon icon-check"></i>
              </div>
            </th>
            <th class="all" [attr.colspan]="isSelectable ? columns.length : columns.length -1">
              <span>{{selectedRows}} {{'COMMON.TABLE.SELECTED_ROWS' | translate}} </span>
              <i class="icon icon-arrow-right"></i>
              <div [ngStyle]="{display: 'inline-flex'}" *ngIf="(selectedRows < total) || (total <= content.length)">
                <button *ngFor="let a of actions"
                        class="btn btn-xs ghost-edit"
                        style="margin-left: 10px;"
                        (click)="onActionClick(a)">
                  {{a | translate}}
                </button>
                <button class="btn btn-xs ghost-delete"
                        style="margin-left: 10px;"
                        (click)="removeSelectedRows()"
                        *ngIf="isDeletable">
                  {{'COMMON.DELETE' | translate }}
                </button>
              </div>
            </th>
          </tr>
        </ng-container>
    </thead>

-->
