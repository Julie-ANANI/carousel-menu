<div id="search-tool-component" class="restrict-width">
  <div class="column col-xs-12 col-11 col-mx-auto">


    <!-- section search bar -->
    <section class="section-search section-pad rm-pad-bottom">
      <app-utility-search-input-3 [searchFieldValue]="searchFieldValue" (searchFieldOutput)="onClickSearch($event)"></app-utility-search-input-3>
    </section>
    <!-- /section search bar -->


    <!-- history icon -->
    <div class="shape is-circle bg-white history-wrapper c-hand absolute tooltip is-left" [attr.data-tooltip]="'COMMON.TOOLTIP.HISTORY' | translate" (click)="onClickHistoryIcon($event)">
      <i class="fas fa-history text-notify"></i>
    </div>
    <!-- /history icon -->


    <!-- section showing video when no search -->
    <ng-container *ngIf="!searchStarted && !searchStopped">
      <section class="section-pad rm-pad-bottom" [ngClass]="{ 'animate-disappear': searchStarted }">
        <video class="video-responsive" autoplay loop>
          <source src="https://res.cloudinary.com/umi/video/upload/v1554473766/app/videos/search-tool/demo.mp4" type="video/mp4">
        </video>
      </section>
    </ng-container>
    <!-- /section showing video when no search -->


    <!-- section to show result -->
    <section [ngClass]="{ 'animate-appear': searchStarted }">

      <!-- metadata display -->
      <div class="text-center professional-count-wrapper">
        <ng-container *ngIf="professionalCount">

          <h2 class="title-secondary text-background">
            <ng-container *ngIf="professionalCount < 100">< </ng-container>
            <ng-container *ngIf="professionalCount === 20000">+ </ng-container>
            {{ professionalCount }}
          </h2>

          <h1 class="title-primary text-notify" [innerText]="'SEARCH_DEMO.PROFESSIONALS'" translate></h1>

        </ng-container>
      </div>
      <!-- /metadata display -->

      <!-- when searching for professionals -->
      <ng-container *ngIf="!searchStopped && searchStarted">
        <video class="video-responsive video-machine" autoplay loop>
          <source src="https://res.cloudinary.com/umi/video/upload/v1554473159/app/videos/search-tool/machine-search.mp4" type="video/mp4">
        </video>
      </ng-container>
      <!-- /when searching for professionals -->

      <!-- when searching for professionals done -->
      <ng-container *ngIf="searchStopped">
        <div class="flex-centered section-light-pad" [ngClass]=" { 'animate-appear': searchStopped } ">

          <!-- display map -->
          <div class="map-wrapper">
            <app-shared-worldmap
              [countriesData]="searchResult.metadata"
              [isShowableTooltip]="true"
              [maxValue]="10000"
              [minValue]="10"
              [quartiles]="scale"
              (onCountryClick)="selectCountry($event)"
              [type]="'demo'">
            </app-shared-worldmap>
          </div>

        </div>
      </ng-container>
      <!-- /when searching for professionals done -->

      <!-- displaying stat by continents -->
      <!-- NOT YET IMPLEMENTED
      <ng-container *ngIf="searchStopped">
        <div class="section-pad rm-pad-top" [ngClass]=" { 'animate-appear': searchStopped } ">
          <div class="stat">
            <div class="stat-container">
              <h3 class="stat-heading text-notify">RESULT BY CONTINENT</h3>

              <div class="stat-body">
                <h4 class="stat-sub-heading">Africa</h4>
                <span class="stat-value">{{ searchResult.metadata.africa }}</span>
              </div>

              <div class="stat-body">
                <h4 class="stat-sub-heading">Asia</h4>
                <span class="stat-value">{{ searchResult.metadata.asia }}</span>
              </div>

              <div class="stat-body">
                <h4 class="stat-sub-heading">Europe</h4>
                <span class="stat-value">{{ searchResult.metadata.europe }}</span>
              </div>

              <div class="stat-body">
                <h4 class="stat-sub-heading">North America</h4>
                <span class="stat-value">{{ searchResult.metadata.northAmerica }}</span>
              </div>

              <div class="stat-body">
                <h4 class="stat-sub-heading">Oceania</h4>
                <span class="stat-value">{{ searchResult.metadata.oceania }}</span>
              </div>

              <div class="stat-body">
                <h4 class="stat-sub-heading">South America</h4>
                <span class="stat-value">{{ searchResult.metadata.southAmerica }}</span>
              </div>

            </div>
          </div>
        </div>
      </ng-container> -->
      <!-- /displaying stat by continents -->


      <!-- showing the professionals -->
      <ng-container *ngIf="searchStopped && slicedPros">


        <!-- if filter not activated -->
        <h3 *ngIf="!selectedCountry" class="title-pro text-background" [innerText]="'SEARCH_DEMO.SOME_PROS'" translate></h3>


        <!-- if filter activated -->
        <ng-container *ngIf="selectedCountry">
          <div class="flex-start" [ngStyle]="{ 'margin-bottom': '1rem' }">

            <div class="text-background text-md">
              <span>{{ slicedPros.length }} {{ 'SEARCH_DEMO.RESULTS_FOR' | translate }}</span>
            </div>

            <div class="filter-wrapper c-hand text-md" (click)="resetCountry()">
              <span class="text-background text-medium">{{ names[selectedCountry] }} <i class="fas text-notify fa-times-circle"></i></span>
            </div>

          </div>
        </ng-container>
        <!-- /if filter activated -->


        <!-- if no professionals found on filter activated -->
        <ng-container *ngIf="slicedPros.length === 0">
          <div class="section-pad flex-centered no-result-wrapper">
            <img src="https://res.cloudinary.com/umi/image/upload/v1541075335/app/default-images/icons/no_result.png" class="img-responsive" alt=" ">
            <h3 class="text-normal" [innerText]="'SEARCH_DEMO.NO_RESULT_HEADING'" translate></h3>
            <span class="text-notify text-medium" [innerText]="'SEARCH_DEMO.NO_RESULT_TEXT'" translate></span>
          </div>
        </ng-container>
        <!-- /if no professionals found on filter activated -->


        <ng-container *ngIf="slicedPros.length > 0">
          <div class="card-wrapper d-flex">
            <div *ngFor="let professional of slicedPros" class="card is-responsive text-center">

              <ng-container *ngIf="professional?.isLoading">
                <div class="card-body is-cover">
                  <i class="fa fa-cog fa-2x text-warning fa-spin"></i>
                </div>
              </ng-container>

              <ng-container *ngIf="!professional?.isLoading">

                <ng-container *ngIf="professional && professional.country">
                  <div class="card-header animate-card-appear">
                    <app-utility-country-flag [country]="professional.country" [width]="23" [height]="16"></app-utility-country-flag>
                  </div>
                </ng-container>

                <div class="card-body is-cover animate-card-appear">

                  <!-- name -->
                  <ng-container *ngIf="professional && (professional.firstName || professional.lastName)">
                    <p class="text-medium">

                      <ng-container *ngIf="professional.profileUrl">
                        <a [href]="professional.profileUrl" class="text-link" target="_blank">
                          <ng-container *ngIf="professional.firstName">{{ professional.firstName }} </ng-container>
                          <ng-container *ngIf="professional.lastName">{{ professional.lastName }}</ng-container>
                        </a>
                      </ng-container>

                      <ng-container *ngIf="!professional.profileUrl">
                        <ng-container *ngIf="professional.firstName">{{ professional.firstName }} </ng-container>
                        <ng-container *ngIf="professional.lastName">{{ professional.lastName }}</ng-container>
                      </ng-container>

                    </p>
                  </ng-container>
                  <!-- /name -->

                  <!-- email -->
                  <ng-container *ngIf="professional && professional.email">
                    <p class="relative tooltip" data-tooltip="E-mail">
                      <span class="text-email">{{ professional.email }}</span>
                      <span class="absolute email-icon text-background"><i class="fas fa-envelope"></i></span>
                    </p>
                  </ng-container>

                  <!-- job -->
                  <ng-container *ngIf="professional && (professional.job || professional.jobTitle)">
                    <p class="text-job text-background">
                      {{ professional.job || professional.jobTitle }}
                    </p>
                  </ng-container>

                </div>

                <!-- logo -->
                <ng-container *ngIf="professional && professional.company">

                  <!--<ng-container *ngIf="professional.companyLogoUrl">
                    <div class="card-footer animate-card-appear tooltip flex-centered" [attr.data-tooltip]="professional.company">
                      <a [href]="getCompanyUrl(professional.companyDomain)" target="_blank">
                        <img
                          [src]="professional.companyLogoUrl"
                          class="img-responsive" [alt]= "professional.company"
                          (error)="professional.companyLogoUrl = null">
                      </a>
                    </div>
                  </ng-container>-->

                  <ng-container > <!-- *ngIf="!professional.companyLogoUrl"-->
                    <div class="card-footer animate-card-appear flex-centered text-center no-logo">

                      <ng-container *ngIf="professional.companyDomain">
                        <a [href]="getCompanyUrl(professional.companyDomain)" class="text-link text-ellipsis text-normal" target="_blank">
                          {{ professional.company }}
                        </a>
                      </ng-container>

                      <ng-container *ngIf="!professional.companyDomain">
                        <span class="text-ellipsis">{{ professional.company }}</span>
                      </ng-container>

                    </div>
                  </ng-container>

                </ng-container>
                <!-- /logo -->

              </ng-container>

            </div>
          </div>
        </ng-container>


      </ng-container>
      <!-- /showing the professionals -->


      <!-- button to show more pros -->
      <ng-container *ngIf="searchStopped && slicedPros.length !== searchResult.pros.length && !selectedCountry">
        <div class="text-center section-pad rm-pad-top">
          <button class="btn btn-primary rounded shadow " (click)="onClickSeeMore()" [innerText]="'COMMON.BUTTON.SEE_MORE'" translate></button>
        </div>
      </ng-container>
      <!-- /button to show more pros -->


    </section>
    <!-- /section to show result -->


  </div>
</div>


<!-- sidebar for history -->
<app-sidebar [(template)]="sidebarValue">
  <app-sidebar-search-tool
    [sidebarState]="sidebarValue.animate_state"
    [searchFieldValue]="searchFieldOutput"
    (onSaveRequest)="saveRequest()"
    (onDownload)="downloadRequest()"
    (onUpload)="uploadRequest($event)"
    (onLoadRequest)="loadRequest($event)">
  </app-sidebar-search-tool>
</app-sidebar>
<!-- /sidebar for history -->
