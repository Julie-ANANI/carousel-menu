<main class="container fluid" id="login">
  <section class="columns col-gapless">

    <!-- section image -->
    <div class="column col-md-6 col-xl-7 col-8 col-mx-auto">
      <div [ngStyle]="{ 'background-image': 'url(' + backgroundImage + ')' }" class="cover-image"></div>
    </div>
    <!-- /section image -->

    <!-- section login -->
    <div class="column col-sm-12 col-md-6 col-xl-5 col-4 col-mx-auto section-login section-light-pad flex-centered">

      <!-- logo -->
      <div class="logo-wrapper">
        <a href="{{ getCompanyUrl() }}">
          <img
            [src]="getLogoWBG()"
            height="57.58"
            width="110"
            alt=" "
            class="img-responsive">
        </a>
      </div>

      <!-- form -->
      <div class="form section-light-pad flex-centered">

        <!-- heading -->
        <h1 [innerText]="'LOG_IN.HEADING'" class="title-primary text-background" translate></h1>

        <!-- details -->
        <div class="credentials-wrapper">
          <form (submit)="onClickLogin()" [formGroup]="formData">

            <div class="form-group has-error">
              <label class="form-label" for="login-email">{{ 'COMMON.LABEL.EMAIL' | translate }}</label>
              <input
                type="email"
                id="login-email"
                class="form-input"
                formControlName="email"
                placeholder="john@catco.com">
              <span *ngIf="formData.get('email').touched">
                <span *ngIf="formData.get('email').hasError('required')" class="form-input-hint">
                  {{ 'COMMON.REQUIRED.EMAIL' | translate }}
                </span>
                <span
                  *ngIf="formData.get('email').hasError('email') && formData.get('email').value !== ''"
                  class="form-input-hint">
                  {{ 'COMMON.INVALID.EMAIL' | translate }}
                </span>
              </span>
            </div>

            <div class="form-group has-error">
              <label class="form-label" for="login-password">{{ 'COMMON.LABEL.PASSWORD' | translate }}</label>
              <input
                class="form-input"
                id="login-password"
                type="password"
                formControlName="password"
                [attr.placeholder]="'COMMON.PASSWORD_PLACEHOLDER' | translate ">
              <span
                *ngIf="formData.get('password').hasError('required') && formData.get('password').touched"
                class="form-input-hint">
                {{ 'COMMON.REQUIRED.PASSWORD' | translate }}
              </span>
            </div>

            <!-- tentatives + contact UMI -->
            <p *ngIf="nbTentatives<3" class="text text-sm m-top-10 m-bottom-10 is-info" style="display: flex">
              {{nbTentatives + ' ' + ('COMMON.LABEL.TENTATIVE_LEFT' | translate)}}
              <span class="text-link" style="margin-left: auto"
                    (click)="showContactUMIModal()"
                    *ngIf="nbTentatives ===0">Contact UMI support</span>
            </p>
            <!-- /tentatives + contact UMI-->

            <!-- login button and forget password -->
            <div class="submit-wrapper text-center">
              <div class="login-button">
                <button
                  id="login-submit"
                  class="button is-primary gtm-signin-email"
                  type="submit"
                  [disabled]="formData.invalid">
                  <span *ngIf="displayLoading" class="loading is-white"></span>
                  {{ 'LOG_IN.LOG_IN_BTN' | translate }}
                </button>
              </div>
              <p>
                {{ 'LOG_IN.FORGOT_PASSWORD.A' | translate }}
                <span class="text-link gtm-change-password" routerLink="forgetpassword">
                  {{ 'LOG_IN.FORGOT_PASSWORD.B' | translate }}
                </span>
              </p>
            </div>

          </form>
        </div>

        <!-- linkedIn -->
        <ng-container *ngIf="checkIsMainDomain()">
          <div class="linkedIn-wrapper text-center">

            <div class="or-wrapper">
              <span class="or-divider"> {{ 'COMMON.OR' | translate }} </span>
            </div>

            <button class="btn btn-secondary gtm-signin-linkedin" (click)="onClickLinkedIn()">
              <span *ngIf="displayLoadingLinkedIn" class="loading is-white"></span>
              <span *ngIf="!displayLoadingLinkedIn"><i class="fab fa-1x fa-linkedin-in"></i></span>
              {{ 'LOG_IN.LOG_IN_LINKEDIN' | translate }}
            </button>

          </div>
        </ng-container>

      </div>

      <!-- sign up -->
      <div class="text-center">
        <span [ngStyle]="{ 'font-size': '0.7rem', 'padding-right': '0.4rem' }">
          {{ 'LOG_IN.DOES_NOT_HAVE_ACCOUNT' | translate }}
        </span>
        <button type="button" class="btn btn-sm ghost-primary" routerLink="/register">
          {{ 'LOG_IN.SIGN_UP' | translate }}
        </button>
      </div>

    </div>
    <!-- /section login -->

  </section>
</main>

<app-utility-modal [title]="'Contact UMI support'" [(showModal)]="isShowModal" [maxWidth]="'550px'">
  <section class="modal-body p-top-15 p-bottom-15 p-left-25 p-right-25">
    <!-- info -->
    <div class="text text-center">
      <p class="title m-top-10">We are here to help</p>
      <p class="text text-sm">Having trouble logging into the platform?
        Let us know what happened and we'll do our best to help!</p>
    </div>
    <!-- /info -->

    <!-- send message form -->
    <div class="form section-light-pad flex-centered">
      <div class="w-full p-30">
        <form [formGroup]="helpMessageForm" (ngSubmit)="sendMessageToUMISupport()">
          <!-- message form -->
          <div class="form-group">
            <textarea id="textarea"
                      class="form-input"
                      formControlName="message"
                      placeholder="Write your message here" rows="3">
            </textarea>
          </div>
          <!-- /message form -->

          <!-- email form -->
          <div class="form-group has-error m-top-4">
            <label class="form-label" for="contact-email">{{ 'COMMON.LABEL.EMAIL' | translate }}</label>
            <input
              type="email"
              id="contact-email"
              class="form-input"
              formControlName="contactEmail"
              placeholder="john@catco.com">
            <span *ngIf="helpMessageForm.get('contactEmail').touched">
                <span *ngIf="helpMessageForm.get('contactEmail').hasError('required')" class="form-input-hint">
                  {{ 'COMMON.REQUIRED.EMAIL' | translate }}
                </span>
                <span
                  *ngIf="helpMessageForm.get('contactEmail').hasError('contactEmail') && helpMessageForm.get('contactEmail').value !== ''"
                  class="form-input-hint">
                  {{ 'COMMON.INVALID.EMAIL' | translate }}
                </span>
              </span>
          </div>
          <!-- /email form -->

          <!-- send+cancel buttons -->
          <div class="d-flex m-top-10 m-bottom-4">
            <div class="btn-cancel" style="margin-right: auto">
              <button
                (click)="cancelMessage()"
                class="button is-outlined is-md">
                Cancel
              </button>
            </div>

            <div class="login-button" style="margin-left: auto">
              <button
                id="message-submit"
                class="button is-primary is-md"
                type="submit"
                [disabled]="helpMessageForm.invalid">
                Send
              </button>
            </div>
          </div>
          <!-- /send+cancel buttons -->
        </form>
      </div>
    </div>
    <!-- /send message form -->
  </section>
</app-utility-modal>
