<div id="shared-search-pros" class="w-full">

  <!-- search wrapper -->
  <div *ngIf="canAccess(['launch', 'cat'])" class="search-wrapper">

    <!-- heading -->
    <div class="heading-wrapper">


      <h2 class="title-secondary">Rocket Testing</h2>

      <span class="text-link text-sm" (click)="onReset()">Reset</span>

      <span class="line">|</span>

      <div class="popover is-bottom">
        <span class="text-help">Help</span>
        <div class="popover-container">
          <div class="card">
            <div class="card-body">
              <div class="d-flex align-center">
                <div class="shape is-circle is-xs bg-success"></div>
                <span>Relevant</span>
              </div>
              <div class="d-flex align-center">
                <div class="shape is-circle is-xs bg-progress"></div>
                <span>Average</span>
              </div>
              <div class="d-flex align-center">
                <div class="shape is-circle is-xs bg-alert"></div>
                <span>Overused</span>
              </div>
              <div class="d-flex align-center">
                <div class="icons icons-delete"><i class="fas fa-exclamation-triangle"></i></div>
                <span>Too much pros duplicated</span>
              </div>
              <hr class="hr m-top-10 m-bottom-10">
              <ul>
                <li>No capital letters or "s".</li>
                <li>Numbers can't be processed.</li>
                <li>Please enter at least 2 requests.</li>
              </ul>
            </div>
          </div>
        </div>
      </div>

    </div>
    <!-- /heading -->

    <!-- request -->
    <div class="">

    </div>
    <!-- /request -->

    <!-- input -->
    <div class="input-wrapper">

      <div class="form-group">
        <label>
            <textarea
              [(ngModel)]="params['catKeywords']"
              class="form-input"
              name="cat-keywords"
              placeholder="Search here using Computer Aided Targeting. One request per line."
              rows="5"
              type="text">
            </textarea>
        </label>
        <span
          (click)="onClickSearchCat($event)"
          *ngIf="params['catKeywords']"
          [attr.data-tooltip]="'Search'"
          class="search-button-wrapper tooltip">
              <i class="fas fa-search"></i>
            </span>
      </div>

      <div class="remaining-wrapper">
        <div class="d-flex align-center">
          <span [ngClass]="getCatCircleClass()" class="shape is-circle is-xs"></span>
          <span>Search Requests</span>
        </div>
        <div>Remaining for today: {{ catQuota }}</div>
      </div>

    </div>
    <!-- /input -->

    <!-- loader -->
    <div *ngIf="displayLoader" class="loader-wrapper">
      <div class="loading is-lg"></div>
    </div>
    <!-- /loader -->

    <!-- display cat result -->
    <div *ngIf="catProcessDone && !displayLoader">

      <!-- analysis -->
      <div class="analysis-wrapper">

        <div class="heading-wrapper">
          <h2 class="title-secondary">Analysis</h2>
          <div
            *ngIf="catResult && catResult['duplicate_status'] && catResult['duplicate_status'] !== 'ok'"
            class="icon is-delete">
            <i class="fas fa-exclamation-triangle"></i>
          </div>
        </div>

        <div class="analysis-content">
          <ul>
            <li *ngFor="let suggestion of suggestions">
              <div class="d-flex"><span class="text-pros">
                  {{ suggestion.expected_result }} pros</span>
                <div [innerHTML]="suggestion.search_keywords"></div>
              </div>
              <div
                (click)="onClickPlus(suggestion.keywords)"
                [ngStyle]="{ 'visibility':  checkKeywords(suggestion.keywords) }">
                <i class="fas fa-plus-circle"></i>
              </div>
            </li>
          </ul>
        </div>

      </div>
      <!-- /analysis -->

      <!-- suggested -->
      <div class="suggested-wrapper">

        <div class="heading-wrapper">
          <h2 class="title-secondary">Suggested Keywords</h2>
        </div>

        <div class="suggested-content">
          <ul>
            <li *ngFor="let keyword of catResult['new_keywords']">
              {{ keyword }}
            </li>
          </ul>
        </div>

      </div>
      <!-- /suggested -->

      <!-- star profiles -->
      <div class="profile-wrapper">

        <div class="heading-wrapper">
          <h2 class="title-secondary">4 Star Profiles</h2>
        </div>

        <div class="profile-content">
          <ul>
            <li *ngFor="let profile of catResult.profile | keyvalue">
              <div class="popover">
                <a [href]="profile.key" target="_blank">
                  <span class="text-title">{{ profile.value.title }}</span>
                </a>
                <div class="popover-container">
                  <div class="card">
                    <div class="card-body">
                        <span *ngIf="profile.value && profile.value['snippet']">
                          {{ profile.value['snippet'] }}
                        </span>
                    </div>
                  </div>
                </div>
              </div>
            </li>
          </ul>
        </div>

      </div>
      <!-- /star profiles -->

    </div>
    <!-- /display cat result -->

  </div>
  <!-- /search wrapper -->

  <!-- search wrapper -->
  <div *ngIf="canAccess(['launch', 'search'])" class="search-wrapper">

    <!-- requests -->
    <div class="w-full d-flex align-center">
      <span class="text-pre text-15 text-bold">Requests</span>
      <div class="line m-left-4"></div>
    </div>
    <!-- /requests -->

    <!-- input -->
    <div class="input-wrapper w-half">

      <div class="form-group">
        <label>
            <textarea
              (ngModelChange)="estimateNumberOfGoogleRequests()"
              [(ngModel)]="params['keywords']"
              class="form-input"
              name="keywords"
              placeholder="Search here like 'Google'. One request per line."
              rows="5"
              type="text">
            </textarea>
        </label>
        <span
          (click)="onClickSearch($event)"
          *ngIf="params['keywords']"
          [attr.data-tooltip]="'Search'"
          class="search-button-wrapper tooltip">
              <i class="fas fa-search"></i>
            </span>
      </div>

      <div class="remaining-wrapper">
        <a
          *ngIf="canAccess(['import', 'pros'])"
          (click)="showModal = true"
          class="text-link">
          Import a list of pros
        </a>
        <div class="d-flex align-center">
          <span [ngClass]="getCircleClass()" class="shape is-circle is-xs"></span>
          <span>Remaining requests: {{ googleQuota }}</span>
        </div>
      </div>

      <div class="form-group m-top-10"
           (click)="onClickSearch($event)">
        <button class="button is-primary is-md" [disabled]="!params['keywords']">Launch</button>
      </div>

    </div>
    <!-- /input -->

    <!-- settings -->
    <div class="w-full d-flex align-center" *ngIf="canAccess(['view', 'settings']) || canAccess(['edit', 'settings'])">
      <span class="text-pre text-15 text-bold">Settings</span>
      <div class="line m-left-4"></div>
    </div>
    <!-- /settings -->

    <div class="settings w-full">
      <app-shared-search-settings
        (paramsChange)="updateSettings($event)"
        [isEditable]="canAccess(['edit', 'settings'])"
        [params]="params">
      </app-shared-search-settings>
    </div>

    <!-- geographic targeting -->
    <div class="w-full d-flex align-center" *ngIf="canAccess(['view', 'settings']) || canAccess(['edit', 'settings'])">
      <span class="text-pre text-15 text-bold">Geographic targeting</span>
      <div class="line m-left-4"></div>
    </div>
    <!-- /geographic targeting  -->

    <div class="geographic-targeting w-full">
      <!-- targeting -->
      <div class="p-30">
        <app-shared-targeting-world
          [(geography)]="geography"
          [isShowSearch]="true"
          [isEditable]="canAccess(['edit', 'settings'])">
        </app-shared-targeting-world>
      </div>
      <!-- /targeting -->
    </div>

    <!-- professional targeting -->
    <div class="w-full d-flex align-center">
      <span class="text-pre text-15 text-bold">Professional targeting</span>
      <div class="line m-left-4"></div>
    </div>

    <div class="w-full">
      <app-shared-professional-targeting
        [campaign]="campaign">
      </app-shared-professional-targeting>

    </div>
    <!-- /professional targeting  -->

  </div>
  <!-- /search wrapper -->

</div>


<!-- sidebar to advanced search -->
<app-sidebar
  *ngIf="canAccess(['view', 'settings']) || canAccess(['edit', 'settings'])"
  [(template)]="sidebarValue">
  <app-sidebar-search
    (geographyChange)="onGeographyChange($event)"
    (paramsChange)="updateSettings($event)"
    [geography]="geography"
    [isEditable]="canAccess(['edit', 'settings'])"
    [params]="params">
  </app-sidebar-search>
</app-sidebar>
<!-- /sidebar to advanced search -->


<!-- MODAL : import a professionals list -->
<app-utility-modal
  *ngIf="canAccess(['import', 'pros'])"
  [(showModal)]="showModal"
  [title]="'Import Board'">

  <section class="modal-body">

    <div class="form-group m-bottom-30">
      <label class="form-label" for="shared-search-modal-name">
        Name to be given to the request
      </label>
      <input
        [(ngModel)]="importRequestKeywords"
        class="form-input"
        id="shared-search-modal-name"
        placeholder="Give a name to the import file"
        type="text">
    </div>

    <!-- import button -->
    <div class="text-center p-bottom-30">
      <label class="button is-primary is-sm is-outlined">
        <input #fileupload (change)="onClickImport(fileupload.files[0])" [hidden]="true" type="file">
        <i class="fas fa-file-import icon-left"></i> Import pros
      </label>
    </div>
    <!-- /import button -->

    <p class="text-center text-sm">The file must use these <b>exact names</b> for the columns:
      <b>First Name UMI, Last Name UMI, Company UMI, Country UMI</b>
      , Language, Email UMI, emailConfidence, Linkedin,
      Company Site, Job UMI</p>

    <p class="text-center text-sm">Bold columns are mandatory, other columns are optional. The order of the columns
      does
      not matter</p>

  </section>

  <footer class="modal-footer">
    <button class="button modal-cancel">Cancel</button>
  </footer>

</app-utility-modal>

<!--<div class="columns">
  <div class="column col-5 col-ml-auto">

  <div class="column col-2 col-mr-auto" [ngSwitch]="catResult.duplicate_status">
    <div class="bot-wrapper text-center" *ngSwitchCase="'ok'">
      <span class="bot-rect">
        <span *ngIf="estimatedNumberOfGoogleRequests">
          {{ 'SEARCH.ROBOT.SEARCH_USE' | translate }}
          <strong> <span *ngIf="catResult.total_result">{{ 'SEARCH.ROBOT.APPROX' | translate }}</span> {{estimatedNumberOfGoogleRequests}} {{ 'SEARCH.REQUESTS' | translate }} <span
            *ngIf="catResult.total_result">max</span></strong>.
        <a *ngIf="!catResult.keywords_analysis && campaign" (click)="cat($event)">{{ 'SEARCH.ROBOT.MORE_INFO' | translate }}</a>
        </span>
        <span *ngIf="!estimatedNumberOfGoogleRequests">{{ 'SEARCH.ROBOT.HELLO' | translate }}</span>
      </span>
      <br>
      <img src="https://res.cloudinary.com/umi/image/upload/app/default-images/bot-triangle.svg" class="bot-trian">
      <div><img src="https://res.cloudinary.com/umi/image/upload/app/default-images/bot-advice.svg" width=""
                height="120">
      </div>
    </div>

    <div class="bot-wrapper text-center" *ngSwitchCase="'not ok'">
      <span class="bot-rect">{{ 'SEARCH.ROBOT.NOT_OK' | translate }}<br/>
        <span *ngIf="estimatedNumberOfGoogleRequests">{{ 'SEARCH.ROBOT.SEARCH_USE' | translate }} <strong>{{ 'SEARCH.ROBOT.APPROX' | translate }} {{estimatedNumberOfGoogleRequests}} {{ 'SEARCH.REQUESTS' | translate }}</strong>.</span>
      </span>
      <br>
      <img src="https://res.cloudinary.com/umi/image/upload/app/default-images/bot-triangle.svg" class="bot-trian">
      <div><img src="https://res.cloudinary.com/umi/image/upload/app/default-images/bot-1.svg" width="" height="120">
      </div>
    </div>

    <div class="bot-wrapper text-center" *ngSwitchCase="'error'">
      <span class="bot-rect"> {{ 'SEARCH.ROBOT.ERROR' | translate }}</span>
      <br>
      <img src="https://res.cloudinary.com/umi/image/upload/app/default-images/bot-triangle.svg" class="bot-trian">
      <div><img src="https://res.cloudinary.com/umi/image/upload/app/default-images/error-bot.svg" width=""
                height="120">
      </div>
    </div>
  </div>
</div>-->
