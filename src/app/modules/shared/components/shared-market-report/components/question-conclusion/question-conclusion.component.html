<div class="content-body" id="question-conclusion">

  <!-- conclusion -->
  <div class="conclusion-wrapper">

    <h3 *ngIf="question.title" [ngClass]="{'m-no-bottom': !question.label}" class="title is-main">
      {{ question.title | multiling:currentLang }}
    </h3>

    <h4 *ngIf="question.label" [ngStyle]="{'color': '#484848'}" class="m-no-bottom text-lg">
      {{ question.label | multiling:currentLang }}
    </h4>

    <div *ngIf="tags && tags.length > 0" class="tags-wrapper">
      <div *ngFor="let tag of tags" [title]="tag.description | multiling:currentLang" class="label is-tag is-rounded">
        <i class="fas fa-tag icon-left"></i> {{ tag.label | multiling:currentLang }}
        <ng-container *ngIf="tag.count > 1">(x{{ tag.count }})</ng-container>
      </div>
    </div>

    <h5 *ngIf="isMainDomain" class="op-text">{{ 'COMMON.UMI_WORD' | translate }}</h5>

    <app-shared-editors
      (textChange)="keyupHandlerFunction($event)"
      [text]="innovation.marketReport[question.identifier]?.conclusion || ''"
      [innovationId]="innovation._id"
      [elementId]="question.identifier"
      [isEditable]="!readonly"
      [type]="'synthesis'">
    </app-shared-editors>

    <div *ngIf="originAnswers !== null" class="p-top-20">
      <h4 class="title is-5 m-bottom-15">Geographical Distribution:</h4>
      <div class="m-no-bottom">
        <div *ngFor="let continent of originAnswers | keyvalue | orderBy:'value'"
             [id]="continent.key"
             class="m-top-1 continent-wrapper collapsed">
          <div class="flex d-inline-flex text-bold continent">
            <!-- icon to toggle countries display -->
            <span class="text-center" (click)="displayCountries(continent.key)">
              {{ ('CONTINENTS.' + continent.key) | translate }}: {{ continent.value.count }}
              <i class="icon text-secondary m-left-10 icon-arrow-down "></i>
              <i class="icon text-secondary m-left-10 icon-arrow-up "></i>
            </span>
            <!-- /button to toggle countries display -->
          </div>

          <ul class="m-no-bottom countries">
            <li *ngFor="let country of continent.value.countries | keyvalue | orderBy:'value'" class="m-top-1">
              {{ country.key }}: {{ country.value }}
            </li>
          </ul>
        </div>
      </div>
    </div>

  </div>
  <!-- /conclusion -->

  <!-- stats -->
  <div [ngSwitch]="question.controlType" class="stats-wrapper">

    <!-- pie chart -->
    <ng-container *ngSwitchCase="'radio'">
      <app-utility-piechart
        [pieChart]="pieChart"
        [showFavorable]="question.visibility">
      </app-utility-piechart>
    </ng-container>
    <!-- /pie chart -->

    <!-- rectangle box -->
    <ng-container *ngSwitchDefault>
      <app-bluesquare
        [numberFocus]="stats.nbAnswers"
        [percentage]="stats.percentage"
        [subtitle]="question.subtitle | multiling:currentLang">
      </app-bluesquare>
    </ng-container>
    <!-- /rectangle box -->

  </div>
  <!-- /stats -->

</div>
