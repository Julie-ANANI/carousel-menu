<div id="bar-chart">

  <!-- header section -->
  <div class="box-style">
    <app-question-conclusion
      [reportingLang]="reportingLang"
      (questionChanged)="questionChange()"
      [innovation]="innovation"
      [pieChart]="pieChart"
      [question]="question"
      [readonly]="readonly"
      [stats]="stats">
    </app-question-conclusion>
  </div>
  <!-- /header section -->

  <!-- content section -->
  <div>

    <!-- button to toggle answers display -->
    <div *ngIf="barsData.length > 0" class="p-top-25 text-center">
      <button
        (click)="toggleAnswer($event)"
        class="button is-sm"
        type="button">
        {{ (toggleAnswers ? 'MARKET_REPORT.BTN_ANSWERS_CLOSE' : 'MARKET_REPORT.BTN_ANSWERS_OPEN') | translateIn: reportingLang }}
        <i class="icon icon-right" aria-hidden="true" [ngClass]="toggleAnswers ? 'icon-arrow-up' : 'icon-arrow-down'"></i>
      </button>
    </div>
    <!-- /button to toggle answers display -->

    <!-- show answers -->
    <div [ngClass]=" toggleAnswers ? 'is-expand' : 'is-collapse' " class="answers-wrapper">
      <ng-container *ngIf="toggleAnswers">
        <div *ngFor="let barData of barsData; let i = index;" [attr.data-index]="i">
          <div *ngIf="filter ? filter.value[barData.identifier] : true" class="p-top-25">

            <!-- row 1 -->
            <div class="flex-between text-medium">

              <div>
                <div
                  (click)="filterAnswer(barData, $event); toggleFilterIcon[i] = false"
                  (mouseenter)="toggleFilterIcon[i] = true;"
                  (mouseleave)="toggleFilterIcon[i] = false;"
                  style="width:20px; height: 20px"
                  class="c-hand icon-container">
                  <span [attr.data-tooltip]="'MARKET_REPORT.TOOLTIP_HIDE_ANSWER' | translateIn: reportingLang" class="tooltip">
                    <i
                      [ngClass]="toggleFilterIcon[i] ? 'fa-eye-slash text-alert' : 'fa-eye text-info'"
                      class="fas">
                    </i>
                  </span>
                </div>
                <span class="text-lg m-left-3 m-right-2 text-draft">
                  {{ barDataLabel(barData) }}
                </span>
              </div>

              <div
                (click)="onShowAnswers(i, (barData.answers && barData.answers.length))"
                [ngClass]="{'c-hand': barData.answers && barData.answers.length}"
                class="d-flex text-meta text-medium align-center text-md">
                <span class="m-right-2">{{ barData.count }} {{ 'MARKET_REPORT.ANSWERS' | translateIn: reportingLang }}</span>
                <i [ngClass]="showAnswers[i] ? 'icon-arrow-up' : 'icon-arrow-down'" aria-hidden="true" class="icon"></i>
              </div>

            </div>
            <!-- /row 1 -->

            <!-- row 2 -->
            <div
              (click)="onShowAnswers(i, (barData.answers && barData.answers.length))"
              [ngClass]="{'c-hand': barData.answers && barData.answers.length}"
              style="height: 12px"
              class="bar m-top-10">
              <div
                class="bar-item tooltip"
                [attr.data-tooltip]="barData.absolutePercentage"
                [ngStyle]="{ 'width': barData.absolutePercentage , 'background': barData.color }">
              </div>
            </div>
            <!-- /row 2 -->

            <!-- row 3 -->
            <div *ngIf="showAnswers[i]" class="d-flex card-wrapper p-top-25 justify-space">
              <div *ngFor="let answer of barData.answers" class="card">
                <div class="card-body">
                  <app-market-comment
                    (modalAnswerChange)="seeAnswer($event)"
                    [answer]="answer"
                    [questionId]="question.identifier+'Comment'">
                  </app-market-comment>
                </div>
              </div>
            </div>
            <!-- /row 3 -->

          </div>
        </div>
      </ng-container>
    </div>
    <!-- /show answers -->

  </div>
  <!-- /content section -->

</div>
