<section id="bar-chart-component">

  <!-- header section -->
  <div class="bg-white">
    <app-question-conclusion
      [innovation]="innovation"
      [pieChart]="pieChart"
      [question]="question"
      [readonly]="readonly"
      [stats]="stats">
    </app-question-conclusion>
  </div>
  <!-- /header section -->

  <!-- content section -->
  <div>

    <!-- button to toggle answers display -->
    <div class="section-light-pad rm-pad-bottom text-center">
      <button type="button" class="btn btn-primary" (click)="toggleAnswer($event)">
        {{ (toggleAnswers ? 'MARKET_REPORT.BTN_ANSWERS_CLOSE' : 'MARKET_REPORT.BTN_ANSWERS_OPEN') | translate }}
        <i class="fas icon-size" aria-hidden="true" [ngClass]="toggleAnswers ? 'fa-angle-down' : 'fa-angle-right'"></i>
      </button>
    </div>

    <div [ngClass]=" toggleAnswers ? 'expand-wrapper' : 'collapse-wrapper' " class="content-wrapper">
      <div *ngIf="toggleAnswers">
        <div *ngFor="let barData of barsData; let i = index;" [attr.data-index]="i">
          <div *ngIf="filter ? filter.value[barData.identifier] : true" class="section-light-pad">

            <!-- row 1 -->
            <div class="flex-between text-medium">

              <div>
                <div
                  (click)="filterAnswer(barData, $event); toggleFilterIcon[i] = false"
                  (mouseenter)="toggleFilterIcon[i] = true;"
                  (mouseleave)="toggleFilterIcon[i] = false;"
                  style="width: 20px; height: 20px"
                  class="c-hand icon-container">
                  <span class="tooltip" [attr.data-tooltip]="'MARKET_REPORT.TOOLTIP_HIDE_ANSWER' | translate">
                    <i class="fas icon-size" [ngClass]="toggleFilterIcon[i] ? 'fa-eye-slash text-alert' : 'fa-eye text-info'"></i>
                  </span>
                </div>
                <span class="bar-name text-background">{{ barData.label | multiling:lang }}</span>
              </div>

              <div class="d-flex text-notify text-medium response-wrapper c-hand" (click)="showAnswers[i] = !showAnswers[i]">
                <span class="bar-count">{{ barData.count }} {{ 'MARKET_REPORT.ANSWERS' | translate }}</span>
                <span class="icon-size"><i class="fas" aria-hidden="true" [ngClass]="showAnswers[i] ? 'fa-angle-down' : 'fa-angle-right'"></i></span>
              </div>

            </div>
            <!-- /row 1 -->

            <!-- row 2 -->
            <div class="bar c-hand" (click)="showAnswers[i] = !showAnswers[i]">
              <div class="bar-item tooltip" [attr.data-tooltip]="barData.absolutePercentage" [ngStyle]="{ 'width': barData.absolutePercentage , 'background': barData.color }"></div>
            </div>
            <!-- /row 2 -->

            <!-- row 3 -->
            <div *ngIf="showAnswers[i]" class="d-flex card-wrapper section-light-pad rm-pad-bottom">
              <div *ngFor="let answer of barData.answers" class="card">
                <div class="card-body">
                  <app-market-comment
                    [answer]="answer"
                    [questionId]="question.identifier+'Comment'"
                    (modalAnswerChange)="seeAnswer($event)">
                  </app-market-comment>
                </div>
              </div>
            </div>
            <!-- /row 3 -->

          </div>
        </div>
      </div>
    </div>

  </div>
  <!-- /content section -->


</section>
