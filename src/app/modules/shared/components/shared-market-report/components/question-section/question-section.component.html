<section class="question-section-wrapper s-question-print" [id]=domSectionId>

  <div *ngFor="let tag of tags" class="tags-wrapper"
       (click)="addTagFilter($event, tag)">
      #{{ tag.label | multiling:lang }}
      <span *ngIf="tag.count > 1">&nbsp;(x{{tag.count}})</span>
  </div>

  <!-- If the question type is checkbox or radio -->
  <ng-container *ngIf="question.controlType === 'checkbox' || question.controlType === 'radio'">
    <app-bar-chart
      [answers]="answersToShow"
      [innovation]="innovation"
      [question]="question"
      [readonly]="readonly"
      [stats]="stats"
      [showDetails]="showDetails"
      (modalAnswerChange)="seeAnswer($event)"
      (answerButtonClicked)="answerBtnClicked($event)">
    </app-bar-chart>
  </ng-container>

  <!-- If the question type is not checkbox and radio -->
  <ng-container *ngIf="question.controlType !== 'checkbox' && question.controlType !== 'radio'">
    <div class="header">
      <div class="section-inline-container">
        <app-question-conclusion
          [innovation]="innovation"
          [question]="question"
          [readonly]="readonly"
          [stats]="stats">
        </app-question-conclusion>
      </div>
    </div>
  </ng-container>

  <!-- If the question type is list or clearbit -->
  <ng-container *ngIf="question.controlType === 'list' || question.controlType === 'clearbit'">

    <!-- Answer button -->
    <div class="answer-button-wrapper">
      <button
        type="button"
        class="btn ghost-primary"
        (click)="showDetails = !showDetails; $event.preventDefault()">
        {{ (showDetails ? 'MARKET_REPORT.BTN_ANSWERS_CLOSE' : 'MARKET_REPORT.BTN_ANSWERS_OPEN') | translate }}
        <i class="icon" aria-hidden="true" [ngClass]="showDetails ? 'icon-arrow-down' : 'icon-arrow-right'"></i>
      </button>
    </div>

    <!-- Now showing the answers, this contains both the answers to show and comments  -->
    <ng-container *ngIf="showDetails">
      <div class="clear-list-wrapper">

        <div *ngIf="answersWithComment.length > 0" class="clc-wrapper">
          <div *ngFor="let answer of answersWithComment" class="clco-wrapper">
            <app-market-comment-2
              [answer]="answer"
              [questionId]="question.identifier+'Comment'"
              (modalAnswerChange)="seeAnswer($event)">
            </app-market-comment-2>
          </div>
        </div>

        <div class="cli-wrapper">
          <app-item-list
            [answers]="answersToShow"
            [innovation]="innovation"
            [question]="question"
            [readonly]="readonly"
            [stats]="stats"
            (updateNumberOfItems)="updateNumberOfItems($event)"
            (modalAnswerChange)="seeAnswer($event)">
          </app-item-list>
        </div>

      </div>
    </ng-container>

  </ng-container>

  <!-- Showing answers if the question type is not clearbit, radio, checkbox and list -->
  <ng-container *ngIf="question.controlType !== 'checkbox' && question.controlType !== 'radio'
  && question.controlType !== 'list' && question.controlType !== 'clearbit'">

    <!-- Answer button -->
    <div class="answer-button-wrapper">
      <button
        type="button"
        class="btn ghost-primary"
        (click)="showDetails = !showDetails; $event.preventDefault()">
        {{ (showDetails ? 'MARKET_REPORT.BTN_ANSWERS_CLOSE' : 'MARKET_REPORT.BTN_ANSWERS_OPEN') | translate }}
        <i class="icon" aria-hidden="true" [ngClass]="showDetails ? 'icon-arrow-down' : 'icon-arrow-right'"></i>
      </button>
    </div>

    <!-- Now showing the answers that we have for the textarea, scale, toggle and star type -->
    <ng-container *ngIf="showDetails">

      <!-- Star -->
      <div *ngIf="question.controlType === 'stars'" class="star-answer-wrapper">
        <app-stars [answers]="answersToShow" [innovation]="innovation" [question]="question"></app-stars>
      </div>

      <!-- Rating -->
      <div *ngIf="question.controlType === 'scale'" class="rating-answer-wrapper">
        <app-scale [answers]="answersToShow" [question]="question"></app-scale>
      </div>

      <!-- Textarea or textbox-->
      <div *ngIf="question.controlType === 'textarea' || question.controlType === 'textbox'" class="textarea-answer-wrapper">
        <div *ngFor="let answer of answersToShow" class="textarea-answer-outer-wrapper">
          <app-market-comment-2
            [answer]="answer"
            [questionId]="question.identifier"
            (modalAnswerChange)="seeAnswer($event)"
            [ngStyle]="{ 'width': '100%' }">
          </app-market-comment-2>
        </div>
      </div>

      <!-- Toggle -->
      <div *ngIf="question.controlType === 'toggle'" class="toggle-answer-wrapper">
        <div class="prof-list-wrapper">
          <div *ngFor="let answer of answersToShow" class="profile-wrapper">
            <app-pro-tag
              [answer]="answer"
              (modalAnswerChange)="seeAnswer($event)"
              [ngStyle]="{ 'width': '100%', 'height': '100%' }">
            </app-pro-tag>
          </div>
        </div>
      </div>

    </ng-container>

  </ng-container>

  <!-- Comments that are not related to answers like general comments but not for list and clearbit question type -->
  <ng-container *ngIf="showComment && question.controlType !== 'list' && question.controlType !== 'clearbit'
  && answersWithComment.length > 0">

    <div class="comment-button-wrapper">
      <h5>{{ answersWithComment.length }} {{ 'MARKET_REPORT.BTN_COMMENTS_OPEN' | translate }}</h5>
    </div>

    <!-- Showing the comments when click on comment button -->
    <div class="comment-wrapper">
      <div *ngFor="let answer of answersWithComment" class="comment-outer-wrapper">
        <app-market-comment-2
          [answer]="answer"
          [questionId]="question.identifier+'Comment'"
          (modalAnswerChange)="seeAnswer($event)">
        </app-market-comment-2>
      </div>
    </div>

  </ng-container>

</section>
