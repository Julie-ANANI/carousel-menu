<div class="question-section" [id]="questionReceived.identifier">

  <!-- if the question type is checkbox or radio -->
  <div *ngIf="questionReceived.controlType === 'checkbox' || questionReceived.controlType === 'radio'">
    <app-bar-chart
      [reportingLang]="reportingLang"
      (questionChanged)="questionChanged.emit($event)"
      (answerButtonClicked)="answerBtnClicked($event)"
      (modalAnswerChange)="seeAnswer($event)"
      [innovation]="innovation"
      [question]="questionReceived"
      [readonly]="readonly"
      [stats]="stats"
      [toggleAnswers]="toggleAnswers">
    </app-bar-chart>
  </div>
  <!-- /if the question type is checkbox or radio -->

  <!-- if the question type is not checkbox and radio -->
  <div
    *ngIf="questionReceived.controlType !== 'checkbox' && questionReceived.controlType !== 'radio'"
    class="box-style">
    <app-question-conclusion
      [reportingLang]="reportingLang"
      (questionChanged)="questionChanged.emit($event)"
      [innovation]="innovation"
      [question]="questionReceived"
      [readonly]="readonly"
      [originAnswers]="originAnswers"
      [stats]="stats">
    </app-question-conclusion>
  </div>
  <!-- /if the question type is not checkbox and radio -->

  <!-- if the question type is list or clearbit -->
  <div *ngIf="questionReceived.controlType === 'list' || questionReceived.controlType === 'clearbit'">

    <!-- answer toggle button -->
    <div *ngIf="!hideAnswers" class="p-top-25 text-center">
      <button
        (click)="toggleAnswers = !toggleAnswers"
        class="button is-community is-sm"
        type="button">
        {{ (toggleAnswers ? 'MARKET_REPORT.BTN_ANSWERS_CLOSE' : 'MARKET_REPORT.BTN_ANSWERS_OPEN') | translateIn: reportingLang }}
        <i class="icon" aria-hidden="true" [ngClass]="toggleAnswers ? 'icon-arrow-down' : 'icon-arrow-up'"></i>
      </button>
    </div>
    <!-- /answer toggle button -->

    <!-- now showing the answers, this contains both the answers to show and comments  -->
    <div [ngClass]="toggleAnswers ? 'is-expand' : 'is-collapse'" class="answers-wrapper">
      <ng-container *ngIf="toggleAnswers">
        <div class="d-flex justify-between clearbit-list-wrapper flex-wrap">

          <div *ngIf="answersWithComment.length > 0" class="flex-full m-right-20 p-top-25 card-wrapper">
            <div *ngFor="let answer of answersWithComment" class="card">
              <div class="card-body p-15">
                <app-market-comment-2
                  [reportingLang]="reportingLang"
                  [answer]="answer"
                  [canEditQuestionTags]="canEditQuestionTags"
                  [question]="questionReceived"
                  (modalAnswerChange)="seeAnswer($event)">
                </app-market-comment-2>
              </div>
            </div>
          </div>

          <div class="p-top-25 flex-full">
            <app-item-list
              (modalAnswerChange)="seeAnswer($event)"
              (updateNumberOfItems)="updateNumberOfItems($event)"
              [innovation]="innovation"
              [question]="questionReceived"
              [readonly]="readonly"
              [stats]="stats">
            </app-item-list>
          </div>

        </div>
      </ng-container>
    </div>

  </div>
  <!-- /if the question type is list or clearbit -->

  <!-- showing answers if the question type is not clearbit, radio, checkbox and list -->
  <div *ngIf="questionReceived.controlType !== 'checkbox' && questionReceived.controlType !== 'radio'
  && questionReceived.controlType !== 'list' && questionReceived.controlType !== 'clearbit'">

    <!-- answer toggle button -->
    <div *ngIf="!hideAnswers" class="p-top-25 text-center">
      <button
        (click)="toggleAnswers = !toggleAnswers"
        class="button is-community is-sm"
        type="button">
        {{ (toggleAnswers ? 'MARKET_REPORT.BTN_ANSWERS_CLOSE' : 'MARKET_REPORT.BTN_ANSWERS_OPEN') | translateIn: reportingLang }}
        <i class="icon" aria-hidden="true" [ngClass]="toggleAnswers ? 'icon-arrow-down' : 'icon-arrow-up'"></i>
      </button>
    </div>
    <!-- answer toggle button -->

    <!-- now showing the answers that we have for the textarea, scale, toggle and star type -->
    <div [ngClass]="toggleAnswers ? 'is-expand' : 'is-collapse'" class="answers-wrapper">
      <ng-container *ngIf="toggleAnswers">
        <ng-container [ngSwitch]="questionReceived.controlType">

          <!-- star -->
          <div *ngSwitchCase="'stars'">
            <app-stars [question]="questionReceived" [reportingLang]="reportingLang"></app-stars>
          </div>
          <!-- star -->

          <!-- rating -->
          <div *ngSwitchCase="'scale'">
            <app-scale [question]="questionReceived"></app-scale>
          </div>
          <!-- rating -->

          <!-- textarea -->
          <div *ngSwitchCase="'textarea'" class="textarea-wrapper p-top-25">
            <div class="card-wrapper">
              <div *ngFor="let answer of answersToShow | async" class="card">
                <div class="card-body p-15">
                  <app-market-comment-2
                    [reportingLang]="reportingLang"
                    (modalAnswerChange)="seeAnswer($event)"
                    [answer]="answer"
                    [canEditQuestionTags]="canEditQuestionTags"
                    [question]="questionReceived">
                  </app-market-comment-2>
                </div>
              </div>
            </div>
          </div>
          <!-- textarea -->

          <!-- toggle ---->
          <div *ngSwitchCase="'toggle'" class="toggle-wrapper p-top-25">
            <div class="card-wrapper">
              <div *ngFor="let answer of answersToShow | async" class="card is-responsive">
                <div class="card-body">
                  <app-pro-tag
                    (modalAnswerChange)="seeAnswer($event)"
                    [answer]="answer">
                  </app-pro-tag>
                </div>
              </div>
            </div>
          </div>
          <!-- /toggle ---->

        </ng-container>
      </ng-container>
    </div>

  </div>
  <!-- /showing answers if the question type is not clearbit, radio, checkbox and list -->

  <!-- comments that are not related to answers like general comments but not for list and clearbit question type -->
  <div *ngIf="showComment && questionReceived.controlType !== 'list' && questionReceived.controlType !== 'clearbit'
  && answersWithComment.length > 0" class="animate-fade is-5 comment-wrapper p-bottom-20">

    <div class="p-top-50">
      <h5 [ngStyle]="{'font-size': '22px'}" class="title text-secondary">
        {{ answersWithComment.length }} {{ 'MARKET_REPORT.BTN_COMMENTS_OPEN' | translateIn: reportingLang }}
      </h5>
    </div>

    <!-- showing the comments ---->
    <div class="card-wrapper">
      <div *ngFor="let answer of answersWithComment" class="card flex-full m-bottom-20">
        <div class="card-body p-15">
          <app-market-comment-2
            [reportingLang]="reportingLang"
            (modalAnswerChange)="seeAnswer($event)"
            [answer]="answer"
            [canEditQuestionTags]="canEditQuestionTags"
            [question]="questionReceived"></app-market-comment-2>
        </div>
      </div>
    </div>
    <!-- /showing the comments ---->

  </div>
  <!-- /comments that are not related to answers like general comments but not for list and clearbit question type -->

</div>
