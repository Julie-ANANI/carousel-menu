<section id="app-market-report-sidebar">

  <!-- filter icon for small devices -->
  <div class="filter-icon-wrapper text-background">
    <span class="text-medium">Filters</span>
    <i class="fas fa-angle-down"></i>
  </div>
  <!-- /filter icon for small devices -->

  <!-- filter options -->
  <div class="filter-option-wrapper">

    <!-- end innovation -->
    <div *ngIf="isAdmin" class="text-center">
      <button class="btn btn-sm ghost-primary" (click)="showEndInnovationModal = true">End Project</button>
      <div class="divider"></div>
    </div>
    <!-- /end innovation -->

    <!-- export option -->
    <div *ngIf="isOwner" class="text-center">
      <button class="btn btn-primary gtm-export-synthesis" (click)="showExportModal = true" [textContent]="'MARKET_REPORT.BUTTON_EXPORT'" translate></button>
      <div class="divider"></div>
    </div>
    <!-- /export option -->

    <!-- views wrapper -->
    <div class="client-view-wrapper">

      <h6>{{ 'MARKET_REPORT.VIEWS' | translate }}</h6>

      <div *ngFor="let filter of sharedFiltersList" class="different-views">
        <i class="fas fa-trash-alt text-alert c-hand tooltip tooltip-right" [attr.data-tooltip]="'MARKET_REPORT.TOOLTIP_DELETE_VIEW' | translate"
           aria-hidden="true" (click)="deleteCustomFilter(filter.name)">
        </i>
        <a class="c-hand text-background tooltip" [attr.data-tooltip]="'MARKET_REPORT.TOOLTIP_LOAD_VIEW' | translate" (click)="loadFilter(filter.name)" [innerHtml]="filter.name"></a>
      </div>

      <form #shareFilterForm="ngForm" (ngSubmit)="shareNewFilter($event)">

        <div class="form-group">
          <label>
            <input
              #name="ngModel"
              [(ngModel)]="filterName"
              [ngModelOptions]="{ standalone: true }"
              [placeholder]="'MARKET_REPORT.VIEW_PLACEHOLDER' | translate"
              class="form-input"
              type="text">
          </label>
        </div>

        <div class="text-center">
          <button class="btn btn-sm ghost-primary" type="submit" [disabled]="!filterName" [textContent]="'MARKET_REPORT.BUTTON_SAVE_VIEW'" translate></button>
        </div>

      </form>

      <div class="divider"></div>

    </div>
    <!-- /views wrapper -->

    <!-- reset filters -->
    <div *ngIf="filtersCount > 0" class="filter-reset-wrapper">
      <span class="text-link" (click)="resetFilters($event)">
        <i class="fas fa-times"></i>
        <span [innerText]="'MARKET_REPORT.RESET_FILTERS'" translate></span>
      </span>
    </div>
    <!-- /reset filters -->

    <!-- activated custom filters
    <div class="filter-custom-wrapper">
      <div>
        <span class="text-medium" [innerText]="'MARKET_REPORT.CUSTOM_FILTERS'" translate></span>
      </div>
    </div>
     /activated custom filters -->

    <span *ngFor="let filter of activatedCustomFilters" (click)="unloadFilter($event, filter)">
        <i class="fas fa-times" aria-hidden="true"></i>
      {{ filter }}
      </span>

    <!-- map filters -->
    <div class="filter-rest-wrapper">

      <a href="#origin" pageScroll class="text-primary">
        <div class="flex-between">
          <span [innerText]="'MARKET_REPORT.MAP.TITLE'" translate></span>
          <i class="fas fa-angle-right text-notify" aria-hidden="true"></i>
        </div>
      </a>

      <div *ngFor="let continent of continentsList" class="form-group">
        <label class="form-checkbox">
          <input
            type="checkbox"
            [name]="continent"
            (change)="checkCountry($event)"
            [checked]="filteredContinents ? filteredContinents[continent] : true">
          <i class="form-icon"></i><span>{{ ('CONTINENTS.' + continent) | translate }}</span>
        </label>
      </div>

    </div>
    <!-- /map filters -->

    <!-- professional filters -->
    <div class="filter-rest-wrapper filter-professional">

      <a href="#professional" pageScroll class="text-primary">
        <div class="flex-between">
          <span [innerText]="'MARKET_REPORT.PROFESSIONAL.TITLE'" translate></span>
          <i class="fas fa-angle-right text-notify" aria-hidden="true"></i>
        </div>
      </a>

      <div *ngFor="let tag of tagsList | slice:0:tagsEndIndex" class="form-group">
        <label class="form-checkbox">
          <input
            type="checkbox"
            [name]="tag.label | multiling:userLang"
            (change)="checkTag($event)"
            [checked]="selectedTags[tag._id]">
          <i class="form-icon"></i><span>{{ tag.label | multiling:userLang | FormatText }}</span>
        </label>
      </div>

      <!-- see more -->
      <div *ngIf="tagsList && tagsList.length > 6 && tagsList.length !== tagsEndIndex">
        <span class="text-link" [innerText]="'MARKET_REPORT.SEE_MORE'" translate (click)="tagsEndIndex = tagsList.length"></span>
      </div>

      <!-- see less -->
      <div *ngIf="tagsList && tagsList.length === tagsEndIndex && tagsEndIndex !== 6">
        <span class="text-link" [innerText]="'MARKET_REPORT.SEE_LESS'" translate (click)="tagsEndIndex = 6"></span>
      </div>

      <div *ngIf="filters['professionals']" class="professional-hide-wrapper">
        <div *ngFor="let professional of filters['professionals'].value | keyvalue" (click)="deleteProfessionalFilter($event, professional.key)"
             class="tooltip c-hand" [attr.data-tooltip]="'MARKET_REPORT.TOOLTIP_UNHIDE_PROFESSIONAL' | translate">
          <i class="fas fa-eye-slash text-alert" aria-hidden="true"></i>
          <span>{{ professional.value.professional?.firstName }} {{ professional.value.professional?.lastName }}</span>
        </div>
      </div>

    </div>
    <!-- /professional filters -->

    <!-- questions filters -->
    <div *ngFor="let question of questions" class="filter-rest-wrapper filter-question">

    </div>
    <!-- /questions filters -->

    <!-- conclusion filters -->
    <div class="filter-rest-wrapper">
      <a href="#conclusion" pageScroll class="text-primary">
        <div class="flex-between">
          <span [innerText]="'MARKET_REPORT.CONCLUSION'" translate></span>
          <i class="fas fa-angle-right text-notify" aria-hidden="true"></i>
        </div>
      </a>
    </div>
    <!-- /conclusion filters -->


  </div>
  <!-- /filter options -->

</section>


<!--<div id="app-market-report-sidebar">

  <div class="menu-wrapper">
    <p *ngIf="activatedCustomFilters.length > 0">
      <span>
        {{ 'MARKET_REPORT.CUSTOM_FILTERS' | translate }}
      </span>
      <span *ngFor="let filter of activatedCustomFilters" (click)="unloadFilter($event, filter)">
        <i class="fas fa-times" aria-hidden="true"></i>
        {{ filter }}
      </span>
    </p>
    <p *ngFor="let question of questions">
      <a [href]="'#' + question.identifier | removespaces" pageScroll>
        {{ question.title | multiling:lang }}
        <i class="fas fa-angle-right" aria-hidden="true"></i>
      </a>
      &lt;!&ndash; Textarea filters &ndash;&gt;
      <ng-container *ngIf="question.controlType === 'textarea'">
        <span *ngFor="let t of answersTagsLists[question.identifier]">
          <input type="checkbox" [name]="t._id" (change)="checkAnswerTag($event, question.identifier)"
                 [checked]="selectedAnswersTags[question.identifier][t._id]">
          <label [for]="t._id">{{ t.label | multiling:lang }}</label>
        </span>
      </ng-container>
      &lt;!&ndash; checkbox/radio filters &ndash;&gt;
      <ng-container *ngIf="question.controlType === 'checkbox' || question.controlType === 'radio'">
        <span *ngFor="let o of question.options">
          <input type="checkbox" [name]="o.identifier" (change)="checkOption($event, question)"
                 [checked]="filters[question.identifier] ? filters[question.identifier].value[o.identifier] : true">
          <label [for]="o.identifier">{{ o.label | multiling:lang }}</label>
        </span>
      </ng-container>
    </p>
  </div>
</div>-->

<app-market-report-export-modal
  *ngIf="isOwner"
  [innovation]="innovation"
  [(showModal)]="showExportModal">
</app-market-report-export-modal>

<!-- Modal to ask operator to sure about ending the project -->
<app-modal [modalTitle]="'MARKET_REPORT.MODAL.END_INNOVATION_TITLE'"  [(showModal)]="showEndInnovationModal">
  <div class="content">
    {{ 'MARKET_REPORT.MODAL.END_INNOVATION_CONTENT' | translate }}
  </div>
  <div class="modal-footer">
    <button
      class="btn btn-primary btn-sm"
      (click)="endInnovation($event)">
      {{ 'MARKET_REPORT.MODAL.BUTTON_CONFIRM' | translate }}
    </button>
  </div>
</app-modal>
<!-- /Modal to ask operator to sure about ending the project -->
