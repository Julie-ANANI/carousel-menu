<div *ngIf="innovation" id="market-report">


  <!-- project status not done at client side -->
  <section *ngIf="innovation?.status !== 'DONE' && !adminSide && !previewMode" [ngStyle]="{ 'background-color': '#FFFFFF' }">
    <div class="section-light-pad rm-pad-bottom">
      <div class="column col-xs-12 col-11 col-mx-auto">
        <h1 class="title-primary">{{ 'MARKET_REPORT.TITLE'  | translate }}</h1>
        <div class="section-light-pad rm-pad-bottom">
          <app-message-space [widthMax]="'337px'">
            <span>{{ getMessage() | translate }}</span>
          </app-message-space>
        </div>
      </div>
    </div>
  </section>
  <!-- /project status not done at client side -->


  <!-- project status not submitted admin side -->
  <section *ngIf="innovation.status === 'EDITING' && adminSide">
    <div class="section-pad rm-pad-bottom">
      <div class="column col-xs-12 col-11 col-mx-auto">
        <app-message-space [widthMax]="'337px'">
          <span>{{ 'MARKET_REPORT.MESSAGE_ADMIN.NOT_SUBMITTED' | translate }}</span>
        </app-message-space>
      </div>
    </div>
  </section>
  <!-- /project status not submitted admin side -->


  <!-- project status done or preview mode or not editing -->
  <div *ngIf="innovation.status === 'DONE' || previewMode || (innovation.status !== 'EDITING' && adminSide)" [ngStyle]="{ 'background-color': '#F5F5F5', 'margin-bottom': adminSide ? '0' : '-2.5rem' }">
    <div class="restrict-width">
      <div class="columns col-gapless">

        <!-- filter sidebar -->
        <aside class="column col-2 filter-wrapper">
          <app-market-report-sidebar
            [answers]="answers"
            [innovation]="innovation"
            [isAdmin]="adminMode"
            [isAdminSide]="adminSide"
            [isOwner]="isOwner"
            [questions]="questions">
          </app-market-report-sidebar>
        </aside>
        <!-- /filter sideBar -->


        <!-- answers section -->
        <section id="answer-wrapper" class="column col-8">

          <!-- main page -->
          <section id="main-page" [ngStyle]="{ 'display': sharable ? 'block' : 'block' }" class="section-pad text">
            <app-main-page [project]="innovation" class="full-width"></app-main-page>
          </section>
          <!-- /main page -->

          <!-- main page goal -->
          <section *ngIf="adminSide" class="section-light-pad" id="innovation-goal">
            <div class="section-pad bg-white full">

              <h2 class="title-primary">Objective</h2>

              <div class="form-group relative">

                <label for="market-report-objective"></label>
                <textarea
                  (blur)="update($event)"
                  [(ngModel)]="innovation.executiveReport.objective"
                  placeholder="Describe the objective of this innovation within 120 words."
                  class="form-input"
                  id="market-report-objective"
                  maxlength="120"
                  rows="5">
                </textarea>

                <div class="char-remaining" [ngStyle]="{ 'color': getColor((innovation.executiveReport?.objective.length | characterCountdown:120), 120) }">
                  <span>{{ innovation.executiveReport?.objective.length | characterCountdown:120 }}</span>
                </div>

              </div>

            </div>
          </section>
          <!-- /main page goal -->

          <!-- executive report generation -->
          <section *ngIf="adminSide" class="section-pad" id="executive-generate">
            <div class="section-pad full d-flex executive-generate-wrapper bg-white">

              <h2 class="title-primary">Executive Report</h2>

              <div class="template-outer-wrapper d-flex">
                <div *ngFor="let template of executiveTemplates" class="card card-responsive">

                  <img [src]="template.imageSrc" alt=" ">

                  <div class="card-header text-center">
                    <div class="btn btn-radio" [ngClass]="{ 'active': numberOfSections === template.value }" (click)="assignSectionValue($event, template.value)">
                      <span>•</span>
                    </div>
                  </div>

                </div>
              </div>

              <div class="text-center" [ngStyle]="{ 'margin-top': '0.5rem' }">
                <button class="btn ghost-primary btn-sm" [disabled]="numberOfSections === 0" (click)="generateExecutiveTemplate($event)">
                  Valid template
                </button>
              </div>

            </div>
          </section>
          <!-- /executive report generation -->

          <!-- executive report -->
          <section *ngIf="innovation.executiveReport.totalSections > 0" id="executive-report">
            <app-executive-report [project]="innovation"></app-executive-report>
          </section>
          <!-- /executive report -->

          <!-- umi intro -->
          <section *ngIf="domainName === 'umi'" class="section-pad" id="umi-intro" [ngStyle]="{ 'display': sharable ? 'block' : 'block' }">
            <img [src]="introSrc" alt="UMI" class="img-responsive umi-intro img-fit-cover">
          </section>
          <!-- /umi intro -->

          <!-- innovation detail -->
          <section [ngStyle]="{ 'display': sharable ? 'block' : 'block' }" class="section-pad text">
            <app-innovation-detail [project]="innovation" class="full-width"></app-innovation-detail>
          </section>
          <!-- /innovation detail -->

          <!-- targeting detail -->
          <section [ngStyle]="{ 'display': sharable ? 'block' : 'block' }" class="section-pad text">
            <app-targeting-detail [project]="innovation" [continent]="continentTarget" class="full-width"></app-targeting-detail>
          </section>
          <!-- /targeting detail -->

          <!-- key learning section -->
          <section *ngIf="innovation.marketReport?.keyLearning?.conclusion.length > 0 || adminSide" class="section-pad" id="key-learning">
            <div class="section-pad full key-learning-wrapper bg-white text">

              <h2 class="title-primary" [innerText]="'MARKET_REPORT.KEY_LEARNING'" translate></h2>

              <h6 *ngIf="mainDomain" class="op-text" [innerText]="'COMMON.UMI_WORD'" translate></h6>

              <app-text-zone
                [elementId]="'keyLearning'"
                [readonly]="!adminSide"
                [data]="innovation.marketReport?.keyLearning?.conclusion"
                (onTextChange)="saveOperatorComment($event, 'keyLearning')">
              </app-text-zone>

            </div>
          </section>
          <!-- /key learning section -->

          <!-- origin comment and professional responses -->
          <section class="section-pad" id="origin">
            <div class="origin-wrapper bg-white text">
              <app-question-conclusion
                [innovation]="innovation"
                [question]="{ identifier: 'professionals', subtitle: { en: 'professionals', fr: 'professionnels' }, title: { en: 'Origin of responses', fr: 'Origine des réponses' } }"
                [readonly]="!adminSide"
                [originAnswers]="answersOrigins"
                [stats]="{ nbAnswers: answers.length, percentage: 0 }">
              </app-question-conclusion>
            </div>
          </section>
          <!-- /origin comment and professional responses -->

          <!-- professional abstract -->
          <section *ngIf="adminSide" class="abstract-wrapper section-pad">
            <div class="section-pad full bg-white text">

              <h2 class="title-primary">Professional Abstract</h2>

              <div class="form-group relative">
                <label for="market-report-professionals"></label>
                <textarea
                  (blur)="update($event)"
                  [(ngModel)]="innovation.executiveReport.professionalAbstract"
                  placeholder="Describe the professional abstract of this innovation within 160 words."
                  class="form-input"
                  id="market-report-professionals"
                  maxlength="160"
                  rows="5">
              </textarea>
                <div class="char-remaining" [ngStyle]="{ 'color': getColor((innovation.executiveReport?.professionalAbstract.length | characterCountdown:160), 160) }">
                  <span>{{ innovation.executiveReport?.professionalAbstract.length | characterCountdown:160 }}</span>
                </div>
              </div>

            </div>
          </section>
          <!-- /professional abstract -->

          <!-- map -->
          <section class="section-light-pad" id="map">
            <div class="map-wrapper">
              <app-worldmap
                (updateContinent)="filterByContinents($event)"
                [countries]="countries"
                [countriesColor]="'#2ECC71'"
                [initialConfiguration]="mapSelectedContinents"
                [synthesis]="true"
                [width]="'auto'">
              </app-worldmap>
            </div>
          </section>
          <!-- /map -->

          <!-- conclusion -->
          <section *ngIf="innovation.marketReport?.finalConclusion?.conclusion.length > 0 || adminSide" class="section-pad" id="conclusion">
            <div class="section-pad full bg-white text conclusion-wrapper">

              <h2 class="title-primary" [innerText]="'MARKET_REPORT.CONCLUSION'" translate></h2>

              <h6 *ngIf="mainDomain" class="op-text" [innerText]="'COMMON.UMI_WORD'" translate></h6>

              <app-text-zone
                [elementId]="'finalConclusion'"
                [readonly]="!adminSide"
                [data]="innovation.marketReport?.finalConclusion?.conclusion"
                (onTextChange)="saveOperatorComment($event, 'finalConclusion')">
              </app-text-zone>

            </div>
          </section>
          <!-- /conclusion -->

        </section>


      </div>
    </div>
  </div>
  <!-- /project status done or preview mode or not editing -->


</div>

<!--  <section  [ngStyle]="{ 'background-color': adminSide ? '#F5F5F5' : (innovation?.status !== 'DONE' && !previewMode) ? 'white' : '#F5F5F5', 'margin-bottom': adminSide ? '0' : '-2.5rem' }">-->

<!--    &lt;!&ndash; project status submitted &ndash;&gt;-->
<!--    <ng-container *ngIf="innovation?.status === 'DONE' || (innovation?.status !== 'EDITING' && adminSide) || previewMode">-->

<!--      <div class="d-flex market-report-wrapper">-->



<!--        &lt;!&ndash; Answer sections &ndash;&gt;-->
<!--        <section id="answer-wrapper">-->







<!--          &lt;!&ndash; professionals &ndash;&gt;-->
<!--          <section class="section-light-pad" id="professional">-->
<!--            <div class="column col-xs-12 col-11 col-mx-auto">-->
<!--              <div class="professional-wrapper d-flex">-->
<!--                <div *ngFor="let answer of filteredAnswers" class="card card-responsive-3 relative">-->

<!--                  <img src="https://res.cloudinary.com/umi/image/upload/v1539175831/app/default-images/icons/filter.png" height="13px" width="20px" (click)="filterPro(answer, $event)" alt=" ">-->

<!--                  <div class="card-body">-->
<!--                    <app-pro-tag [answer]="answer" (modalAnswerChange)="seeAnswer($event)"></app-pro-tag>-->
<!--                  </div>-->

<!--                </div>-->
<!--              </div>-->
<!--            </div>-->
<!--          </section>-->
<!--          &lt;!&ndash; /professionals &ndash;&gt;-->

<!--          &lt;!&ndash; other question and answers &ndash;&gt;-->
<!--          <div class="column col-xs-12 col-11 col-mx-auto" id="questions">-->
<!--            <div *ngFor="let question of questions">-->
<!--              <div class="section-light-pad">-->
<!--                <app-question-section-->
<!--                  [project]="innovation"-->
<!--                  [question]="question"-->
<!--                  [answers]="filteredAnswers"-->
<!--                  [showDetails]="showDetails"-->
<!--                  [readonly]="!adminSide"-->
<!--                  (modalAnswerChange)="seeAnswer($event)">-->
<!--                </app-question-section>-->
<!--              </div>-->
<!--            </div>-->
<!--          </div>-->
<!--          &lt;!&ndash; /other question and answers &ndash;&gt;-->



<!--        </section>-->
<!--        &lt;!&ndash; /Answer sections &ndash;&gt;-->

<!--      </div>-->

<!--    </ng-container>-->
<!--    &lt;!&ndash; /Project status submitted and client side &ndash;&gt;-->

<!--  </section>-->

<!--  &lt;!&ndash; insight preview &ndash;&gt;-->
<!--  <ng-container *ngIf="!wordpress">-->
<!--    <app-sidebar [(template)]="sidebarTemplateValue">-->
<!--      <app-user-answer-->
<!--        [(userAnswer)]="modalAnswer"-->
<!--        [projectId]="innovation._id"-->
<!--        [adminMode]="adminMode"-->
<!--        [questions]="questions">-->
<!--      </app-user-answer>-->
<!--    </app-sidebar>-->
<!--  </ng-container>-->
<!--  &lt;!&ndash; /insight preview &ndash;&gt;-->

<!--</ng-container>-->

