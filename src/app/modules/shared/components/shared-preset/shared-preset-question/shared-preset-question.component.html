<div class="question">

  <!-- Question header -->
  <div class="question-header">
    <div class="move-element">
      <i class="fa fa-caret-up" (click)="up($event)"></i>
      <i class="fa fa-caret-down" (click)="down($event)"></i>
    </div>

    <select *ngIf="editMode && !isTaggedQuestion" class="form-select" [(ngModel)]="question.controlType">
      <option value="radio">{{ "PRESETS.QUESTION.TYPE.radio" | translate }}</option>
      <option value="checkbox">{{ "PRESETS.QUESTION.TYPE.checkbox" | translate }}</option>
      <option value="textarea">{{ "PRESETS.QUESTION.TYPE.textarea" | translate }}</option>
      <option value="list">{{ "PRESETS.QUESTION.TYPE.list" | translate }}</option>
      <option value="clearbit">{{ "PRESETS.QUESTION.TYPE.clearbit" | translate }}</option>
      <option value="scale">{{ "PRESETS.QUESTION.TYPE.scale" | translate }}</option>
      <option value="stars">{{ "PRESETS.QUESTION.TYPE.stars" | translate }}</option>
      <option value="toggle">{{ "PRESETS.QUESTION.TYPE.toggle" | translate }}</option>
    </select>

    <select *ngIf="!editMode || isTaggedQuestion" class="form-select" disabled>
      <option [innerHtml]="'PRESETS.QUESTION.TYPE.' + question.controlType" translate></option>
    </select>

    <ng-container [ngSwitch]="editMode">
      <select *ngSwitchCase="true" class="form-select" (ngModelChange)="changeIdentifier($event)" [(ngModel)]="question.identifier">
        <option *ngIf="isTaggedQuestion" [value]="question.identifier">#{{question.identifier}}</option>
        <option *ngFor="let question of getNonUsedQuestions()" [value]="question">#{{question}}</option>
        <option [value]="customId">custom</option>
      </select>
      <ng-container *ngSwitchDefault>
        <div *ngIf="isTaggedQuestion" class="tag-wrapper" >
          #{{question.identifier}}
        </div>
      </ng-container>
    </ng-container>

    <p>{{question.label | multiling:lang}}</p>

    <div class="button-actions">
      <button type="button" class="btn btn-xs ghost-edit"
              *ngIf="!editMode"
              (click)="cloneQuestion($event)">
        Clone
      </button>
      <button type="button" class="btn btn-xs btn-error"
              *ngIf="editMode"
              (click)="removeQuestion($event)">
        Delete
      </button>
      <button type="button" class="btn btn-xs ghost-edit"
              (click)="editMode = !editMode">
        Edit
      </button>
    </div>
  </div>


  <!-- Question edition -->
  <div class="question-body" *ngIf="editMode">
    <div class="question-toolbar">
      <button (click)="language = 'en'" class="btn btn-link" [ngClass]="{'active': language === 'en'}">
        English
        <span class ="alert-badge" *ngIf="countErrors('en') !== 0" [innerHtml]="countErrors('en')"></span>
      </button>
      <button (click)="language = 'fr'" class="btn btn-link" [ngClass]="{'active': language === 'fr'}">
        French
        <span class ="alert-badge" *ngIf="countErrors('fr') !== 0" [innerHtml]="countErrors('fr')"></span>
      </button>
      <label class="form-switch">
        <input type="checkbox" [(ngModel)]="question.canComment">
        <i class="form-icon"></i> Add comment
      </label>
    </div>

    <ng-container *ngFor="let lang of ['en', 'fr']">
      <div class="labelling" *ngIf="lang === language">
        <div class="form-group">
          <label class="form-label" for="form-label" translate>PRESETS.QUESTION.EDIT.LABEL</label>
          <input
            type="text"
            class="form-input"
            id="form-label"
            placeholder="label"
            [(ngModel)]="question.label[lang]">
        </div>

        <div class="form-group">
          <label class="form-label" for="form-title" translate>PRESETS.QUESTION.EDIT.TITLE</label>
          <input
            type="text"
            class="form-input"
            id="form-title"
            placeholder="title"
            [(ngModel)]="question.title[lang]">
        </div>

        <div class="form-group">
          <label class="form-label" for="form-subtitle" translate>PRESETS.QUESTION.EDIT.SUBTITLE</label>
          <input
            type="text"
            class="form-input"
            id="form-subtitle"
            placeholder="subtitle"
            [(ngModel)]="question.subtitle[lang]">
        </div>
      </div>
    </ng-container>

    <div class="option-list" id="optionsWrap"
         *ngIf="question.controlType === 'radio' || question.controlType === 'checkbox'">

      <div *ngFor="let option of question.options; let i = index;" class="option">
        <div (click)="deleteOption($event, i)" class="delete-option">
          <i class="icon icon-cross"></i>
        </div>

        <div class="add-item-language">
          <div class="form-group">
            <label class="form-label" for="label-fr">French</label>
            <input
              type="text"
              class="form-input"
              [(ngModel)]="option.label.fr"
              id="label-fr">
          </div>

          <div class="form-group">
            <label class="form-label" for="label-en">English</label>
            <input
              type="text"
              class="form-input"
              [(ngModel)]="option.label.en"
              id="label-en">
          </div>
        </div>

        <ng-container *ngIf="question.controlType === 'radio'">

          <label for="form-color">
            Option color
            <select class="form-select" id="form-color" [(ngModel)]="option.color">
              <option [value]="'#34AC01'">Vert fonc√©</option>
              <option [value]="'#82CD30'">Vert clair</option>
              <option [value]="'#F2C500'">Jaune</option>
              <option [value]="'#C0210F'">Rouge</option>
            </select>
          </label>

          <label class="form-switch">
            <input type="checkbox" [(ngModel)]="option.positive">
            <i class="form-icon"></i> Positive answer
          </label>

        </ng-container>

      </div>

      <button (click)="addNewOption($event)" class="btn btn-primary ghost-primary" type="button">
        Add item
      </button>

    </div>
  </div>

</div>

