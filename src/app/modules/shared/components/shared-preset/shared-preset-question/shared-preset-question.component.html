<div [id]="'question-' + questionIndex" class="shared-preset-question">

  <!-- header -->
  <div [ngClass]="{'is-edit-mode': editMode}" class="header-wrapper flex-between">

    <!-- move / select / type / label-->
    <div class="d-flex align-center">

      <div data-tooltip="Move question" class="move-arrows tooltip">
        <i (click)="up($event)" class="icon icon-arrow-up"></i>
        <i (click)="down($event)" class="icon icon-arrow-down"></i>
      </div>

      <ng-container *ngIf="!editMode || isTaggedQuestion">
        <label class="m-right-20">
          <select class="form-select is-sm" disabled>
            <option>{{ 'PRESETS.QUESTION.TYPE.' + question.controlType | translate }}</option>
          </select>
        </label>
        <span *ngIf="!editMode" class="m-right-20">{{ question.label | multiling:lang }}</span>
      </ng-container>

      <ng-container *ngIf="editMode && !isTaggedQuestion">
        <label class="m-right-20">
          <select
            (ngModelChange)="notifyChanges()"
            [(ngModel)]="question.controlType"
            class="form-select is-sm">
            <option value="radio">Unique choice question</option>
            <option value="checkbox">Multiple choice question</option>
            <option value="textarea">Text</option>
            <option value="list">List of items</option>
            <option value="clearbit">List of companies</option>
            <option value="scale">Rating</option>
            <option value="stars">Star rating</option>
            <option value="toggle">Toggle</option>
          </select>
        </label>
      </ng-container>

      <ng-container *ngIf="editMode">
        <label class="m-right-20">
          <select
            (ngModelChange)="changeIdentifier($event)"
            [(ngModel)]="question.identifier"
            class="form-select is-sm">
            <option *ngIf="isTaggedQuestion" [value]="question.identifier">#{{question.identifier}}</option>
            <option *ngFor="let question of getNonUsedQuestions()" [value]="question">#{{question}}</option>
            <option [value]="customId">custom</option>
          </select>
        </label>
      </ng-container>

      <ng-container *ngIf="!editMode && isTaggedQuestion">
        <div class="label is-rounded is-tag m-no m-right-20 text-sm">
          #{{question.identifier}}
        </div>
      </ng-container>

    </div>
    <!-- /move / select / type / label -->

    <!-- buttons -->
    <div class="buttons-wrapper">

      <!-- delete -->
      <div
        (click)="removeQuestion($event)"
        *ngIf="editMode"
        [id]="'sharedPresetQuestion-btn-delete-question'"
        class="icon-container is-overlay m-right-15">
        <span data-tooltip="Delete" class="tooltip">
          <i class="icon icon-delete text-white"></i>
        </span>
      </div>
      <!-- /delete -->

      <!-- clone -->
      <div
        (click)="cloneQuestion($event)"
        *ngIf="editMode"
        [id]="'sharedPresetQuestion-btn-clone-question'"
        class="icon-container is-overlay m-right-15">
        <span data-tooltip="Clone" class="tooltip">
          <i class="icon icon-copy text-white"></i>
        </span>
      </div>
      <!-- /clone -->

      <!-- edit -->
      <div
        (click)="editMode = !editMode"
        [id]="'sharedPresetSection-btn-edit-section'"
        class="icon-container is-overlay">
        <span [attr.data-tooltip]="editMode ? 'Stop editing' : 'Edit'" class="tooltip">
          <img [src]="picto.edit.white" alt=" " class="img-responsive">
        </span>
      </div>
      <!-- /edit -->

    </div>
    <!-- /buttons -->

  </div>
  <!-- /header -->

  <!-- question edition -->
  <div *ngIf="editMode" class="question-body">

    <!-- toolbar -->
    <div class="question-toolbar m-bottom-25">

      <div class="d-flex align-center">

        <!-- english -->
        <button
          (click)="language = 'en'"
          [ngClass]="{'active': language === 'en'}"
          class="button is-outlined is-sm text-primary-dark m-right-20">
          English
          <span *ngIf="countErrors('en') !== 0" class="label is-danger is-sm is-rounded">
          {{ countErrors('en') }}
        </span>
        </button>
        <!-- /english -->

        <!-- french -->
        <button
          (click)="language = 'fr'"
          [ngClass]="{'active': language === 'fr'}"
          class="button is-outlined is-sm text-primary-dark m-right-50">
          French
          <span *ngIf="countErrors('fr') !== 0" class="label is-danger is-sm is-rounded">
          {{ countErrors('fr') }}
        </span>
        </button>
        <!-- /french -->

        <!-- add comment -->
        <label class="form-switch">
          <input
            (ngModelChange)="notifyChanges()"
            [(ngModel)]="question.canComment"
            type="checkbox">
          <i class="form-icon"></i> Add comment
        </label>
        <!-- /add comment -->

        <!-- show favourable answers -->
        <label *ngIf="question.controlType === 'radio'" class="form-switch m-left-50">
          <input
            (ngModelChange)="notifyChanges()"
            [(ngModel)]="question.visibility"
            type="checkbox">
          <i class="form-icon"></i> Show favorable answers
        </label>
        <!-- /show favourable answers -->

      </div>

      <!-- import benefits -->
      <button
        (click)="fillWithBenefits($event)"
        *ngIf="question.controlType === 'stars'"
        class="button is-outlined is-info is-sm m-left-50">
        Import benefits
      </button>
      <!-- /import benefits -->

    </div>
    <!-- /toolbar -->

    <!-- label / title / subtitle -->
    <div *ngFor="let lang of ['en', 'fr']">
      <div *ngIf="lang === language" class="question-labelling-options flex-between">
        <div class="form-group">
          <label class="form-label" for="question-label">Question Label</label>
          <input
            (ngModelChange)="notifyChanges()"
            [(ngModel)]="question.label[lang]"
            [placeholder]="'Label in ' + (lang === 'fr' ? 'French' : 'English')"
            class="form-input is-sm is-shadowed"
            id="question-label"
            type="text">
        </div>
        <div class="form-group">
          <label class="form-label" for="question-title">Infographics Title</label>
          <input
            (ngModelChange)="notifyChanges()"
            [(ngModel)]="question.title[lang]"
            [placeholder]="'Title in ' + (lang === 'fr' ? 'French' : 'English')"
            class="form-input is-sm is-shadowed"
            id="question-title"
            type="text">
        </div>
        <div class="form-group">
          <label class="form-label" for="question-subtitle">Infographics Subtitle</label>
          <input
            (ngModelChange)="notifyChanges()"
            [(ngModel)]="question.subtitle[lang]"
            [placeholder]="'Subtitle in ' + (lang === 'fr' ? 'French' : 'English')"
            class="form-input is-sm is-shadowed"
            id="question-subtitle"
            type="text">
        </div>
      </div>
    </div>
    <!-- /label / title / subtitle -->

    <!-- question types -->
    <ng-container
      *ngIf="question.controlType === 'radio' || question.controlType === 'checkbox'
      || question.controlType === 'stars'">

      <!-- options -->
      <div class="options-wrapper">
        <div *ngFor="let option of question.options; let i = index;" class="card">

          <!-- cross icon -->
          <div class="text-center m-bottom-10">
            <button
              (click)="deleteOption($event, i)"
              [id]="'sharedPresetQuestion-btn-delete-option'"
              class="close text-center text-primary-dark is-sm">
            </button>
          </div>
          <!-- /cross icon -->

          <!-- positive answer -->
          <ng-container *ngIf="question.controlType === 'radio' && question.visibility">
            <div class="text-center m-bottom-20">
              <label class="form-switch">
                <input
                  (ngModelChange)="notifyChanges()"
                  [(ngModel)]="option.positive"
                  type="checkbox">
                <i class="form-icon"></i> Positive answer
              </label>
            </div>
          </ng-container>
          <!-- /positive answer -->

          <!-- label English -->
          <div class="form-group">
            <label class="form-label" for="label-en">English</label>
            <input
              (ngModelChange)="notifyChanges()"
              [(ngModel)]="option.label.en"
              class="form-input is-sm is-shadowed"
              id="label-en"
              type="text">
          </div>
          <!-- /label English -->

          <!-- label French -->
          <div class="form-group">
            <label class="form-label" for="label-fr">French</label>
            <input
              (ngModelChange)="notifyChanges()"
              [(ngModel)]="option.label.fr"
              class="form-input is-sm is-shadowed"
              id="label-fr"
              type="text">
          </div>
          <!-- /label French -->

          <!-- if type Radio -->
          <ng-container *ngIf="question.controlType === 'radio'">

            <!-- option color -->
            <div class="p-top-20 text-sm text-medium flex-centered m-bottom-30">
              Selected option color:
              <span [ngStyle]="{'background-color': option.color}" class="shape is-circle is-sm m-left-2"></span>
            </div>
            <!-- /option color -->

            <!-- color options -->
            <div class="d-flex align-center text-sm text-medium m-bottom-20">
              <span class="m-right-2">Select one color:</span>
              <span
                *ngFor="let color of optionColors"
                (click)="setColor(color, i)"
                [ngStyle]="{'background-color': color}"
                class="shape c-hand is-circle is-sm">
              </span>
            </div>
            <!-- /color options -->

          </ng-container>
          <!-- /if type Radio -->

        </div>
      </div>
      <!-- /options -->

      <!-- add item -->
      <div class="text-center p-top-10 m-bottom-15">
        <button
          (click)="addNewOption($event)"
          [id]="'sharedPresetQuestion-btn-add-item'"
          class="button is-link is-info text-bold is-sm"
          type="button">
          <span class="icon-container is-overlay is-sm active m-right-10">
            <i class="icon icon-plus text-xs"></i>
          </span>
          Add item
        </button>
      </div>
      <!-- /add item -->

    </ng-container>
    <!-- /question types -->

  </div>
  <!-- /question edition -->

</div>

