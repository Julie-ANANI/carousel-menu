<section class="section-container"  id="discover-page-wrapper">
  <div class="column col-xs-12 col-11 col-mx-auto">

    <!-- Heading and Search field -->
    <div class="header-wrapper">
      <h1 class="main-heading">{{ 'DISCOVER.PAGE_DESCRIPTION' | translate }}</h1>
      <div class="search">
        <app-search-input></app-search-input>
      </div>
    </div>
    <!-- /Heading and Search field -->

    <!-- Spinner display -->
    <div *ngIf="displaySpinner" class="spinner-wrapper">
      <app-shared-loader></app-shared-loader>
    </div>
    <!-- /Spinner display -->

    <!-- Spinner display is off -->
    <ng-container *ngIf="!displaySpinner">

      <!-- Total number of innovations and filters -->
      <div [ngClass]="{ 'filter-wrapper': showFilterContainer }">

        <!-- result and add filter button -->
        <div class="total-filter-wrapper" [ngClass]="{ 'column col-xs-12 col-11 col-mx-auto': showFilterContainer }">

          <!-- show results title -->
          <h6 *ngIf="!showFilterContainer">{{ totalResults }} {{ 'innovations' }}</h6>
          <h6 *ngIf="showFilterContainer">{{ totalResults }} {{ 'DISCOVER.RESULT' | translate }}</h6>

          <!-- add filter button -->
          <ng-container *ngIf="showFilterContainer === false">
            <button class="btn btn-sm ghost-edit btn-filter" (click)="addFilter($event)"><i class="fas fa-sliders-h"></i>Add Filters</button>
          </ng-container>

          <!-- cancel and apply filter button -->
          <ng-container *ngIf="showFilterContainer === true">
            <div class="filter-action">
              <button class="btn btn-sm ghost-edit btn-cancel" (click)="cancelFilter($event)">Cancel</button>
              <button class="btn btn-sm btn-primary" (click)="applyFilter($event)">Apply Filters</button>
            </div>
          </ng-container>

        </div>
        <!-- /result and add filter button -->

        <!-- Filter applied -->
        <div *ngIf="filterApplied.length > 0" [ngClass]="{ 'column col-xs-12 col-11 col-mx-auto': showFilterContainer }">
          <ul *ngFor="let item of filterApplied" class="filter-applied-wrapper">
            <li (click)="removeFilter(item.id)">{{ getFilterName(item) }}<i class="fas fa-times"></i></li>
          </ul>
          <span *ngIf="filterApplied.length > 1" class="clear-filter" (click)="removeAllFilter($event)">Clear All</span>
        </div>
        <!-- /Filter applied -->

        <!-- add filter button is clicked, showing the container -->
        <div class="column col-xs-12 col-11 col-mx-auto filter-outer" [ngStyle]="{ 'display': showFilterContainer ? 'block' : 'none'}">
          <div class="filter-content">

            <!-- Filter sector -->
            <div *ngIf="tagType.length > 0" class="filter-type">
              <p>Type</p>
              <div *ngFor="let item of tagType.sort() | slice:0:endTypeIndex;" class="filter-option">
                <label class="form-checkbox">
                  <input
                    type="checkbox"
                    [id]="item.id"
                    [value]="item.type"
                    name="type"
                    (change)="toggleFilter($event)"
                    [checked]="filterChecked(item.id, 'type')"
                    [disabled]="checkDisable(item.id, 'type')">
                  <i class="form-icon"></i><span class="checkbox-label" [ngClass]="{ 'disabled-label': checkDisable(item.id, 'type') }">{{ getTypeName(item.type) }}</span>
                </label>
              </div>
              <span *ngIf="tagType.length > 4 && tagType.length !== endTypeIndex" class="text-link" (click)="changeIndex($event, 'type')">See more</span>
            </div>

            <!-- Language filter -->
            <div *ngIf="innoLang.length > 0" class="filter-language">
              <p>Language</p>
              <div *ngFor="let item of innoLang" class="filter-option">
                <label class="form-checkbox">
                  <input
                    type="checkbox"
                    [id]="item.lang"
                    [value]="item.lang"
                    name="language"
                    (change)="toggleFilter($event)"
                    [checked]="filterChecked(item.lang, 'language')"
                    [disabled]="checkDisable(item.lang, 'language')">
                  <i class="form-icon"></i><span class="checkbox-label" [ngClass]="{ 'disabled-label': checkDisable(item.lang, 'language') }">{{ getLangName(item.lang) }}</span>
                </label>
              </div>
            </div>

            <!-- Filter status -->
            <div *ngIf="innoStatus.length > 0" class="filter-status">
              <p>Status</p>
              <div *ngFor="let item of innoStatus" class="filter-option">
                <label class="form-checkbox">
                  <input
                    type="checkbox"
                    [id]="item.status"
                    [value]="item.status"
                    name="status"
                    (change)="toggleFilter($event)"
                    [checked]="filterChecked(item.status, 'status')"
                    [disabled]="checkDisable(item.status, 'status')">
                  <i class="form-icon"></i><span class="checkbox-label" [ngClass]="{ 'disabled-label': checkDisable(item.status, 'status') }">{{ getStatusName(item.status) }}</span>
                </label>
              </div>
            </div>

            <!-- Filter label -->
            <div *ngIf="tagLabel.length > 0" class="filter-label">
              <p>Label</p>
              <div *ngFor="let item of tagLabel | slice:0:endLabelIndex;" class="filter-option">
                <label class="form-checkbox">
                  <input
                    type="checkbox"
                    [id]="item.id"
                    name="label"
                    [value]="item.label"
                    (change)="toggleFilter($event)"
                    [checked]="filterChecked(item.id, 'label')"
                    [disabled]="checkDisable(item.id, 'label')">
                  <i class="form-icon"></i><span class="checkbox-label" [ngClass]="{ 'disabled-label': checkDisable(item.id, 'label') }">{{ getLabelName(item.label) }}</span>
                </label>
              </div>
              <span *ngIf="tagLabel.length > 4 && tagLabel.length !== endLabelIndex" class="text-link" (click)="changeIndex($event, 'label')">See more</span>
            </div>

          </div>
        </div>
        <!-- /add filter button is clicked, showing the container -->

      </div>
      <!-- /Total number of innovations and filters -->

      <div *ngIf="addingFilter && showFilterContainer" class="filter-spinner-wrapper"><app-shared-loader></app-shared-loader></div>

      <!-- Overlay to show black background when the filter button is clicked -->
      <div [ngClass]="{ 'filter-wrapper-overlay': showFilterContainer }" (click)="cancelFilter($event)"></div>

      <!-- Innovations -->
      <div class="innovations-wrapper">
        <div *ngFor="let innovation of innovationCards" class="innov-wrapper">
          <div class="innov-content">
            <a [routerLink]="innovation.innovation_reference" [queryParams]="{ lang: innovation.lang }" target="_blank">

              <!-- Image -->
              <div class="innov-img">
                <img [src]="getSrc(innovation)" alt="No media">
              </div>

              <!-- Body part -->
              <div class="innov-body">
                <h1 class="main-heading">{{ innovation.title | DiscoverSummaryPipe:80 }}</h1>
                <p>{{ innovation.summary }}</p>
              </div>

            </a>
          </div>
        </div>
      </div>
      <!-- /Innovations -->

      <!-- Pagination -->
      <div *ngIf="filterApplied.length === 0" class="pagination-wrapper">
        <app-pagination
          [total]="totalResults"
          [propertyName]="'app-discover'"
          [configValue]="paginationValue"
          (configChange)="changePagination($event)">
        </app-pagination>
      </div>
      <!-- /Pagination -->

    </ng-container>
    <!-- Spinner display is off -->

  </div>
</section>
