<section class="section-container"  id="discover-page-wrapper">
  <div class="column col-xs-12 col-11 col-mx-auto">

    <!-- Heading and Search field -->
    <div class="header-wrapper">
      <h1 class="main-heading">{{ 'DISCOVER.PAGE_DESCRIPTION' | translate }}</h1>
      <div class="search">
        <app-search-input
          [suggestions]="innovationDetails"
          (finalValueEmit)="onValueSelected($event)">
        </app-search-input>
      </div>
    </div>
    <!-- /Heading and Search field -->

    <!-- Spinner display -->
    <div *ngIf="displaySpinner" class="spinner-wrapper">
      <app-shared-loader></app-shared-loader>
    </div>
    <!-- /Spinner display -->

    <!-- Spinner display is off -->
    <ng-container *ngIf="!displaySpinner">

      <!-- Total number of innovations and filters -->
      <div [ngClass]="{ 'filter-wrapper': showFilterContainer }">

        <!-- result and add filter button -->
        <div class="total-filter-wrapper" [ngClass]="{ 'column col-xs-12 col-11 col-mx-auto': showFilterContainer }">

          <!-- show results title -->
          <h6 *ngIf="!showFilterContainer">{{ totalResults }} {{ 'innovations' }}</h6>
          <h6 *ngIf="showFilterContainer">{{ totalResults }} {{ 'DISCOVER.RESULT' | translate }}</h6>

          <!-- add filter button -->
          <ng-container *ngIf="showFilterContainer === false">
            <button class="btn btn-sm ghost-edit btn-filter" (click)="addFilter($event)"><i class="fas fa-sliders-h"></i>{{ 'DISCOVER.ADD_FILTERS' | translate }}</button>
          </ng-container>

          <!-- cancel and apply filter button -->
          <ng-container *ngIf="showFilterContainer === true">
            <div class="filter-action">
              <button class="btn btn-sm ghost-edit btn-cancel" (click)="cancelFilter($event)">{{ 'DISCOVER.CANCEL' | translate }}</button>
              <button class="btn btn-sm btn-primary" (click)="applyFilter($event)">{{ 'DISCOVER.APPLY_FILTERS' | translate }}</button>
            </div>
          </ng-container>

        </div>
        <!-- /result and add filter button -->

        <!-- Filter applied -->
        <div *ngIf="filterApplied.length > 0" [ngClass]="{ 'column col-xs-12 col-11 col-mx-auto': showFilterContainer }">
          <ul *ngFor="let item of filterApplied" class="filter-applied-wrapper">
            <li (click)="removeFilter(item.value)">{{ getFilterName(item) }}<i class="fas fa-times"></i></li>
          </ul>
          <span *ngIf="filterApplied.length > 1" class="clear-filter" (click)="removeAllFilter($event)">{{ 'DISCOVER.CLEAR_ALL' | translate }}</span>
        </div>
        <!-- /Filter applied -->

        <!-- add filter button is clicked, showing the container -->
        <div class="column col-xs-12 col-11 col-mx-auto filter-outer" [ngStyle]="{ 'display': showFilterContainer ? 'block' : 'none'}">
          <div class="filter-content">

            <!-- Filter sector -->
            <div class="filter-type">
              <ng-container *ngIf="tags.length > 0">
                <p>Type</p>
                <div class="filter-option">
                  <label class="form-checkbox">
                    <input
                      type="checkbox"
                      id="QUALIFICATION"
                      value="QUALIFICATION"
                      name="type"
                      (change)="toggleFilter($event)"
                      [checked]="filterChecked('QUALIFICATION', 'type')"
                      [disabled]="checkDisable('QUALIFICATION', 'type')">
                    <i class="form-icon"></i><span class="checkbox-label" [ngClass]="{ 'disabled-label': checkDisable('QUALIFICATION', 'type') }">Qualification</span>
                  </label>
                </div>
                <div class="filter-option">
                  <label class="form-checkbox">
                    <input
                      type="checkbox"
                      id="SECTOR"
                      value="SECTOR"
                      name="type"
                      (change)="toggleFilter($event)"
                      [checked]="filterChecked('SECTOR', 'type')"
                      [disabled]="checkDisable('SECTOR', 'type')">
                    <i class="form-icon"></i><span class="checkbox-label" [ngClass]="{ 'disabled-label': checkDisable('SECTOR', 'type') }">Sector</span>
                  </label>
                </div>
                <div class="filter-option">
                  <label class="form-checkbox">
                    <input
                      type="checkbox"
                      id="SOLUTION_TYPE"
                      value="SOLUTION_TYPE"
                      name="type"
                      (change)="toggleFilter($event)"
                      [checked]="filterChecked('SOLUTION_TYPE', 'type')"
                      [disabled]="checkDisable('SOLUTION_TYPE', 'type')">
                    <i class="form-icon"></i><span class="checkbox-label" [ngClass]="{ 'disabled-label': checkDisable('SOLUTION_TYPE', 'type') }">Solution</span>
                  </label>
                </div>
                <div class="filter-option">
                  <label class="form-checkbox">
                    <input
                      type="checkbox"
                      id="VALUE_CHAIN"
                      value="VALUE_CHAIN"
                      name="type"
                      (change)="toggleFilter($event)"
                      [checked]="filterChecked('VALUE_CHAIN', 'type')"
                      [disabled]="checkDisable('VALUE_CHAIN', 'type')">
                    <i class="form-icon"></i><span class="checkbox-label" [ngClass]="{ 'disabled-label': checkDisable('VALUE_CHAIN', 'type') }">Value Chain</span>
                  </label>
                </div>
              </ng-container>
            </div>

            <!-- Language filter -->
            <div class="filter-language">
              <p>{{ 'COMMON.LANGUAGE' | translate }}</p>
              <div class="filter-option">
                <label class="form-checkbox">
                  <input
                    type="checkbox"
                    id="en"
                    value="en"
                    name="language"
                    (change)="toggleFilter($event)"
                    [checked]="filterChecked('en', 'language')"
                    [disabled]="checkDisable('en', 'language')">
                  <i class="form-icon"></i><span class="checkbox-label" [ngClass]="{ 'disabled-label': checkDisable('en', 'language') }">{{ 'COMMON.LANG.EN' | translate }}</span>
                </label>
              </div>
              <div class="filter-option">
                <label class="form-checkbox">
                  <input
                    type="checkbox"
                    id="fr"
                    value="fr"
                    name="language"
                    (change)="toggleFilter($event)"
                    [checked]="filterChecked('fr', 'language')"
                    [disabled]="checkDisable('fr', 'language')">
                  <i class="form-icon"></i><span class="checkbox-label" [ngClass]="{ 'disabled-label': checkDisable('fr', 'language') }">{{ 'COMMON.LANG.FR' | translate }}</span>
                </label>
              </div>
            </div>

            <!-- Filter status -->
            <div class="filter-status">
              <p>{{ 'DISCOVER.STATUS' | translate }}</p>
              <div class="filter-option">
                <label class="form-checkbox">
                  <input
                    type="checkbox"
                    id="DONE"
                    value="DONE"
                    name="status"
                    (change)="toggleFilter($event)"
                    [checked]="filterChecked('DONE', 'status')"
                    [disabled]="checkDisable('DONE', 'status')">
                  <i class="form-icon"></i><span class="checkbox-label" [ngClass]="{ 'disabled-label': checkDisable('DONE', 'status') }">{{ getStatusName('DONE') }}</span>
                </label>
              </div>
              <div class="filter-option">
                <label class="form-checkbox">
                  <input
                    type="checkbox"
                    id="EVALUATING"
                    value="EVALUATING"
                    name="status"
                    (change)="toggleFilter($event)"
                    [checked]="filterChecked('EVALUATING', 'status')"
                    [disabled]="checkDisable('EVALUATING', 'status')">
                  <i class="form-icon"></i><span class="checkbox-label" [ngClass]="{ 'disabled-label': checkDisable('EVALUATING', 'status') }">{{ getStatusName('EVALUATING') }}</span>
                </label>
              </div>
            </div>

            <!-- Filter label -->
            <div class="filter-label">
              <ng-container *ngIf="tagLabel.length > 0">
                <p>Label</p>
                <div *ngFor="let item of tagLabel | slice:0:endLabelIndex;" class="filter-option">
                  <label class="form-checkbox">
                    <input
                      type="checkbox"
                      [id]="item.id"
                      name="label"
                      [value]="item.label"
                      (change)="toggleFilter($event)"
                      [checked]="filterChecked(item.id, 'label')"
                      [disabled]="checkDisable(item.id, 'label')">
                    <i class="form-icon"></i><span class="checkbox-label" [ngClass]="{ 'disabled-label': checkDisable(item.id, 'label') }">{{ getLabelName(item.label) }}</span>
                  </label>
                </div>
              </ng-container>
              <span *ngIf="tagLabel.length > 4 && tagLabel.length !== endLabelIndex" class="text-link" (click)="changeIndex($event, 'label')">{{ 'DISCOVER.SEE_MORE' | translate }}</span>
            </div>

          </div>
        </div>
        <!-- /add filter button is clicked, showing the container -->

      </div>
      <!-- /Total number of innovations and filters -->

      <!-- Display the spineer when filter is being added or removed -->
      <div *ngIf="addingFilter" class="filter-spinner-wrapper">
        <app-shared-loader></app-shared-loader>
      </div>

      <!-- Overlay to show black background when the filter button is clicked -->
      <div [ngClass]="{ 'filter-wrapper-overlay': showFilterContainer }" (click)="cancelFilter($event)"></div>

      <!-- Innovations -->
      <div class="innovations-wrapper">
        <div *ngFor="let innovation of innovationCards" class="innov-wrapper">
          <div class="innov-content">
            <a [routerLink]="[ innovation.innovation_reference, innovation.lang ]" target="_blank">

              <!-- Image -->
              <div class="innov-img">
                <img [src]="getSrc(innovation)" alt="No media">
              </div>

              <!-- Body part -->
              <div class="innov-body">
                <h1 class="main-heading">{{ innovation.title | DiscoverSummaryPipe:80 }}</h1>
                <p>{{ innovation.summary }}</p>
              </div>

            </a>
          </div>
        </div>
      </div>
      <!-- /Innovations -->

      <!-- Pagination -->
      <div class="pagination-wrapper">
        <app-pagination
          [total]="totalResults"
          [propertyName]="'app-discover'"
          [configValue]="paginationValue"
          (configChange)="changePagination($event)">
        </app-pagination>
      </div>
      <!-- Pagination -->

    </ng-container>
    <!-- Spinner display is off -->

  </div>
</section>
