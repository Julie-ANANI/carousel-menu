<div class="container">
  <div class="columns">
    <div class="column col-10 col-mx-auto">

      <h1>{{ 'COMMON.MY_PROJECTS' | translate }}</h1>

      <div class="columns" *ngIf="projects && projects.length">
        <div class="column col-2">
          <button [routerLink]="'/projects/new'" class="btn btn-lg btn-primary">{{ 'MY_PROJECTS.ADD_PROJECT' | translate }} <i class="icon icon-arrow-right"></i></button>
        </div>

        <div class="column col-10">
          <ul class="list-filter">
            <li><sq-sort [config]="config" (configChange)="loadProjects($event)" [prop]="'name'"><button class="btn btn-link">{{ 'COMMON.SORT.BY_NAME' | translate }}</button></sq-sort></li>
            <li><sq-sort [config]="config" (configChange)="loadProjects($event)" [prop]="'owner.companyName'"><button class="btn btn-link">{{ 'COMMON.SORT.BY_COMPANY' | translate }}</button></sq-sort></li>
            <li><sq-sort [config]="config" (configChange)="loadProjects($event)" [prop]="'owner.name'"><button class="btn btn-link">{{ 'COMMON.SORT.BY_AUTHOR' | translate }} </button></sq-sort></li>
            <li><sq-sort [config]="config" (configChange)="loadProjects($event)" [prop]="'updated'"><button class="btn btn-link">{{ 'COMMON.SORT.BY_UPDATE_DATE' | translate }} </button></sq-sort></li>
            <li><sq-sort [config]="config" (configChange)="loadProjects($event)" [prop]="'created'"><button class="btn btn-link">{{ 'COMMON.SORT.BY_CREATION_DATE' | translate }}</button></sq-sort></li>
            <li><sqFilter [config]="config" (configChange)="loadProjects($event)" prop="name"></sqFilter><i class="icon icon-search"></i></li>
          </ul>
        </div>
      </div>

      <div class="empty" *ngIf="projects && !projects.length">
        <div class="empty-icon">
          <i class="icon icon-plus"></i>
        </div>
        <p class="empty-title h5">{{ 'MY_PROJECTS.NO_PROJECT.TITLE' | translate }}</p>
        <p class="empty-subtitle">{{ 'MY_PROJECTS.NO_PROJECT.CONTENT' | translate }}</p>
        <div class="empty-action">
          <button [routerLink]="'/projects/new'" class="btn btn-lg btn-primary">{{ 'MY_PROJECTS.ADD_PROJECT' | translate }} <i class="icon icon-arrow-right"></i></button>
        </div>
      </div>

      <div class="project" *ngFor="let project of projects">
        <div class="picture">
          <a [routerLink]="getRelevantLink(project)">
            <img [src]="getPrincipalMedia(project)" class="img-fit-cover" width="218px" height="218px">
          </a>
        </div>
        <div class="description">
          <div class="title"><a [routerLink]="getRelevantLink(project)">{{ project.name || ('MY_PROJECTS.UNTITLED' | translate) }}</a></div>
          <div class="metas">{{ project.owner.name }} / {{ project.owner.companyName }}
            • {{ 'MY_PROJECTS.ADDED' | translate }} {{ project.created | date:dateFormat }}
            • {{ 'MY_PROJECTS.UPDATED' | translate }} {{ project.updated | date:dateFormat }}
            • <a (click)="selectedProjectIdToBeDeleted = project._id" class="text-error c-hand">{{ 'COMMON.DELETE' | translate }}</a></div>
          <ul class="step">
            <li class="step-item" [ngClass]="{ 'active': project.status === 'EDITING' && !project.reviewing }">
              <a [routerLink]="getRelevantLink(project)">{{ 'COMMON.PROJECT_STATE.EDITING' | translate }}</a>
            </li>
            <li class="step-item" [ngClass]="{ 'active': project.status === 'SUBMITTED' }">
              <a [routerLink]="getRelevantLink(project)">{{ 'COMMON.PROJECT_STATE.SUBMITTED' | translate }}</a>
            </li>
            <li class="step-item" [ngClass]="{ 'active': project.status === 'EDITING' && !!project.reviewing }">
              <a [routerLink]="getRelevantLink(project)">{{ 'COMMON.PROJECT_STATE.REVIEWING' | translate }}</a>
            </li>
            <li class="step-item" [ngClass]="{ 'active': project.status === 'EVALUATING' }">
              <a [routerLink]="getRelevantLink(project)">{{ 'COMMON.PROJECT_STATE.EVALUATING' | translate }}</a>
            </li>
            <li class="step-item" [ngClass]="{ 'active': project.status === 'DONE' }">
              <a [routerLink]="getRelevantLink(project)">{{ 'COMMON.PROJECT_STATE.DONE' | translate }}</a>
            </li>
          </ul>
        </div>
      </div>
      <sqPagination [config]="config" (configChange)="loadProjects($event)" [total]="total"></sqPagination>
    </div>
  </div>
</div>





<!-- MODAL : Are you sure you want to delete this project ? -->
<div class="modal" [ngClass]="{'active': selectedProjectIdToBeDeleted}">
  <div class="modal-overlay" (click)="selectedProjectIdToBeDeleted = null"></div>
  <div class="modal-container">
    <div class="modal-header">
      <button class="btn btn-clear float-right" (click)="selectedProjectIdToBeDeleted = null"></button>
      <div class="modal-title h5">{{ 'MY_PROJECTS.DELETE_PROJECT_MODAL.TITLE' | translate }}</div>
    </div>
    <div class="modal-body">
      <div class="content">{{ 'MY_PROJECTS.DELETE_PROJECT_MODAL.CONTENT' | translate }}</div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-link" (click)="removeProject(selectedProjectIdToBeDeleted)">{{ 'COMMON.DELETE' | translate }}</button>
      <button class="btn btn-primary" (click)="selectedProjectIdToBeDeleted = null">{{ 'COMMON.CANCEL' | translate }}</button>
    </div>
  </div>
</div>
