<div class="section-container exploration-wrapper">
  <div class="column col-xs-12 col-11 col-mx-auto">

    <!-- Project under editing and submitted status -->
    <div *ngIf="projectStatus === 'EDITING' || projectStatus === 'SUBMITTED'">
      <h1 class="main-heading">{{ ('PROJECT_MODULE.EXPLORATION.TITLE.' + projectStatus)  | translate }}</h1>
      <div class="text-center" [ngStyle]="{ 'padding-top': '25px' }">
      <span class="bot-rect" [ngSwitch]="projectStatus">
        <ng-container *ngSwitchCase="'EDITING'">
           <ng-container *ngIf="project.reviewing">
              {{ 'PROJECT_MODULE.EXPLORATION.MESSAGE.REVIEWING' | translate }}
            </ng-container>
            <ng-container *ngIf="!project.reviewing">
              {{ 'PROJECT_MODULE.EXPLORATION.MESSAGE.EDITING.A' | translate }}
              <span [ngStyle]="{ 'color': '#FFB300' }">
                {{ 'PROJECT_MODULE.EXPLORATION.MESSAGE.EDITING.B' | translate }}
              </span>
              {{ 'PROJECT_MODULE.EXPLORATION.MESSAGE.EDITING.C' | translate }}
            </ng-container>
        </ng-container>
        <ng-container *ngSwitchCase="'SUBMITTED'">
            {{ 'PROJECT_MODULE.EXPLORATION.MESSAGE.SUBMITTED' | translate }}
        </ng-container>
      </span>
        <br>
        <img src="https://res.cloudinary.com/umi/image/upload/v1528795403/app/default-images/bot-triangle.svg" class="bot-trian">
        <div><img src="https://res.cloudinary.com/umi/image/upload/v1528795365/app/default-images/bot-1.svg" alt="Bot" class="bot-image"></div>
      </div>
    </div>


    <!-- Project under evaluating and evaluating done status-->
    <div *ngIf="projectStatus === 'EVALUATING' || projectStatus === 'DONE'">

      <!-- Title and contact button section -->
      <div class="e-title-wrapper">
        <h1 *ngIf="projectStatus === 'EVALUATING'" class="main-heading">{{ 'PROJECT_MODULE.EXPLORATION.TITLE.EVALUATING' | translate }}</h1>
        <h1 *ngIf="projectStatus === 'DONE'" class="main-heading">{{ 'PROJECT_MODULE.EXPLORATION.TITLE.DONE' | translate }}</h1>
        <a class="btn btn-primary" href="{{ contactUrl }}">{{'PROJECT_MODULE.EXPLORATION.CONTACT_BUTTON' | translate}}</a>
      </div>

      <!-- Status and comment section -->
      <div class="e-comm-wrapper section-light-container">

        <!-- Status -->
        <div class="e-status-wrapper">
          <h2 class="section-heading">{{ 'PROJECT_MODULE.EXPLORATION.STATUS_TEXT.TITLE' | translate }}</h2>

          <div class="e-info-status">
            <p>
              <i class="fas fa-check"></i>
              <span class="text-white">{{ 'PROJECT_MODULE.EXPLORATION.STATUS_TEXT.CREATED' | translate }}</span>
            </p>
            <p><span class="text-white">{{ project.created | date }}</span></p>
          </div>

          <ng-container *ngFor="let action of project.statusLogs">
            <div class="e-info-status">
              <p>
                <i class="fas" [ngClass]="(action.action === 'REJECT') ? 'fa-times' : 'fa-check'"></i>
                <span class="text-white">
                {{ ('PROJECT_MODULE.EXPLORATION.STATUS_TEXT.' + action.action) | translate }}
              </span>
              </p>
              <p><span class="text-white">{{ action.date | date }}</span></p>
            </div>
          </ng-container>

        </div>

        <!-- Comment -->
        <div class="e-comment-wrapper">
          <h2 class="section-heading">{{ 'PROJECT_MODULE.EXPLORATION.COMMENTS' | translate }}</h2>
          <p [innerHtml]="project.comments"></p>
          <div>
            <span [ngStyle]="{ 'color': '#333333' }">{{ 'PROJECT_MODULE.EXPLORATION.ACCOUNT_MANAGER' | translate }}</span>
            {{ project.operator?.name }}
          </div>
        </div>

      </div>

      <!-- Analytics section -->
      <div class="section-light-container" [ngStyle]="{ 'padding-bottom': '0' }">
        <h2 class="section-heading">{{'PROJECT_MODULE.EXPLORATION.ANALYTICS.TITLE' | translate}}</h2>
        <div class="e-analytic-wrapper">

          <!-- Reached -->
          <div class="e-info-analytic">
            <p>{{ 'PROJECT_MODULE.EXPLORATION.ANALYTICS.PROFESSIONALS_REACHED' | translate }}</p>
            <h5 class="text-center">{{ campaignStats?.nbProsSent || 0 }}</h5>
          </div>

          <div class="e-info-analytic pd-top">
            <svg width="80px" height="38px" viewBox="0 0 80 38">
              <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                <g transform="translate(-701.000000, -810.000000)">
                  <g transform="translate(701.000000, 810.000000)">
                    <polygon fill="#2ECC71" points="0 0 64.1497147 0 80 19.8465833 64.1497147 38 0 38 14.6486762 19"></polygon>
                    <text class="svg-text">
                      <tspan x="27.4760742" y="24">{{ percentageCalculataion(campaignStats?.nbProsSent, campaignStats?.nbProsOpened) || 0 }}%</tspan>
                    </text>
                  </g>
                </g>
              </g>
            </svg>
          </div>

          <!-- Emails -->
          <div class="e-info-analytic">
            <p>{{ 'PROJECT_MODULE.EXPLORATION.ANALYTICS.EMAILS_OPENED' | translate }}</p>
            <h5 class="text-center">{{ campaignStats?.nbProsOpened || 0 }}</h5>
          </div>

          <div class="e-info-analytic pd-top">
            <svg width="80px" height="38px" viewBox="0 0 80 38">
              <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                <g transform="translate(-701.000000, -810.000000)">
                  <g transform="translate(701.000000, 810.000000)">
                    <polygon fill="#EA5858" points="0 0 64.1497147 0 80 19.8465833 64.1497147 38 0 38 14.6486762 19"></polygon>
                    <text class="svg-text">
                      <tspan x="27.4760742" y="24">{{ percentageCalculataion(campaignStats?.nbProsOpened, campaignStats?.nbProsClicked) || 0 }}%</tspan>
                    </text>
                  </g>
                </g>
              </g>
            </svg>
          </div>

          <!-- Clicks -->
          <div class="e-info-analytic">
            <p>{{ 'PROJECT_MODULE.EXPLORATION.ANALYTICS.CLICKS' | translate }}</p>
            <h5 class="text-center">{{ campaignStats?.nbProsClicked || 0 }}</h5>
          </div>

          <div class="e-info-analytic pd-top">
            <svg width="80px" height="38px" viewBox="0 0 80 38">
              <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                <g transform="translate(-701.000000, -810.000000)">
                  <g transform="translate(701.000000, 810.000000)">
                    <polygon fill="#F79323" points="0 0 64.1497147 0 80 19.8465833 64.1497147 38 0 38 14.6486762 19"></polygon>
                    <text class="svg-text">
                      <tspan x="27.4760742" y="24">{{ percentageCalculataion(campaignStats?.nbProsClicked, campaignStats?.nbValidatedResp) || 0 }}%</tspan>
                    </text>
                  </g>
                </g>
              </g>
            </svg>
          </div>

          <!-- Answers -->
          <div class="e-info-analytic">
            <p>{{ 'PROJECT_MODULE.EXPLORATION.ANALYTICS.ANSWERS' | translate }}</p>
            <h5 class="text-center">{{ campaignStats?.nbValidatedResp || 0 }}</h5>
          </div>

        </div>

      </div>

      <!-- Click rate section -->
      <div class="section-light-container">
        <h2 class="section-heading">{{ 'PROJECT_MODULE.EXPLORATION.CLICK_MAP_TITLE' | translate }}</h2>
        <app-worldmap
          [countries]="countries"
          [countriesColor]="'#2ECC71'"
          [isEditable]="false"
          [width]="'auto'">
        </app-worldmap>
      </div>

      <!-- Company section -->
      <div *ngIf="companies.length > 0" class="section-light-container" [ngStyle]="{ 'padding-bottom': '15px' }">
        <h2 class="section-heading">{{ 'PROJECT_MODULE.EXPLORATION.COMPANIES_LIST_TITLE' | translate }}</h2>
        <ul class="e-comp-name-wrapper">
          <li *ngFor="let company of companies; let i = index;">
            {{ i + 1 + '.'}} {{ formatCompanyName(company.name) }}
          </li>
        </ul>
      </div>

      <!-- Insight section -->
      <div class="section-light-container" [ngStyle]="{ 'padding-bottom': '0' }">
        <h2 class="section-heading">{{ 'PROJECT_MODULE.EXPLORATION.INSIGHTS_TITLE' | translate }}</h2>
        <app-shared-table [data]="tableInfos" [config]="config" (editRow)="seeAnswer($event)"></app-shared-table>
      </div>

    </div>
    <!-- /Project under evaluating and evaluating done status-->

  </div>
</div>

<!-- Insight preview -->
<app-sidebar [template]="sidebarTemplateValue" (closeSidebar)="closeSidebar($event)">
  <app-user-answer
    [adminMode]="false"
    [mode]="false"
    [(userAnswer)]="modalAnswer"
    [questions]="questions"
    [innovationId]="project._id">
  </app-user-answer>
</app-sidebar>

