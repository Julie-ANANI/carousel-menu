<div class="text-right">
  <button class="btn btn-primary" (click)="importModal = true">Importer un Workflow</button>
</div>

<div *ngIf="!domain">
  <div class="bot-wrapper text-center">
    <span class="bot-rect">Attention, le domaine n'est pas défini. Modifiez-le dans le projet, onglet Settings.</span>
    <br>
    <img src="https://res.cloudinary.com/umi/image/upload/app/default-images/bot-triangle.svg" class="bot-trian">
    <div><img src="http://res.cloudinary.com/umi/image/upload/app/default-images/error-bot.svg" width="" height="120"></div>
  </div>
</div>

<div *ngIf="domain">
  *|DOMAIN|* <br>
  en :{{this.campaign.innovation.settings.domain.en}} <br>
  fr :{{this.campaign.innovation.settings.domain.fr}}
</div>

<div>
  <app-admin-campaign-abtesting [modifiedScenarios]="modifiedScenarios" [campaign]="campaign"></app-admin-campaign-abtesting>
</div>
<br>
<div>
  <h3> Choix du Workflow par défault </h3>
  <form>
    <select class = "form-select"
            [(ngModel)] = "modalSelectDefault[1]"
            id = "workflow"
            name = "quelquechose"
            (ngModelChange) ="areYouSureYouWantToChange($event)">
      <option *ngFor = "let scenario of modifiedScenarios"
              [ngValue] = "scenario.name">
        {{scenario.name}}
      </option>
    </select>
  </form>
  <p class="text-error" *ngIf="modifiedScenarios.length === 0">
    Vous devez avoir au moins un workflow avec tous les emails modifiés
  </p>
  <div *ngFor="let scenario of availableScenarios">
    <app-admin-edit-workflow
      [scenario]="scenario"
      [signatures]="signatures"
      (scenarioChange)="updateAvailableScenario($event)"
      (deletedScenario)="removeScenario($event)">
    </app-admin-edit-workflow>
  </div>
</div>


<!-- MODAL : Import d'un template -->
<div class="modal" [ngClass]="{'active': importModal}">
  <div class="modal-overlay" (click)="(importModal = false) && $event.preventDefault()"></div>
  <div class="modal-container">
    <div class="modal-header">
      <button class="btn btn-clear float-right" (click)="(importModal = false) && $event.preventDefault()"></button>
      <div class="modal-title h5">Import d'un template</div>
    </div>
    <div class="modal-body">
      <div class="content">
        Liste des templates existants :
        <p *ngIf="!templates">
          Il n'y a pas de template dans la bibliothèque
        </p>
        <table class="table" *ngIf="templates">
          <thead>
          <tr>
            <th>Nom</th>
            <th>Nombre d'emails</th>
            <th></th>
          </tr>
          </thead>
          <tbody>
          <tr *ngFor="let template of templates">
            <td>{{ template.name }}</td>
            <td>{{ template.emails.length }}</td>
            <td><button class="btn btn-primary" (click)="importTemplate(template)">Importer</button></td>
          </tr>
          </tbody>
        </table>

      </div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-link" (click)="(importModal = false) && $event.preventDefault()">
        {{ 'COMMON.CANCEL' | translate }}
      </button>
    </div>
  </div>
</div>


<!-- Modal selection  d'un workflow par default -->
<div class="modal" [ngClass]="{'active': modalSelectDefault[0]}">
  <div class="modal-overlay" (click)="(modalSelectDefault[0] = !modalSelectDefault[0])"></div>
  <div class="modal-container">
    <div class="modal-header">
      <button class="btn btn-clear float-right" (click)="(modalSelectDefault[0] = !modalSelectDefault[0])"></button>
      <div class="modal-title h5">{{ 'CAMPAIGNS.SELECT_DEFAULT.TITLE' | translate }}</div>
    </div>
    <div class="modal-body">
      <div class="content">
        {{'CAMPAIGNS.SELECT_DEFAULT.CONTENT' | translate}}
      </div>
    </div>

    <div class="modal-footer">
      <button class="btn btn-primary" (click)="changeDefaultWorkflow()">{{ 'COMMON.UPDATE' | translate }}</button>
      <button class="btn btn-link" (click)="resetDefaultWorkflow()">
        {{ 'COMMON.CANCEL' | translate }}
      </button>
    </div>
  </div>
</div>


