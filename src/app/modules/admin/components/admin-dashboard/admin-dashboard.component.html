<div class="projects-stats" *ngIf="adminLevel > 2">
  <select class="form-select" [(ngModel)]="operatorId" (ngModelChange)="newOperatorSelected($event)">
    <option value="">{{ 'DASHBOARD.STATS.ALL_OPERATORS' | translate }}</option>
    <option *ngFor="let operator of operators" [ngValue]="operator._id" [selected]="operatorId === operator._id">{{
      operator.firstName + ' ' + operator.lastName }}
    </option>
  </select>

  <div *ngIf="operatorData.nbProjectsToValidate !== 'undefined'"><span>{{ operatorData.nbProjectsToValidate }}</span> projet{{ operatorData.nbProjectsToValidate>1?'s':'' }} à valider</div>
  <div *ngIf="operatorData.nbProjectsToTreat !== 'undefined'"><span>{{ operatorData.nbProjectsToTreat }}</span> réponse{{ operatorData.nbProjectsToTreat>1?'s':'' }} à traiter</div>
</div>
<div class="emails-stats" *ngIf="adminLevel > 2">
  <select class="form-select" [(ngModel)]="nbDaysOfStats" (ngModelChange)="getPeriodStats()">
    <option [value]="1">Comparer...</option>
    <option [value]="30">Dernier mois</option>
    <option [value]="365">Dernière année</option>
  </select>
  <div>Pros trouvés : <span>{{ statistics.percentFoundPros }}</span></div>
  <div>Emails trouvés : <span>{{ statistics.percentFoundEmails }}%</span></div>
  <div>Emails OK : <span>{{ statistics.percentOkEmails }}%</span></div>
  <div>Emails reçus : <span>{{ statistics.percentReceivedEmails }}%</span></div>
</div>

<div class="content">
  <app-admin-projects-list [operatorId]="operatorId" [operators]="operators" [refreshNeededEmitter]="refreshNeededEmitter"></app-admin-projects-list>

  <app-admin-projects-list [status]="'PREPARING'" [operatorId]="operatorId" [refreshNeededEmitter]="refreshNeededEmitter"></app-admin-projects-list>

  <app-admin-projects-list [status]="'EVALUATING'" [operatorId]="operatorId" [refreshNeededEmitter]="refreshNeededEmitter"></app-admin-projects-list>

  <app-admin-projects-list [status]="'DONE'" [operatorId]="operatorId" [refreshNeededEmitter]="refreshNeededEmitter"></app-admin-projects-list>
</div>

<div class="list-table">
  <div> <i class="fa fa-arrow-circle-left" style="font-size:36px"(click)="getLastWeek()"></i></div>
  <div *ngFor="let days of this.weekBatches; let i1 = index">
    <ul *ngFor="let batches of days; let i2 = index">
      <span *ngIf="i2==0">
        {{batches}}
      </span>
      <span *ngIf="i2 != 0">
      <li *ngIf="i2 < 4">
          <label class="label-1st" *ngIf="batches.status == 0" (click)="showPreview($event, batches)">
            {{batches.innovation.name}}  {{batches.size}}
          </label>
          <label class="label-2nd" *ngIf="batches.status == 1" (click)="showPreview($event, batches)">
            {{batches.innovation.name}}  {{batches.size}}
          </label>
          <label class="label-3rd" *ngIf="batches.status == 2" (click)="showPreview($event, batches)">
            {{batches.innovation.name}}  {{batches.size}}
          </label>
      </li>
      <li *ngIf="i2 == 4">
        <div class="popover popover">
          <label class="label-draft">
            ...
          </label>
          <div class="popover-container">
            <div class="card">
              <div class="card-header">
              </div>
              <div class="card-body">
                <ul *ngFor="let batchesOver of days; let i3 = index">
                  <li>
                    <label class="label-1st" *ngIf="batchesOver.status == 0" (click)="showPreview($event, batchesOver)">
                      {{batchesOver.innovation.name}}  {{batchesOver.size}}
                    </label>
                    <label class="label-2nd" *ngIf="batchesOver.status == 1" (click)="showPreview($event, batchesOver)">
                      {{batchesOver.innovation.name}}  {{batchesOver.size}}
                    </label>
                    <label class="label-3rd" *ngIf="batchesOver.status == 2" (click)="showPreview($event, batchesOver)">
                      {{batchesOver.innovation.name}}  {{batchesOver.size}}
                    </label>
                    <label class="label-4th" *ngIf="batchesOver.status == 3" (click)="showPreview($event, batchesOver)">
                      {{batchesOver.innovation.name}}  {{batchesOver.size}}
                    </label>
                  </li>
                </ul>
              </div>
              <div class="card-footer">
              </div>
            </div>
          </div>
        </div>
      </li>
        </span>
    </ul>
  </div>
  <div> <i class="fa fa-arrow-circle-right" style="font-size:36px" (click)="getNextWeek()"></i></div>
</div>



<!-- Innovation preview sidebar-->
<app-sidebar
  [template]="sidebarTemplateValue"
  (closeSidebar)="closeSidebar($event)">
  <app-innovation-preview
    [innovation]="this.selectedInnovation"
    [batchInfo]="this.selectedBatch">
  </app-innovation-preview>
</app-sidebar>


